\hypertarget{asin_8c}{}\section{lib/real/asin.c File Reference}
\label{asin_8c}\index{lib/real/asin.\+c@{lib/real/asin.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
Include dependency graph for asin.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{asin_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{asin_8c_aa9528d92a3ae44ad6484da0774604454}{asin} (double x)
\begin{DoxyCompactList}\small\item\em Inverse trigonometric sine function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one} = 1.\+00000000000000000000e+00
\item 
static const double \hyperlink{asin_8c_acbd466133274923cc0785707fbdeea9a}{huge} = 1.\+000e+300
\item 
static const double \hyperlink{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\+\_\+hi} = 1.\+57079632679489655800e+00
\item 
static const double \hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\+\_\+lo} = 6.\+12323399573676603587e-\/17
\item 
static const double \hyperlink{asin_8c_a5528ffbaf3180832340ec41a3affb60b}{pio4\+\_\+hi} = 7.\+85398163397448278999e-\/01
\item 
static const double \hyperlink{asin_8c_a598e19e166b484e6636a5d2af921178e}{p\+S0} = 1.\+66666666666666657415e-\/01
\item 
static const double \hyperlink{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{p\+S1} = -\/3.\+25565818622400915405e-\/01
\item 
static const double \hyperlink{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}{p\+S2} = 2.\+01212532134862925881e-\/01
\item 
static const double \hyperlink{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}{p\+S3} = -\/4.\+00555345006794114027e-\/02
\item 
static const double \hyperlink{asin_8c_a4579924a5221b8718a2d834daea875c1}{p\+S4} = 7.\+91534994289814532176e-\/04
\item 
static const double \hyperlink{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{p\+S5} = 3.\+47933107596021167570e-\/05
\item 
static const double \hyperlink{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}{q\+S1} = -\/2.\+40339491173441421878e+00
\item 
static const double \hyperlink{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}{q\+S2} = 2.\+02094576023350569471e+00
\item 
static const double \hyperlink{asin_8c_abb1b119c3d6cf33d182bd48155186510}{q\+S3} = -\/6.\+88283971605453293030e-\/01
\item 
static const double \hyperlink{asin_8c_ae6b27b738027128ae51618db2d6e4c81}{q\+S4} = 7.\+70381505559019352791e-\/02
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{asin.\+c@{asin.\+c}!asin@{asin}}
\index{asin@{asin}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{asin(double x)}{asin(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double asin (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{asin_8c_aa9528d92a3ae44ad6484da0774604454}{}\label{asin_8c_aa9528d92a3ae44ad6484da0774604454}


Inverse trigonometric sine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 Since  asin(x) = x + x^3/6 + x^5*3/40 + x^7*15/336 + ...
 we approximate asin(x) on [0,0.5] by
    asin(x) = x + x*x^2*R(x^2)
 where
    R(x^2) is a rational approximation of (asin(x)-x)/x^3
 and its remez error is bounded by
    |(asin(x)-x)/x^3 - R(x^2)| < 2^(-58.75)\end{DoxyPre}



\begin{DoxyPre} For x in [0.5,1]
    asin(x) = pi/2-2*asin(sqrt((1-x)/2))
 Let y = (1-x), z = y/2, s := sqrt(z), and pio2\_hi+pio2\_lo=pi/2;
 then for x>0.98
    asin(x) = pi/2 - 2*(s+s*z*R(z))
        = pio2\_hi - (2*(s+s*z*R(z)) - pio2\_lo)
 For x<=0.98, let pio4\_hi = pio2\_hi/2, then
    f = hi part of s;
    c = sqrt(z) - f = (z-f*f)/(s+f)     ...f+c=sqrt(z)
 and
    asin(x) = pi/2 - 2*(s+s*z*R(z))
        = pio4\_hi+(pio4-2s)-(2s*z*R(z)-pio2\_lo)
        = pio4\_hi+(pio4-2f)-(2s*z*R(z)-(pio2\_lo+2c))\end{DoxyPre}



\begin{DoxyPre}Special cases:
 if x is NaN, return x itself;
 if |x|>1, return NaN with invalid signal.\end{DoxyPre}



\begin{DoxyPre}\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 104 of file asin.\+c.



References huge, one, pio2\+\_\+hi, pio2\+\_\+lo, pio4\+\_\+hi, p\+S0, p\+S1, p\+S2, p\+S3, p\+S4, p\+S5, q\+S1, q\+S2, q\+S3, q\+S4, and sqrt().



Referenced by Real\+Number\+::\+Arc\+Cosecant(), and Real\+Number\+::\+Arc\+Sine().


\begin{DoxyCode}
105 \{
106     \textcolor{keywordtype}{double} t,w,p,q,c,r,s;
107     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,ix;
108     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
109     ix = hx&0x7fffffff;
110     \textcolor{keywordflow}{if}(ix>= 0x3ff00000) \{       \textcolor{comment}{/* |x|>= 1 */}
111         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
112         \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
113         \textcolor{keywordflow}{if}(((ix-0x3ff00000)|lx)==0)
114             \textcolor{comment}{/* asin(1)=+-pi/2 with inexact */}
115             \textcolor{keywordflow}{return} x*\hyperlink{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi}+x*\hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};
116         \textcolor{keywordflow}{return} (x-x)/(x-x);     \textcolor{comment}{/* asin(|x|>1) is NaN */}
117     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix<0x3fe00000) \{ \textcolor{comment}{/* |x|<0.5 */}
118         \textcolor{keywordflow}{if}(ix<0x3e400000) \{     \textcolor{comment}{/* if |x| < 2**-27 */}
119             \textcolor{keywordflow}{if}(\hyperlink{asin_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>\hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \{
120                 \textcolor{keywordflow}{return} x;\textcolor{comment}{/* return x with inexact if x!=0*/}
121             \} \textcolor{keywordflow}{else} \{
122                 t = 0;
123             \}
124         \} \textcolor{keywordflow}{else} \{
125             t = x*x;
126         \}
127 
128         p = t*(\hyperlink{asin_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+t*(\hyperlink{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+t*(\hyperlink{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+t*(\hyperlink{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+t*(\hyperlink{asin_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+t*\hyperlink{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
129         q = \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+t*(\hyperlink{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+t*(\hyperlink{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+t*(\hyperlink{asin_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+t*\hyperlink{asin_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
130         w = p/q;
131         \textcolor{keywordflow}{return} x+x*w;
132     \}
133     \textcolor{comment}{/* 1> |x|>= 0.5 */}
134     w = \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
135     t = w*0.5;
136     p = t*(\hyperlink{asin_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+t*(\hyperlink{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+t*(\hyperlink{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+t*(\hyperlink{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+t*(\hyperlink{asin_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+t*\hyperlink{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
137     q = \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+t*(\hyperlink{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+t*(\hyperlink{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+t*(\hyperlink{asin_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+t*\hyperlink{asin_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
138     s = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(t);
139     \textcolor{keywordflow}{if}(ix>=0x3FEF3333) \{    \textcolor{comment}{/* if |x| > 0.975 */}
140         w = p/q;
141         t = \hyperlink{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi}-(2.0*(s+s*w)-\hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo});
142     \} \textcolor{keywordflow}{else} \{
143         w  = s;
144         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(w,0);
145         c  = (t-w*w)/(s+w);
146         r  = p/q;
147         p  = 2.0*s*r-(\hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo}-2.0*c);
148         q  = \hyperlink{asin_8c_a5528ffbaf3180832340ec41a3affb60b}{pio4\_hi}-2.0*w;
149         t  = \hyperlink{asin_8c_a5528ffbaf3180832340ec41a3affb60b}{pio4\_hi}-(p-q);
150     \}
151     \textcolor{keywordflow}{if}(hx>0) \textcolor{keywordflow}{return} t;
152     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} -t;
153 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{asin_8c_aa9528d92a3ae44ad6484da0774604454_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=285pt]{asin_8c_aa9528d92a3ae44ad6484da0774604454_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{asin.\+c@{asin.\+c}!huge@{huge}}
\index{huge@{huge}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{huge}{huge}}]{\setlength{\rightskip}{0pt plus 5cm}const double huge = 1.\+000e+300\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_acbd466133274923cc0785707fbdeea9a}{}\label{asin_8c_acbd466133274923cc0785707fbdeea9a}


Definition at line 49 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!one@{one}}
\index{one@{one}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}const double one = 1.\+00000000000000000000e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{}\label{asin_8c_ada85e349d35971b32c8ea4238881ff8b}


Definition at line 48 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!pio2\+\_\+hi@{pio2\+\_\+hi}}
\index{pio2\+\_\+hi@{pio2\+\_\+hi}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+hi}{pio2_hi}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+hi = 1.\+57079632679489655800e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{}\label{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}


Definition at line 50 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!pio2\+\_\+lo@{pio2\+\_\+lo}}
\index{pio2\+\_\+lo@{pio2\+\_\+lo}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+lo}{pio2_lo}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+lo = 6.\+12323399573676603587e-\/17\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{}\label{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}


Definition at line 51 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!pio4\+\_\+hi@{pio4\+\_\+hi}}
\index{pio4\+\_\+hi@{pio4\+\_\+hi}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{pio4\+\_\+hi}{pio4_hi}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio4\+\_\+hi = 7.\+85398163397448278999e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_a5528ffbaf3180832340ec41a3affb60b}{}\label{asin_8c_a5528ffbaf3180832340ec41a3affb60b}


Definition at line 52 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!p\+S0@{p\+S0}}
\index{p\+S0@{p\+S0}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{p\+S0}{pS0}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S0 = 1.\+66666666666666657415e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_a598e19e166b484e6636a5d2af921178e}{}\label{asin_8c_a598e19e166b484e6636a5d2af921178e}


Definition at line 54 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!p\+S1@{p\+S1}}
\index{p\+S1@{p\+S1}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{p\+S1}{pS1}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S1 = -\/3.\+25565818622400915405e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{}\label{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}


Definition at line 55 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!p\+S2@{p\+S2}}
\index{p\+S2@{p\+S2}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{p\+S2}{pS2}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S2 = 2.\+01212532134862925881e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}{}\label{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}


Definition at line 56 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!p\+S3@{p\+S3}}
\index{p\+S3@{p\+S3}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{p\+S3}{pS3}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S3 = -\/4.\+00555345006794114027e-\/02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}{}\label{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}


Definition at line 57 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!p\+S4@{p\+S4}}
\index{p\+S4@{p\+S4}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{p\+S4}{pS4}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S4 = 7.\+91534994289814532176e-\/04\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_a4579924a5221b8718a2d834daea875c1}{}\label{asin_8c_a4579924a5221b8718a2d834daea875c1}


Definition at line 58 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!p\+S5@{p\+S5}}
\index{p\+S5@{p\+S5}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{p\+S5}{pS5}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S5 = 3.\+47933107596021167570e-\/05\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{}\label{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}


Definition at line 59 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!q\+S1@{q\+S1}}
\index{q\+S1@{q\+S1}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{q\+S1}{qS1}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S1 = -\/2.\+40339491173441421878e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}{}\label{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}


Definition at line 60 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!q\+S2@{q\+S2}}
\index{q\+S2@{q\+S2}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{q\+S2}{qS2}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S2 = 2.\+02094576023350569471e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}{}\label{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}


Definition at line 61 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!q\+S3@{q\+S3}}
\index{q\+S3@{q\+S3}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{q\+S3}{qS3}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S3 = -\/6.\+88283971605453293030e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_abb1b119c3d6cf33d182bd48155186510}{}\label{asin_8c_abb1b119c3d6cf33d182bd48155186510}


Definition at line 62 of file asin.\+c.



Referenced by asin().

\index{asin.\+c@{asin.\+c}!q\+S4@{q\+S4}}
\index{q\+S4@{q\+S4}!asin.\+c@{asin.\+c}}
\subsubsection[{\texorpdfstring{q\+S4}{qS4}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S4 = 7.\+70381505559019352791e-\/02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{asin_8c_ae6b27b738027128ae51618db2d6e4c81}{}\label{asin_8c_ae6b27b738027128ae51618db2d6e4c81}


Definition at line 63 of file asin.\+c.



Referenced by asin().

