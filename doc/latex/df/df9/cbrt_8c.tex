\hypertarget{cbrt_8c}{}\section{lib/real/cbrt.c File Reference}
\label{cbrt_8c}\index{lib/real/cbrt.\+c@{lib/real/cbrt.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
Include dependency graph for cbrt.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=153pt]{d1/d46/cbrt_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{cbrt_8c_a8af00e2203928978e0242b4afd1d899f}{cbrt} (double x)
\begin{DoxyCompactList}\small\item\em Cube root function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const unsigned \hyperlink{cbrt_8c_a0340375b1c4fd28d44d3d8f2c21ef4c2}{B1} = 715094163
\item 
static const unsigned \hyperlink{cbrt_8c_a63d271d6b952319d904e32c7319dbacd}{B2} = 696219795
\item 
static const double \hyperlink{cbrt_8c_a9e8a46a0e00368ad98642587ca4ebdbe}{C} = 5.\+42857142857142815906e-\/01
\item 
static const double \hyperlink{cbrt_8c_a412464ee5e4d4e873c365d926d1970bb}{D} = -\/7.\+05306122448979611050e-\/01
\item 
static const double \hyperlink{cbrt_8c_ab587ba72a9c23f238cb4fd70e2fdb545}{E} = 1.\+41428571428571436819e+00
\item 
static const double \hyperlink{cbrt_8c_a480d6423b1e9ca40c69c5a83458b49b0}{F} = 1.\+60714285714285720630e+00
\item 
static const double \hyperlink{cbrt_8c_ab97e4616d23ed4c2961295010c1afc3c}{G} = 3.\+57142857142857150787e-\/01
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{cbrt.\+c@{cbrt.\+c}!cbrt@{cbrt}}
\index{cbrt@{cbrt}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{cbrt(double x)}{cbrt(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double cbrt (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{cbrt_8c_a8af00e2203928978e0242b4afd1d899f}{}\label{cbrt_8c_a8af00e2203928978e0242b4afd1d899f}


Cube root function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18 
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 67 of file cbrt.\+c.



References B1, B2, C, D, E, F, and G.


\begin{DoxyCode}
68 \{
69     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}  hx, lx, ht;
70     \textcolor{keywordtype}{double} r,s,t=0.0,w;
71     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} sign;
72 
73     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x); \textcolor{comment}{/* high word of x */}
74     sign=hx&0x80000000;         \textcolor{comment}{/* sign= sign(x) */}
75     hx  ^=sign;
76     \textcolor{keywordflow}{if}(hx>=0x7ff00000) \textcolor{keywordflow}{return}(x+x); \textcolor{comment}{/* cbrt(NaN,INF) is itself */}
77     \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx, x);
78     \textcolor{keywordflow}{if}((hx|lx)==0)
79         \textcolor{keywordflow}{return}(x);      \textcolor{comment}{/* cbrt(0) is itself */}
80 
81     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x,hx); \textcolor{comment}{/* x <- |x| */}
82     \textcolor{comment}{/* rough cbrt to 5 bits */}
83     \textcolor{keywordflow}{if}(hx<0x00100000)       \textcolor{comment}{/* subnormal number */}
84     \{
85         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,0x43500000);       \textcolor{comment}{/* set t= 2**54 */}
86         t*=x;
87         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht,t);
88         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,ht/3+\hyperlink{cbrt_8c_a63d271d6b952319d904e32c7319dbacd}{B2});
89     \}
90     \textcolor{keywordflow}{else}
91         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,hx/3+\hyperlink{cbrt_8c_a0340375b1c4fd28d44d3d8f2c21ef4c2}{B1});
92 
93     \textcolor{comment}{/* new cbrt to 23 bits, may be implemented in single precision */}
94     r=t*t/x;
95     s=\hyperlink{cbrt_8c_a9e8a46a0e00368ad98642587ca4ebdbe}{C}+r*t;
96     t*=\hyperlink{cbrt_8c_ab97e4616d23ed4c2961295010c1afc3c}{G}+\hyperlink{cbrt_8c_a480d6423b1e9ca40c69c5a83458b49b0}{F}/(s+\hyperlink{cbrt_8c_ab587ba72a9c23f238cb4fd70e2fdb545}{E}+\hyperlink{cbrt_8c_a412464ee5e4d4e873c365d926d1970bb}{D}/s);
97 
98     \textcolor{comment}{/* chopped to 20 bits and make it larger than cbrt(x) */}
99     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
100     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht,t);
101     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,ht + 0x00000001);
102 
103     \textcolor{comment}{/* one step newton iteration to 53 bits with error less than 0.667 ulps */}
104     s=t*t;      \textcolor{comment}{/* t*t is exact */}
105     r=x/s;
106     w=t+t;
107     r=(r-t)/(w+r);  \textcolor{comment}{/* r-s is exact */}
108     t=t+t*r;
109 
110     \textcolor{comment}{/* retore the sign bit */}
111     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht,t);
112     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,ht|sign);
113 
114     \textcolor{keywordflow}{return}(t);
115 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\index{cbrt.\+c@{cbrt.\+c}!B1@{B1}}
\index{B1@{B1}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{B1}{B1}}]{\setlength{\rightskip}{0pt plus 5cm}const unsigned B1 = 715094163\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_a0340375b1c4fd28d44d3d8f2c21ef4c2}{}\label{cbrt_8c_a0340375b1c4fd28d44d3d8f2c21ef4c2}


Definition at line 47 of file cbrt.\+c.



Referenced by cbrt().

\index{cbrt.\+c@{cbrt.\+c}!B2@{B2}}
\index{B2@{B2}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{B2}{B2}}]{\setlength{\rightskip}{0pt plus 5cm}const unsigned B2 = 696219795\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_a63d271d6b952319d904e32c7319dbacd}{}\label{cbrt_8c_a63d271d6b952319d904e32c7319dbacd}


Definition at line 48 of file cbrt.\+c.



Referenced by cbrt().

\index{cbrt.\+c@{cbrt.\+c}!C@{C}}
\index{C@{C}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{C}{C}}]{\setlength{\rightskip}{0pt plus 5cm}const double C = 5.\+42857142857142815906e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_a9e8a46a0e00368ad98642587ca4ebdbe}{}\label{cbrt_8c_a9e8a46a0e00368ad98642587ca4ebdbe}


Definition at line 51 of file cbrt.\+c.



Referenced by cbrt().

\index{cbrt.\+c@{cbrt.\+c}!D@{D}}
\index{D@{D}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{D}{D}}]{\setlength{\rightskip}{0pt plus 5cm}const double D = -\/7.\+05306122448979611050e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_a412464ee5e4d4e873c365d926d1970bb}{}\label{cbrt_8c_a412464ee5e4d4e873c365d926d1970bb}


Definition at line 52 of file cbrt.\+c.



Referenced by cbrt().

\index{cbrt.\+c@{cbrt.\+c}!E@{E}}
\index{E@{E}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{E}{E}}]{\setlength{\rightskip}{0pt plus 5cm}const double E = 1.\+41428571428571436819e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_ab587ba72a9c23f238cb4fd70e2fdb545}{}\label{cbrt_8c_ab587ba72a9c23f238cb4fd70e2fdb545}


Definition at line 53 of file cbrt.\+c.



Referenced by cbrt().

\index{cbrt.\+c@{cbrt.\+c}!F@{F}}
\index{F@{F}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{F}{F}}]{\setlength{\rightskip}{0pt plus 5cm}const double F = 1.\+60714285714285720630e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_a480d6423b1e9ca40c69c5a83458b49b0}{}\label{cbrt_8c_a480d6423b1e9ca40c69c5a83458b49b0}


Definition at line 54 of file cbrt.\+c.



Referenced by cbrt().

\index{cbrt.\+c@{cbrt.\+c}!G@{G}}
\index{G@{G}!cbrt.\+c@{cbrt.\+c}}
\subsubsection[{\texorpdfstring{G}{G}}]{\setlength{\rightskip}{0pt plus 5cm}const double G = 3.\+57142857142857150787e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{cbrt_8c_ab97e4616d23ed4c2961295010c1afc3c}{}\label{cbrt_8c_ab97e4616d23ed4c2961295010c1afc3c}


Definition at line 55 of file cbrt.\+c.



Referenced by cbrt().

