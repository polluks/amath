\hypertarget{ktan_8c}{}\section{lib/real/ktan.c File Reference}
\label{ktan_8c}\index{lib/real/ktan.\+c@{lib/real/ktan.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
Include dependency graph for ktan.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{d3/df5/ktan_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one}~\hyperlink{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}{xxx}\mbox{[}13\mbox{]}
\item 
\#define \hyperlink{ktan_8c_a75e16f8efd77d78a9a4a1fff4e77cb90}{pio4}~\hyperlink{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}{xxx}\mbox{[}14\mbox{]}
\item 
\#define \hyperlink{ktan_8c_a7857585f1affed40b5174c5175a1e389}{pio4lo}~\hyperlink{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}{xxx}\mbox{[}15\mbox{]}
\item 
\#define \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}~\hyperlink{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}{xxx}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{ktan_8c_a5f1c9e105e0dbca8a88407dd899043c6}{\+\_\+\+\_\+kernel\+\_\+tan} (double x, double y, int iy)
\begin{DoxyCompactList}\small\item\em Kernel tan function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}{xxx} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{ktan.\+c@{ktan.\+c}!one@{one}}
\index{one@{one}!ktan.\+c@{ktan.\+c}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}\#define one~{\bf xxx}\mbox{[}13\mbox{]}}\hypertarget{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{}\label{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}


Definition at line 64 of file ktan.\+c.

\index{ktan.\+c@{ktan.\+c}!pio4@{pio4}}
\index{pio4@{pio4}!ktan.\+c@{ktan.\+c}}
\subsubsection[{\texorpdfstring{pio4}{pio4}}]{\setlength{\rightskip}{0pt plus 5cm}\#define pio4~{\bf xxx}\mbox{[}14\mbox{]}}\hypertarget{ktan_8c_a75e16f8efd77d78a9a4a1fff4e77cb90}{}\label{ktan_8c_a75e16f8efd77d78a9a4a1fff4e77cb90}


Definition at line 65 of file ktan.\+c.

\index{ktan.\+c@{ktan.\+c}!pio4lo@{pio4lo}}
\index{pio4lo@{pio4lo}!ktan.\+c@{ktan.\+c}}
\subsubsection[{\texorpdfstring{pio4lo}{pio4lo}}]{\setlength{\rightskip}{0pt plus 5cm}\#define pio4lo~{\bf xxx}\mbox{[}15\mbox{]}}\hypertarget{ktan_8c_a7857585f1affed40b5174c5175a1e389}{}\label{ktan_8c_a7857585f1affed40b5174c5175a1e389}


Definition at line 66 of file ktan.\+c.

\index{ktan.\+c@{ktan.\+c}!T@{T}}
\index{T@{T}!ktan.\+c@{ktan.\+c}}
\subsubsection[{\texorpdfstring{T}{T}}]{\setlength{\rightskip}{0pt plus 5cm}\#define T~{\bf xxx}}\hypertarget{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{}\label{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}


Definition at line 67 of file ktan.\+c.



\subsection{Function Documentation}
\index{ktan.\+c@{ktan.\+c}!\+\_\+\+\_\+kernel\+\_\+tan@{\+\_\+\+\_\+kernel\+\_\+tan}}
\index{\+\_\+\+\_\+kernel\+\_\+tan@{\+\_\+\+\_\+kernel\+\_\+tan}!ktan.\+c@{ktan.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+kernel\+\_\+tan(double x, double y, int iy)}{__kernel_tan(double x, double y, int iy)}}]{\setlength{\rightskip}{0pt plus 5cm}double \+\_\+\+\_\+kernel\+\_\+tan (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y, }
\item[{int}]{iy}
\end{DoxyParamCaption}
)}\hypertarget{ktan_8c_a5f1c9e105e0dbca8a88407dd899043c6}{}\label{ktan_8c_a5f1c9e105e0dbca8a88407dd899043c6}


Kernel tan function. 

\begin{DoxyVersion}{Version}
1.\+5 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
04/04/22
\end{DoxyDate}
Kernel tan function on \mbox{[}-\/pi/4, pi/4\mbox{]}, pi/4 $\sim$ 0.\+7854 Input x is assumed to be bounded by $\sim$pi/4 in magnitude. Input y is the tail of x. Input k indicates whether tan (if k = 1) or -\/1/tan (if k = -\/1) is returned.

Algorithm
\begin{DoxyEnumerate}
\item Since tan(-\/x) = -\/tan(x), we need only to consider positive x.
\item if x $<$ 2$^\wedge$-\/28 (hx$<$0x3e300000 0), return x with inexact if x!=0.
\item tan(x) is approximated by a odd polynomial of degree 27 on \mbox{[}0,0.\+67434\mbox{]} 3 27 tan(x) $\sim$ x + T1$\ast$x + ... + T13$\ast$x where \begin{DoxyVerb}    |tan(x)         2     4            26   |     -59.2
    |----- - (1+T1*x +T2*x +.... +T13*x    )| <= 2
    |  x                    |
\end{DoxyVerb}


Note\+: tan(x+y) = tan(x) + tan\textquotesingle{}(x)$\ast$y $\sim$ tan(x) + (1+x$\ast$x)$\ast$y Therefore, for better accuracy in computing tan(x+y), let 3 2 2 2 2 r = x $\ast$(T2+x $\ast$(T3+x $\ast$(...+x $\ast$(T12+x $\ast$\+T13)))) then 3 2 tan(x+y) = x + (T1$\ast$x + (x $\ast$(r+y)+y))
\begin{DoxyEnumerate}
\item For x in \mbox{[}0.\+67434,pi/4\mbox{]}, let y = pi/4 -\/ x, then tan(x) = tan(pi/4-\/y) = (1-\/tan(y))/(1+tan(y)) = 1 -\/ 2$\ast$(tan(y) -\/ (tan(y)$^\wedge$2)/(1+tan(y)))  \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}

\end{DoxyEnumerate}
\end{DoxyEnumerate}

Definition at line 112 of file ktan.\+c.



Referenced by tan().


\begin{DoxyCode}
112                                                 \{
113     \textcolor{keywordtype}{double} z, r, v, w, s;
114     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix, hx;
115 
116     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x); \textcolor{comment}{/* high word of x */}
117     ix = hx & 0x7fffffff;           \textcolor{comment}{/* high word of |x| */}
118     \textcolor{keywordflow}{if} (ix < 0x3e300000) \{          \textcolor{comment}{/* x < 2**-28 */}
119         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int}) x == 0) \{     \textcolor{comment}{/* generate inexact */}
120             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} low;
121             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(low,x);
122             \textcolor{keywordflow}{if} (((ix | low) | (iy + 1)) == 0)
123                 \textcolor{keywordflow}{return} \hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} / \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
124             \textcolor{keywordflow}{else} \{
125                 \textcolor{keywordflow}{if} (iy == 1)
126                     \textcolor{keywordflow}{return} x;
127                 \textcolor{keywordflow}{else} \{  \textcolor{comment}{/* compute -1 / (x+y) carefully */}
128                     \textcolor{keywordtype}{double} a, t;
129 
130                     z = w = x + y;
131                     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(z,0);
132                     v = y - (z - x);
133                     t = a = -\hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} / w;
134                     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
135                     s = \hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} + t * z;
136                     \textcolor{keywordflow}{return} t + a * (s + t * v);
137                 \}
138             \}
139         \}
140     \}
141     \textcolor{keywordflow}{if} (ix >= 0x3FE59428) \{ \textcolor{comment}{/* |x| >= 0.6744 */}
142         \textcolor{keywordflow}{if} (hx < 0) \{
143             x = -x;
144             y = -y;
145         \}
146         z = \hyperlink{ktan_8c_a75e16f8efd77d78a9a4a1fff4e77cb90}{pio4} - x;
147         w = \hyperlink{ktan_8c_a7857585f1affed40b5174c5175a1e389}{pio4lo} - y;
148         x = z + w;
149         y = 0.0;
150     \}
151     z = x * x;
152     w = z * z;
153     \textcolor{comment}{/*}
154 \textcolor{comment}{     * Break x^5*(T[1]+x^2*T[2]+...) into}
155 \textcolor{comment}{     * x^5(T[1]+x^4*T[3]+...+x^20*T[11]) +}
156 \textcolor{comment}{     * x^5(x^2*(T[2]+x^4*T[4]+...+x^22*[T12]))}
157 \textcolor{comment}{     */}
158     r = \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[1] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[3] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[5] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[7] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[9] +
159                                             w * \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[11]))));
160     v = z * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[2] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[4] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[6] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[8] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[10] +
161                                      w * \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[12])))));
162     s = z * x;
163     r = y + z * (s * (r + v) + y);
164     r += \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[0] * s;
165     w = x + r;
166     \textcolor{keywordflow}{if} (ix >= 0x3FE59428) \{
167         v = (double) iy;
168         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{double}) (1 - ((hx >> 30) & 2)) *
169                (v - 2.0 * (x - (w * w / (w + v) - r)));
170     \}
171     \textcolor{keywordflow}{if} (iy == 1)
172         \textcolor{keywordflow}{return} w;
173     \textcolor{keywordflow}{else} \{
174         \textcolor{comment}{/*}
175 \textcolor{comment}{         * if allow error up to 2 ulp, simply return}
176 \textcolor{comment}{         * -1.0 / (x+r) here}
177 \textcolor{comment}{         */}
178         \textcolor{comment}{/* compute -1.0 / (x+r) accurately */}
179         \textcolor{keywordtype}{double} a, t;
180         z = w;
181         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(z,0);
182         v = r - (z - x);    \textcolor{comment}{/* z+v = r+x */}
183         t = a = -1.0 / w;   \textcolor{comment}{/* a = -1.0/w */}
184         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
185         s = 1.0 + t * z;
186         \textcolor{keywordflow}{return} t + a * (s + t * v);
187     \}
188 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{de/d4a/ktan_8c_a5f1c9e105e0dbca8a88407dd899043c6_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{ktan.\+c@{ktan.\+c}!xxx@{xxx}}
\index{xxx@{xxx}!ktan.\+c@{ktan.\+c}}
\subsubsection[{\texorpdfstring{xxx}{xxx}}]{\setlength{\rightskip}{0pt plus 5cm}const double xxx\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}{}\label{ktan_8c_a6348fdb2c2240f47e505d134c7a33bfe}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
    3.33333333333334091986e-01, 
    1.33333333333201242699e-01, 
    5.39682539762260521377e-02, 
    2.18694882948595424599e-02, 
    8.86323982359930005737e-03, 
    3.59207910759131235356e-03, 
    1.45620945432529025516e-03, 
    5.88041240820264096874e-04, 
    2.46463134818469906812e-04, 
    7.81794442939557092300e-05, 
    7.14072491382608190305e-05, 
    -1.85586374855275456654e-05,    
    2.59073051863633712884e-05, 
         1.00000000000000000000e+00,    
         7.85398163397448278999e-01,    
         3.06161699786838301793e-17 
\}
\end{DoxyCode}


Definition at line 45 of file ktan.\+c.

