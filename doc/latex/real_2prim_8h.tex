\hypertarget{real_2prim_8h}{}\section{lib/real/prim.h File Reference}
\label{real_2prim_8h}\index{lib/real/prim.\+h@{lib/real/prim.\+h}}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{real_2prim_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
union \hyperlink{unionieee__float__shape__type}{ieee\+\_\+float\+\_\+shape\+\_\+type}
\begin{DoxyCompactList}\small\item\em A union which permits us to convert between a float and a 32 bit int. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{real_2prim_8h_a5f3d17bf39f78da3422ca52e475d7724}{H\+U\+GE}~1.\+7976931348623157e+308
\item 
\#define \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS}(ix0,  ix1,  d)
\begin{DoxyCompactList}\small\item\em Get two 32 bit ints from a double. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}(i,  d)
\begin{DoxyCompactList}\small\item\em Get the more significant 32 bit int from a double. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}(i,  d)
\begin{DoxyCompactList}\small\item\em Get the less significant 32 bit int from a double. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS}(d,  ix0,  ix1)
\begin{DoxyCompactList}\small\item\em Set a double from two 32 bit ints. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}(d,  v)
\begin{DoxyCompactList}\small\item\em Set the more significant 32 bits of a double from an int. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}(d,  v)
\begin{DoxyCompactList}\small\item\em Set the less significant 32 bits of a double from an int. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_a0ff03e3dfff0c616f9e742d122ffcf43}{G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}(i,  d)
\begin{DoxyCompactList}\small\item\em Get a 32 bit int from a float. \end{DoxyCompactList}\item 
\#define \hyperlink{real_2prim_8h_a89f7a53fda08f0e3a5c55bc882a1b250}{S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}(d,  i)
\begin{DoxyCompactList}\small\item\em Set a float from a 32 bit int. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef unsigned int \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword}
\begin{DoxyCompactList}\small\item\em 32 bit unsigned integer. \end{DoxyCompactList}\item 
typedef signed int \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}
\begin{DoxyCompactList}\small\item\em 32 bit signed integer. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\+\_\+\+\_\+kernel\+\_\+cos} (double x, double y)
\begin{DoxyCompactList}\small\item\em Kernel cos function. \end{DoxyCompactList}\item 
double \hyperlink{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{\+\_\+\+\_\+kernel\+\_\+sin} (double x, double y, int iy)
\begin{DoxyCompactList}\small\item\em Kernel sin function. \end{DoxyCompactList}\item 
double \hyperlink{real_2prim_8h_a5f1c9e105e0dbca8a88407dd899043c6}{\+\_\+\+\_\+kernel\+\_\+tan} (double x, double y, int iy)
\begin{DoxyCompactList}\small\item\em Kernel tan function. \end{DoxyCompactList}\item 
int \hyperlink{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71}{\+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2} (double $\ast$x, double $\ast$y, int e0, int nx, int prec, const int $\ast$ipio2)
\begin{DoxyCompactList}\small\item\em Kernel reduction function. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{real/prim.\+h@{real/prim.\+h}!E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS@{E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS}}
\index{E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS@{E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS}{EXTRACT_WORDS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\+X\+T\+R\+A\+C\+T\+\_\+\+W\+O\+R\+DS(
\begin{DoxyParamCaption}
\item[{}]{ix0, }
\item[{}]{ix1, }
\item[{}]{d}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{}\label{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                             \(\backslash\)
    ieee\_double\_shape\_type ew\_u;   \(\backslash\)
    ew\_u.value = (d);              \(\backslash\)
    (ix0) = ew\_u.parts.msw;        \(\backslash\)
    (ix1) = ew\_u.parts.lsw;        \(\backslash\)
  \} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Get two 32 bit ints from a double. 



Definition at line 153 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD@{G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}}
\index{G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD@{G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}{GET_FLOAT_WORD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD(
\begin{DoxyParamCaption}
\item[{}]{i, }
\item[{}]{d}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a0ff03e3dfff0c616f9e742d122ffcf43}{}\label{real_2prim_8h_a0ff03e3dfff0c616f9e742d122ffcf43}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                               \(\backslash\)
  ieee\_float\_shape\_type gf\_u;      \(\backslash\)
  gf\_u.value = (d);                \(\backslash\)
  (i) = gf\_u.word;                 \(\backslash\)
\} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Get a 32 bit int from a float. 



Definition at line 237 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD@{G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}}
\index{G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD@{G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}{GET_HIGH_WORD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD(
\begin{DoxyParamCaption}
\item[{}]{i, }
\item[{}]{d}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{}\label{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                             \(\backslash\)
    ieee\_double\_shape\_type gh\_u;   \(\backslash\)
    gh\_u.value = (d);              \(\backslash\)
    (i) = gh\_u.parts.msw;          \(\backslash\)
  \} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Get the more significant 32 bit int from a double. 



Definition at line 165 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD@{G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}}
\index{G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD@{G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}{GET_LOW_WORD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD(
\begin{DoxyParamCaption}
\item[{}]{i, }
\item[{}]{d}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{}\label{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                             \(\backslash\)
    ieee\_double\_shape\_type gl\_u;   \(\backslash\)
    gl\_u.value = (d);              \(\backslash\)
    (i) = gl\_u.parts.lsw;          \(\backslash\)
  \} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Get the less significant 32 bit int from a double. 



Definition at line 176 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!H\+U\+GE@{H\+U\+GE}}
\index{H\+U\+GE@{H\+U\+GE}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{H\+U\+GE}{HUGE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\+U\+GE~1.\+7976931348623157e+308}\hypertarget{real_2prim_8h_a5f3d17bf39f78da3422ca52e475d7724}{}\label{real_2prim_8h_a5f3d17bf39f78da3422ca52e475d7724}


Definition at line 52 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS@{I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS}}
\index{I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS@{I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS}{INSERT_WORDS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+N\+S\+E\+R\+T\+\_\+\+W\+O\+R\+DS(
\begin{DoxyParamCaption}
\item[{}]{d, }
\item[{}]{ix0, }
\item[{}]{ix1}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{}\label{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                             \(\backslash\)
    ieee\_double\_shape\_type iw\_u;   \(\backslash\)
    iw\_u.parts.msw = (ix0);        \(\backslash\)
    iw\_u.parts.lsw = (ix1);        \(\backslash\)
    (d) = iw\_u.value;              \(\backslash\)
  \} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Set a double from two 32 bit ints. 



Definition at line 187 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD@{S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}}
\index{S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD@{S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD}{SET_FLOAT_WORD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+E\+T\+\_\+\+F\+L\+O\+A\+T\+\_\+\+W\+O\+RD(
\begin{DoxyParamCaption}
\item[{}]{d, }
\item[{}]{i}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a89f7a53fda08f0e3a5c55bc882a1b250}{}\label{real_2prim_8h_a89f7a53fda08f0e3a5c55bc882a1b250}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                               \(\backslash\)
  ieee\_float\_shape\_type sf\_u;      \(\backslash\)
  sf\_u.word = (i);                 \(\backslash\)
  (d) = sf\_u.value;                \(\backslash\)
\} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Set a float from a 32 bit int. 



Definition at line 248 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD@{S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}}
\index{S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD@{S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD}{SET_HIGH_WORD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+E\+T\+\_\+\+H\+I\+G\+H\+\_\+\+W\+O\+RD(
\begin{DoxyParamCaption}
\item[{}]{d, }
\item[{}]{v}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{}\label{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                             \(\backslash\)
    ieee\_double\_shape\_type sh\_u;   \(\backslash\)
    sh\_u.value = (d);              \(\backslash\)
    sh\_u.parts.msw = (v);          \(\backslash\)
    (d) = sh\_u.value;              \(\backslash\)
  \} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Set the more significant 32 bits of a double from an int. 



Definition at line 199 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD@{S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}}
\index{S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD@{S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD}{SET_LOW_WORD}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+E\+T\+\_\+\+L\+O\+W\+\_\+\+W\+O\+RD(
\begin{DoxyParamCaption}
\item[{}]{d, }
\item[{}]{v}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{}\label{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{keywordflow}{do} \{                             \(\backslash\)
    ieee\_double\_shape\_type sl\_u;   \(\backslash\)
    sl\_u.value = (d);              \(\backslash\)
    sl\_u.parts.lsw = (v);          \(\backslash\)
    (d) = sl\_u.value;              \(\backslash\)
  \} \textcolor{keywordflow}{while} (0)
\end{DoxyCode}


Set the less significant 32 bits of a double from an int. 



Definition at line 211 of file prim.\+h.



\subsection{Typedef Documentation}
\index{real/prim.\+h@{real/prim.\+h}!sword@{sword}}
\index{sword@{sword}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{sword}{sword}}]{\setlength{\rightskip}{0pt plus 5cm}typedef signed int {\bf sword}}\hypertarget{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{}\label{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}


32 bit signed integer. 



Definition at line 107 of file prim.\+h.

\index{real/prim.\+h@{real/prim.\+h}!uword@{uword}}
\index{uword@{uword}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{uword}{uword}}]{\setlength{\rightskip}{0pt plus 5cm}typedef unsigned int {\bf uword}}\hypertarget{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{}\label{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}


32 bit unsigned integer. 



Definition at line 101 of file prim.\+h.



\subsection{Function Documentation}
\index{real/prim.\+h@{real/prim.\+h}!\+\_\+\+\_\+kernel\+\_\+cos@{\+\_\+\+\_\+kernel\+\_\+cos}}
\index{\+\_\+\+\_\+kernel\+\_\+cos@{\+\_\+\+\_\+kernel\+\_\+cos}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+kernel\+\_\+cos(double x, double y)}{__kernel_cos(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double \+\_\+\+\_\+kernel\+\_\+cos (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{}\label{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}


Kernel cos function. 

\begin{DoxyVersion}{Version}
1.\+4 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
96/03/07
\end{DoxyDate}

\begin{DoxyPre}
Kernel cos function on [-pi/4, pi/4], pi/4 ~ 0.785398164
Input x is assumed to be bounded by ~pi/4 in magnitude.
Input y is the tail of x.\end{DoxyPre}



\begin{DoxyPre}Algorithm
 1. Since cos(-x) = cos(x), we need only to consider positive x.
 2. if x < 2^-27 (hx<0x3e400000 0), return 1 with inexact if x!=0.
 3. cos(x) is approximated by a polynomial of degree 14 on
    [0,pi/4]
                         4            14
        cos(x) ~ 1 - x*x/2 + C1*x + ... + C6*x
    where the Remes error is\end{DoxyPre}



\begin{DoxyPre}    |              2     4     6     8     10    12     14 |     -58
    |cos(x)-(1-.5*x +C1*x +C2*x +C3*x +C4*x +C5*x  +C6*x  )| <= 2
    |                                      |\end{DoxyPre}



\begin{DoxyPre}                   4     6     8     10    12     14
 4. let r = C1*x +C2*x +C3*x +C4*x +C5*x  +C6*x  , then
        cos(x) = 1 - x*x/2 + r
    since cos(x+y) ~ cos(x) - sin(x)*y
          ~ cos(x) - x*y,
    a correction term is necessary in cos(x) and hence
    cos(x+y) = 1 - (x*x/2 - (r - x*y))
    For better accuracy when x > 0.3, let qx = |x|/4 with
    the last 32 bits mask off, and if x > 0.78125, let qx = 0.28125.
    Then
    cos(x+y) = (1-qx) - ((x*x/2-qx) - (r-x*y)).
    Note that 1-qx and (x*x/2-qx) is EXACT here, and the
    magnitude of the latter is at least a quarter of x*x/2,
    thus, reducing the rounding error in the subtraction.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 100 of file kcos.\+c.



References C1, C2, C3, C4, C5, C6, and one.



Referenced by cos(), and sin().


\begin{DoxyCode}
101 \{
102     \textcolor{keywordtype}{double} a,hz,z,r,qx;
103     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix;
104     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix, x);
105     ix &= 0x7fffffff;   \textcolor{comment}{/* ix = |x|'s high word*/}
106     \textcolor{keywordflow}{if}(ix<0x3e400000) \{         \textcolor{comment}{/* if x < 2**27 */}
107         \textcolor{keywordflow}{if}(((\textcolor{keywordtype}{int})x)==0) \textcolor{keywordflow}{return} \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one};      \textcolor{comment}{/* generate inexact */}
108     \}
109     z  = x*x;
110     r  = z*(\hyperlink{kcos_8c_a904dc404907e943cfad5b4e2ec9278b2}{C1}+z*(\hyperlink{kcos_8c_a63ef11ac7d8fc6f3da5bc06b6a4a323d}{C2}+z*(\hyperlink{kcos_8c_aa4246f6942f2fe095551bdd0f7fa2dfb}{C3}+z*(\hyperlink{kcos_8c_aee1397eff508394bcf741cc14594caa7}{C4}+z*(\hyperlink{kcos_8c_a5103faeaed3da41dc7c97d92185d5fe8}{C5}+z*\hyperlink{kcos_8c_aa28c7916479bad0bf246c357a5b15721}{C6})))));
111     \textcolor{keywordflow}{if}(ix < 0x3FD33333)             \textcolor{comment}{/* if |x| < 0.3 */}
112         \textcolor{keywordflow}{return} \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one} - (0.5*z - (z*r - x*y));
113     \textcolor{keywordflow}{else} \{
114         \textcolor{keywordflow}{if}(ix > 0x3fe90000) \{       \textcolor{comment}{/* x > 0.78125 */}
115             qx = 0.28125;
116         \} \textcolor{keywordflow}{else} \{
117             \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(qx,ix-0x00200000,0);
118         \}
119         hz = 0.5*z-qx;
120         a  = \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-qx;
121         \textcolor{keywordflow}{return} a - (hz - (z*r-x*y));
122     \}
123 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122_icgraph}
\end{center}
\end{figure}


\index{real/prim.\+h@{real/prim.\+h}!\+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2@{\+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2}}
\index{\+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2@{\+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2(double $\ast$x, double $\ast$y, int e0, int nx, int prec, const int $\ast$ipio2)}{__kernel_rem_pio2(double *x, double *y, int e0, int nx, int prec, const int *ipio2)}}]{\setlength{\rightskip}{0pt plus 5cm}int \+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2 (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{x, }
\item[{double $\ast$}]{y, }
\item[{int}]{e0, }
\item[{int}]{nx, }
\item[{int}]{prec, }
\item[{const int $\ast$}]{ipio2}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71}{}\label{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71}


Kernel reduction function. 

\begin{DoxyVersion}{Version}
1.\+4 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
96/03/07
\end{DoxyDate}

\begin{DoxyPre}
\_\_kernel\_rem\_pio2(x,y,e0,nx,prec,ipio2)
double x[],y[]; int e0,nx,prec; int ipio2[];\end{DoxyPre}



\begin{DoxyPre}\_\_kernel\_rem\_pio2 return the last three digits of N with
    y = x - N*pi/2
so that |y| < pi/2.\end{DoxyPre}



\begin{DoxyPre}The method is to compute the integer (mod 8) and fraction parts of
(2/pi)*x without doing the full multiplication. In general we
skip the part of the product that are known to be a huge integer (
more accurately, = 0 mod 8 ). Thus the number of operations are
independent of the exponent of the input.\end{DoxyPre}



\begin{DoxyPre}(2/pi) is represented by an array of 24-bit integers in ipio2[].\end{DoxyPre}



\begin{DoxyPre}Input parameters:
    x[] The input value (must be positive) is broken into nx
    pieces of 24-bit integers in double precision format.
    x[i] will be the i-th 24 bit of x. The scaled exponent
    of x[0] is given in input parameter e0 (i.e., x[0]*2^e0
    match x's up to 24 bits.\end{DoxyPre}



\begin{DoxyPre}    Example of breaking a double positive z into x[0]+x[1]+x[2]:
        e0 = ilogb(z)-23
        z  = scalbn(z,-e0)
    for i = 0,1,2
        x[i] = floor(z)
        z    = (z-x[i])*2**24\end{DoxyPre}



\begin{DoxyPre} y[]    ouput result in an array of double precision numbers.
    The dimension of y[] is:
        24-bit  precision   1
        53-bit  precision   2
        64-bit  precision   2
        113-bit precision   3
    The actual value is the sum of them. Thus for 113-bit
    precison, one may have to do something like:\end{DoxyPre}



\begin{DoxyPre}    long double t,w,r\_head, r\_tail;
    t = (long double)y[2] + (long double)y[1];
    w = (long double)y[0];
    r\_head = t+w;
    r\_tail = w - (r\_head - t);\end{DoxyPre}



\begin{DoxyPre} e0 The exponent of x[0]\end{DoxyPre}



\begin{DoxyPre} nx dimension of x[]\end{DoxyPre}



\begin{DoxyPre}    prec    an integer indicating the precision:
        0   24  bits (single)
        1   53  bits (double)
        2   64  bits (extended)
        3   113 bits (quad)\end{DoxyPre}



\begin{DoxyPre} ipio2[]
    integer array, contains the (24*i)-th to (24*i+23)-th
    bit of 2/pi after binary point. The corresponding
    floating value is\end{DoxyPre}



\begin{DoxyPre}        ipio2[i] * 2^(-24(i+1)).\end{DoxyPre}



\begin{DoxyPre}External function:
 double \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn()}, \hyperlink{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}{floor()};\end{DoxyPre}



\begin{DoxyPre}Here is the description of some local variables:\end{DoxyPre}



\begin{DoxyPre}    jk  jk+1 is the initial number of terms of ipio2[] needed
    in the computation. The recommended value is 2,3,4,
    6 for single, double, extended,and quad.\end{DoxyPre}



\begin{DoxyPre}    jz  local integer variable indicating the number of
    terms of ipio2[] used.\end{DoxyPre}



\begin{DoxyPre} jx nx - 1\end{DoxyPre}



\begin{DoxyPre} jv index for pointing to the suitable ipio2[] for the
    computation. In general, we want
        ( 2^e0*x[0] * ipio2[jv-1]*2^(-24jv) )/8
    is an integer. Thus
        e0-3-24*jv >= 0 or (e0-3)/24 >= jv
    Hence jv = max(0,(e0-3)/24).\end{DoxyPre}



\begin{DoxyPre} jp jp+1 is the number of terms in PIo2[] needed, jp = jk.\end{DoxyPre}



\begin{DoxyPre}    q[] double array with integral value, representing the
    24-bits chunk of the product of x and 2/pi.\end{DoxyPre}



\begin{DoxyPre} q0 the corresponding exponent of q[0]. Note that the
    exponent for q[i] would be q0-24*i.\end{DoxyPre}



\begin{DoxyPre} PIo2[] double precision array, obtained by cutting pi/2
    into 24 bits chunks.\end{DoxyPre}



\begin{DoxyPre} f[]    ipio2[] in floating point\end{DoxyPre}



\begin{DoxyPre} iq[]   integer array by breaking up q[] in 24-bits chunk.\end{DoxyPre}



\begin{DoxyPre} fq[]   final product of x*(2/pi) in fq[0],..,fq[jk]\end{DoxyPre}



\begin{DoxyPre} ih integer. If >0 it indicates q[] is >= 0.5, hence
    it also indicates the *sign* of the result.\end{DoxyPre}



\begin{DoxyPre}\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 190 of file kremp2.\+c.



References init\+\_\+jk, one, P\+Io2, scalbn(), two24, twon24, and zero.



Referenced by rempio2().


\begin{DoxyCode}
191 \{
192     \textcolor{keywordtype}{int} jz,jx,jv,jp,jk,carry,n,iq[20],i,j,k,m,q0,ih;
193     \textcolor{keywordtype}{double} z,fw,f[20],fq[20],q[20];
194 
195     \textcolor{comment}{/* initialize jk*/}
196     jk = \hyperlink{kremp2_8c_a591225cae5038cecf9ef2fb8d0bc9b38}{init\_jk}[prec];
197     jp = jk;
198 
199     \textcolor{comment}{/* determine jx,jv,q0, note that 3>q0 */}
200     jx =  nx-1;
201     jv = (e0-3)/24;
202     \textcolor{keywordflow}{if}(jv<0) jv=0;
203     q0 =  e0-24*(jv+1);
204 
205     \textcolor{comment}{/* set up f[0] to f[jx+jk] where f[jx+jk] = ipio2[jv+jk] */}
206     j = jv-jx;
207     m = jx+jk;
208     \textcolor{keywordflow}{for}(i=0; i<=m; i++,j++) f[i] = (j<0)? \hyperlink{kremp2_8c_a554f7b66b1ba49443447eb746978c268}{zero} : (double) ipio2[j];
209 
210     \textcolor{comment}{/* compute q[0],q[1],...q[jk] */}
211     \textcolor{keywordflow}{for} (i=0; i<=jk; i++) \{
212         \textcolor{keywordflow}{for}(j=0,fw=0.0; j<=jx; j++) fw += x[j]*f[jx+i-j];
213         q[i] = fw;
214     \}
215 
216     jz = jk;
217 recompute:
218     \textcolor{comment}{/* distill q[] into iq[] reversingly */}
219     \textcolor{keywordflow}{for}(i=0,j=jz,z=q[jz]; j>0; i++,j--) \{
220         fw    =  (double)((\textcolor{keywordtype}{int})(\hyperlink{kremp2_8c_af34c3d59756eba41a4ba7ae5c403f432}{twon24}* z));
221         iq[i] =  (int)(z-\hyperlink{kremp2_8c_a578df73908b4f4182b101d31c7675202}{two24}*fw);
222         z     =  q[j-1]+fw;
223     \}
224 
225     \textcolor{comment}{/* compute n */}
226     z  = \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn}(z,q0);        \textcolor{comment}{/* actual value of z */}
227     z -= 8.0*\hyperlink{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}{floor}(z*0.125);       \textcolor{comment}{/* trim off integer >= 8 */}
228     n  = (int) z;
229     z -= (double)n;
230     ih = 0;
231     \textcolor{keywordflow}{if}(q0>0) \{  \textcolor{comment}{/* need iq[jz-1] to determine n */}
232         i  = (iq[jz-1]>>(24-q0));
233         n += i;
234         iq[jz-1] -= i<<(24-q0);
235         ih = iq[jz-1]>>(23-q0);
236     \}
237     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(q0==0) ih = iq[jz-1]>>23;
238     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(z>=0.5) ih=2;
239 
240     \textcolor{keywordflow}{if}(ih>0) \{  \textcolor{comment}{/* q > 0.5 */}
241         n += 1;
242         carry = 0;
243         \textcolor{keywordflow}{for}(i=0; i<jz ; i++) \{  \textcolor{comment}{/* compute 1-q */}
244             j = iq[i];
245             \textcolor{keywordflow}{if}(carry==0) \{
246                 \textcolor{keywordflow}{if}(j!=0) \{
247                     carry = 1;
248                     iq[i] = 0x1000000- j;
249                 \}
250             \} \textcolor{keywordflow}{else}  iq[i] = 0xffffff - j;
251         \}
252         \textcolor{keywordflow}{if}(q0>0) \{      \textcolor{comment}{/* rare case: chance is 1 in 12 */}
253             \textcolor{keywordflow}{switch}(q0) \{
254             \textcolor{keywordflow}{case} 1:
255                 iq[jz-1] &= 0x7fffff;
256                 \textcolor{keywordflow}{break};
257             \textcolor{keywordflow}{case} 2:
258                 iq[jz-1] &= 0x3fffff;
259                 \textcolor{keywordflow}{break};
260             \}
261         \}
262         \textcolor{keywordflow}{if}(ih==2) \{
263             z = \hyperlink{kremp2_8c_ada85e349d35971b32c8ea4238881ff8b}{one} - z;
264             \textcolor{keywordflow}{if}(carry!=0) z -= \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn}(\hyperlink{kremp2_8c_ada85e349d35971b32c8ea4238881ff8b}{one},q0);
265         \}
266     \}
267 
268     \textcolor{comment}{/* check if recomputation is needed */}
269     \textcolor{keywordflow}{if}(z==\hyperlink{kremp2_8c_a554f7b66b1ba49443447eb746978c268}{zero}) \{
270         j = 0;
271         \textcolor{keywordflow}{for} (i=jz-1; i>=jk; i--) j |= iq[i];
272         \textcolor{keywordflow}{if}(j==0) \{ \textcolor{comment}{/* need recomputation */}
273             \textcolor{keywordflow}{for}(k=1; iq[jk-k]==0; k++); \textcolor{comment}{/* k = no. of terms needed */}
274 
275             \textcolor{keywordflow}{for}(i=jz+1; i<=jz+k; i++) \{ \textcolor{comment}{/* add q[jz+1] to q[jz+k] */}
276                 f[jx+i] = (double) ipio2[jv+i];
277                 \textcolor{keywordflow}{for}(j=0,fw=0.0; j<=jx; j++) fw += x[j]*f[jx+i-j];
278                 q[i] = fw;
279             \}
280             jz += k;
281             \textcolor{keywordflow}{goto} recompute;
282         \}
283     \}
284 
285     \textcolor{comment}{/* chop off zero terms */}
286     \textcolor{keywordflow}{if}(z==0.0) \{
287         jz -= 1;
288         q0 -= 24;
289         \textcolor{keywordflow}{while}(iq[jz]==0) \{
290             jz--;
291             q0-=24;
292         \}
293     \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{/* break z into 24-bit if necessary */}
294         z = \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn}(z,-q0);
295         \textcolor{keywordflow}{if}(z>=\hyperlink{kremp2_8c_a578df73908b4f4182b101d31c7675202}{two24}) \{
296             fw = (double)((\textcolor{keywordtype}{int})(\hyperlink{kremp2_8c_af34c3d59756eba41a4ba7ae5c403f432}{twon24}*z));
297             iq[jz] = (int)(z-\hyperlink{kremp2_8c_a578df73908b4f4182b101d31c7675202}{two24}*fw);
298             jz += 1;
299             q0 += 24;
300             iq[jz] = (int) fw;
301         \} \textcolor{keywordflow}{else} iq[jz] = (int) z ;
302     \}
303 
304     \textcolor{comment}{/* convert integer "bit" chunk to floating-point value */}
305     fw = \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn}(\hyperlink{kremp2_8c_ada85e349d35971b32c8ea4238881ff8b}{one},q0);
306     \textcolor{keywordflow}{for}(i=jz; i>=0; i--) \{
307         q[i] = fw*(double)iq[i];
308         fw*=\hyperlink{kremp2_8c_af34c3d59756eba41a4ba7ae5c403f432}{twon24};
309     \}
310 
311     \textcolor{comment}{/* compute PIo2[0,...,jp]*q[jz,...,0] */}
312     \textcolor{keywordflow}{for}(i=jz; i>=0; i--) \{
313         \textcolor{keywordflow}{for}(fw=0.0,k=0; k<=jp&&k<=jz-i; k++) fw += \hyperlink{kremp2_8c_a1fe3f83e715fb3fb06eafc76dc16c79d}{PIo2}[k]*q[i+k];
314         fq[jz-i] = fw;
315     \}
316 
317     \textcolor{comment}{/* compress fq[] into y[] */}
318     \textcolor{keywordflow}{switch}(prec) \{
319     \textcolor{keywordflow}{case} 0:
320         fw = 0.0;
321         \textcolor{keywordflow}{for} (i=jz; i>=0; i--) fw += fq[i];
322         y[0] = (ih==0)? fw: -fw;
323         \textcolor{keywordflow}{break};
324     \textcolor{keywordflow}{case} 1:
325     \textcolor{keywordflow}{case} 2:
326         fw = 0.0;
327         \textcolor{keywordflow}{for} (i=jz; i>=0; i--) fw += fq[i];
328         y[0] = (ih==0)? fw: -fw;
329         fw = fq[0]-fw;
330         \textcolor{keywordflow}{for} (i=1; i<=jz; i++) fw += fq[i];
331         y[1] = (ih==0)? fw: -fw;
332         \textcolor{keywordflow}{break};
333     \textcolor{keywordflow}{case} 3: \textcolor{comment}{/* painful */}
334         \textcolor{keywordflow}{for} (i=jz; i>0; i--) \{
335             fw      = fq[i-1]+fq[i];
336             fq[i]  += fq[i-1]-fw;
337             fq[i-1] = fw;
338         \}
339         \textcolor{keywordflow}{for} (i=jz; i>1; i--) \{
340             fw      = fq[i-1]+fq[i];
341             fq[i]  += fq[i-1]-fw;
342             fq[i-1] = fw;
343         \}
344         \textcolor{keywordflow}{for} (fw=0.0,i=jz; i>=2; i--) fw += fq[i];
345         \textcolor{keywordflow}{if}(ih==0) \{
346             y[0] =  fq[0];
347             y[1] =  fq[1];
348             y[2] =  fw;
349         \} \textcolor{keywordflow}{else} \{
350             y[0] = -fq[0];
351             y[1] = -fq[1];
352             y[2] = -fw;
353         \}
354     \}
355     \textcolor{keywordflow}{return} n&7;
356 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=259pt]{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71_icgraph}
\end{center}
\end{figure}


\index{real/prim.\+h@{real/prim.\+h}!\+\_\+\+\_\+kernel\+\_\+sin@{\+\_\+\+\_\+kernel\+\_\+sin}}
\index{\+\_\+\+\_\+kernel\+\_\+sin@{\+\_\+\+\_\+kernel\+\_\+sin}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+kernel\+\_\+sin(double x, double y, int iy)}{__kernel_sin(double x, double y, int iy)}}]{\setlength{\rightskip}{0pt plus 5cm}double \+\_\+\+\_\+kernel\+\_\+sin (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y, }
\item[{int}]{iy}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{}\label{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}


Kernel sin function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}
Kernel sin function on \mbox{[}-\/pi/4, pi/4\mbox{]}, pi/4 $\sim$ 0.\+7854 Input x is assumed to be bounded by $\sim$pi/4 in magnitude. Input y is the tail of x. Input iy indicates whether y is 0. (if iy=0, y assume to be 0).

Algorithm
\begin{DoxyEnumerate}
\item Since sin(-\/x) = -\/sin(x), we need only to consider positive x.
\item if x $<$ 2$^\wedge$-\/27 (hx$<$0x3e400000 0), return x with inexact if x!=0.
\item sin(x) is approximated by a polynomial of degree 13 on \mbox{[}0,pi/4\mbox{]} 3 13 sin(x) $\sim$ x + S1$\ast$x + ... + S6$\ast$x where

$\vert$sin(x) 2 4 6 8 10 12 $\vert$ -\/58 $\vert$-\/-\/-\/-\/-\/ -\/ (1+\+S1$\ast$x +\+S2$\ast$x +\+S3$\ast$x +\+S4$\ast$x +\+S5$\ast$x +\+S6$\ast$x )$\vert$ $<$= 2 $\vert$ x $\vert$
\item sin(x+y) = sin(x) + sin\textquotesingle{}(x\textquotesingle{})$\ast$y $\sim$ sin(x) + (1-\/x$\ast$x/2)$\ast$y For better accuracy, let 3 2 2 2 2 r = x $\ast$(S2+x $\ast$(S3+x $\ast$(S4+x $\ast$(S5+x $\ast$\+S6)))) then 3 2 sin(x) = x + (S1$\ast$x + (x $\ast$(r-\/y/2)+y))  \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}

\end{DoxyEnumerate}

Definition at line 92 of file ksin.\+c.



References half, S1, S2, S3, S4, S5, and S6.



Referenced by cos(), and sin().


\begin{DoxyCode}
93 \{
94     \textcolor{keywordtype}{double} z,r,v;
95     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix;
96     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix,x);
97     ix &=0x7fffffff;    \textcolor{comment}{/* high word of x */}
98     \textcolor{keywordflow}{if}(ix<0x3e400000)           \textcolor{comment}{/* |x| < 2**-27 */}
99     \{
100         \textcolor{keywordflow}{if}((\textcolor{keywordtype}{int})x==0) \textcolor{keywordflow}{return} x;   \textcolor{comment}{/* generate inexact */}
101     \}
102     z   =  x*x;
103     v   =  z*x;
104     r   =  \hyperlink{ksin_8c_a8c3f693401b686cf859fcab159fc8107}{S2}+z*(\hyperlink{ksin_8c_a144f59cad8d7db388163cb7e6cfc2b65}{S3}+z*(\hyperlink{ksin_8c_a6b21eb9a5f7bdf9ecdefa39976e0ad30}{S4}+z*(\hyperlink{ksin_8c_a7130eb5d44ec24267050db30811108bb}{S5}+z*\hyperlink{ksin_8c_a5cb354c0755b50c13a3372eb09fdd978}{S6})));
105     \textcolor{keywordflow}{if}(iy==0) \textcolor{keywordflow}{return} x+v*(\hyperlink{ksin_8c_a838dbbe56fba09f2f8abf920f75d7c90}{S1}+z*r);
106     \textcolor{keywordflow}{else}      \textcolor{keywordflow}{return} x-((z*(\hyperlink{ksin_8c_a701d1f7de8380226dbc8825672ae4ef0}{half}*y-v*r)-y)-v*\hyperlink{ksin_8c_a838dbbe56fba09f2f8abf920f75d7c90}{S1});
107 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293_icgraph}
\end{center}
\end{figure}


\index{real/prim.\+h@{real/prim.\+h}!\+\_\+\+\_\+kernel\+\_\+tan@{\+\_\+\+\_\+kernel\+\_\+tan}}
\index{\+\_\+\+\_\+kernel\+\_\+tan@{\+\_\+\+\_\+kernel\+\_\+tan}!real/prim.\+h@{real/prim.\+h}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+kernel\+\_\+tan(double x, double y, int iy)}{__kernel_tan(double x, double y, int iy)}}]{\setlength{\rightskip}{0pt plus 5cm}double \+\_\+\+\_\+kernel\+\_\+tan (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y, }
\item[{int}]{iy}
\end{DoxyParamCaption}
)}\hypertarget{real_2prim_8h_a5f1c9e105e0dbca8a88407dd899043c6}{}\label{real_2prim_8h_a5f1c9e105e0dbca8a88407dd899043c6}


Kernel tan function. 

\begin{DoxyVersion}{Version}
1.\+5 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
04/04/22
\end{DoxyDate}
Kernel tan function on \mbox{[}-\/pi/4, pi/4\mbox{]}, pi/4 $\sim$ 0.\+7854 Input x is assumed to be bounded by $\sim$pi/4 in magnitude. Input y is the tail of x. Input k indicates whether tan (if k = 1) or -\/1/tan (if k = -\/1) is returned.

Algorithm
\begin{DoxyEnumerate}
\item Since tan(-\/x) = -\/tan(x), we need only to consider positive x.
\item if x $<$ 2$^\wedge$-\/28 (hx$<$0x3e300000 0), return x with inexact if x!=0.
\item tan(x) is approximated by a odd polynomial of degree 27 on \mbox{[}0,0.\+67434\mbox{]} 3 27 tan(x) $\sim$ x + T1$\ast$x + ... + T13$\ast$x where \begin{DoxyVerb}    |tan(x)         2     4            26   |     -59.2
    |----- - (1+T1*x +T2*x +.... +T13*x    )| <= 2
    |  x                    |
\end{DoxyVerb}


Note\+: tan(x+y) = tan(x) + tan\textquotesingle{}(x)$\ast$y $\sim$ tan(x) + (1+x$\ast$x)$\ast$y Therefore, for better accuracy in computing tan(x+y), let 3 2 2 2 2 r = x $\ast$(T2+x $\ast$(T3+x $\ast$(...+x $\ast$(T12+x $\ast$\+T13)))) then 3 2 tan(x+y) = x + (T1$\ast$x + (x $\ast$(r+y)+y))
\begin{DoxyEnumerate}
\item For x in \mbox{[}0.\+67434,pi/4\mbox{]}, let y = pi/4 -\/ x, then tan(x) = tan(pi/4-\/y) = (1-\/tan(y))/(1+tan(y)) = 1 -\/ 2$\ast$(tan(y) -\/ (tan(y)$^\wedge$2)/(1+tan(y)))  \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}

\end{DoxyEnumerate}
\end{DoxyEnumerate}

Definition at line 112 of file ktan.\+c.



Referenced by tan().


\begin{DoxyCode}
112                                                 \{
113     \textcolor{keywordtype}{double} z, r, v, w, s;
114     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix, hx;
115 
116     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x); \textcolor{comment}{/* high word of x */}
117     ix = hx & 0x7fffffff;           \textcolor{comment}{/* high word of |x| */}
118     \textcolor{keywordflow}{if} (ix < 0x3e300000) \{          \textcolor{comment}{/* x < 2**-28 */}
119         \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{int}) x == 0) \{     \textcolor{comment}{/* generate inexact */}
120             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} low;
121             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(low,x);
122             \textcolor{keywordflow}{if} (((ix | low) | (iy + 1)) == 0)
123                 \textcolor{keywordflow}{return} \hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} / \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
124             \textcolor{keywordflow}{else} \{
125                 \textcolor{keywordflow}{if} (iy == 1)
126                     \textcolor{keywordflow}{return} x;
127                 \textcolor{keywordflow}{else} \{  \textcolor{comment}{/* compute -1 / (x+y) carefully */}
128                     \textcolor{keywordtype}{double} a, t;
129 
130                     z = w = x + y;
131                     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(z,0);
132                     v = y - (z - x);
133                     t = a = -\hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} / w;
134                     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
135                     s = \hyperlink{ktan_8c_a7cf126dbeb6f30c606e3b42fea65cfef}{one} + t * z;
136                     \textcolor{keywordflow}{return} t + a * (s + t * v);
137                 \}
138             \}
139         \}
140     \}
141     \textcolor{keywordflow}{if} (ix >= 0x3FE59428) \{ \textcolor{comment}{/* |x| >= 0.6744 */}
142         \textcolor{keywordflow}{if} (hx < 0) \{
143             x = -x;
144             y = -y;
145         \}
146         z = \hyperlink{ktan_8c_a75e16f8efd77d78a9a4a1fff4e77cb90}{pio4} - x;
147         w = \hyperlink{ktan_8c_a7857585f1affed40b5174c5175a1e389}{pio4lo} - y;
148         x = z + w;
149         y = 0.0;
150     \}
151     z = x * x;
152     w = z * z;
153     \textcolor{comment}{/*}
154 \textcolor{comment}{     * Break x^5*(T[1]+x^2*T[2]+...) into}
155 \textcolor{comment}{     * x^5(T[1]+x^4*T[3]+...+x^20*T[11]) +}
156 \textcolor{comment}{     * x^5(x^2*(T[2]+x^4*T[4]+...+x^22*[T12]))}
157 \textcolor{comment}{     */}
158     r = \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[1] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[3] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[5] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[7] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[9] +
159                                             w * \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[11]))));
160     v = z * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[2] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[4] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[6] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[8] + w * (\hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[10] +
161                                      w * \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[12])))));
162     s = z * x;
163     r = y + z * (s * (r + v) + y);
164     r += \hyperlink{ktan_8c_a0acb682b8260ab1c60b918599864e2e5}{T}[0] * s;
165     w = x + r;
166     \textcolor{keywordflow}{if} (ix >= 0x3FE59428) \{
167         v = (double) iy;
168         \textcolor{keywordflow}{return} (\textcolor{keywordtype}{double}) (1 - ((hx >> 30) & 2)) *
169                (v - 2.0 * (x - (w * w / (w + v) - r)));
170     \}
171     \textcolor{keywordflow}{if} (iy == 1)
172         \textcolor{keywordflow}{return} w;
173     \textcolor{keywordflow}{else} \{
174         \textcolor{comment}{/*}
175 \textcolor{comment}{         * if allow error up to 2 ulp, simply return}
176 \textcolor{comment}{         * -1.0 / (x+r) here}
177 \textcolor{comment}{         */}
178         \textcolor{comment}{/* compute -1.0 / (x+r) accurately */}
179         \textcolor{keywordtype}{double} a, t;
180         z = w;
181         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(z,0);
182         v = r - (z - x);    \textcolor{comment}{/* z+v = r+x */}
183         t = a = -1.0 / w;   \textcolor{comment}{/* a = -1.0/w */}
184         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
185         s = 1.0 + t * z;
186         \textcolor{keywordflow}{return} t + a * (s + t * v);
187     \}
188 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{real_2prim_8h_a5f1c9e105e0dbca8a88407dd899043c6_icgraph}
\end{center}
\end{figure}


