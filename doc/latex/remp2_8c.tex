\hypertarget{remp2_8c}{}\section{lib/real/remp2.c File Reference}
\label{remp2_8c}\index{lib/real/remp2.\+c@{lib/real/remp2.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
Include dependency graph for remp2.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{remp2_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{remp2_8c_a320ce87737d621d713124124e2c02cdc}{rempio2} (double x, double $\ast$y)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const int \hyperlink{remp2_8c_a3f7524a732d3106dbceeddace65a9f28}{two\+\_\+over\+\_\+pi} \mbox{[}$\,$\mbox{]}
\item 
static const int \hyperlink{remp2_8c_ab03299565b9ed58c920072d909fad477}{npio2\+\_\+hw} \mbox{[}$\,$\mbox{]}
\item 
static const double \hyperlink{remp2_8c_a554f7b66b1ba49443447eb746978c268}{zero} = 0.\+00000000000000000000e+00
\item 
static const double \hyperlink{remp2_8c_a701d1f7de8380226dbc8825672ae4ef0}{half} = 5.\+00000000000000000000e-\/01
\item 
static const double \hyperlink{remp2_8c_a578df73908b4f4182b101d31c7675202}{two24} = 1.\+67772160000000000000e+07
\item 
static const double \hyperlink{remp2_8c_a03a134e339c548e26c774634bfe71100}{invpio2} = 6.\+36619772367581382433e-\/01
\item 
static const double \hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\+\_\+1} = 1.\+57079632673412561417e+00
\item 
static const double \hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\+\_\+1t} = 6.\+07710050650619224932e-\/11
\item 
static const double \hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\+\_\+2} = 6.\+07710050630396597660e-\/11
\item 
static const double \hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\+\_\+2t} = 2.\+02226624879595063154e-\/21
\item 
static const double \hyperlink{remp2_8c_ae1934d5e01d08b4f35c23aae592201a9}{pio2\+\_\+3} = 2.\+02226624871116645580e-\/21
\item 
static const double \hyperlink{remp2_8c_a72f07a944e6e926d3de11a6623b7be39}{pio2\+\_\+3t} = 8.\+47842766036889956997e-\/32
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{remp2.\+c@{remp2.\+c}!rempio2@{rempio2}}
\index{rempio2@{rempio2}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{rempio2(double x, double $\ast$y)}{rempio2(double x, double *y)}}]{\setlength{\rightskip}{0pt plus 5cm}int rempio2 (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double $\ast$}]{y}
\end{DoxyParamCaption}
)}\hypertarget{remp2_8c_a320ce87737d621d713124124e2c02cdc}{}\label{remp2_8c_a320ce87737d621d713124124e2c02cdc}


Definition at line 103 of file remp2.\+c.



References \+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2(), half, invpio2, npio2\+\_\+hw, pio2\+\_\+1, pio2\+\_\+1t, pio2\+\_\+2, pio2\+\_\+2t, pio2\+\_\+3, pio2\+\_\+3t, two24, two\+\_\+over\+\_\+pi, and zero.



Referenced by cos(), sin(), and tan().


\begin{DoxyCode}
104 \{
105     \textcolor{keywordtype}{double} z = 0.,w,t,r,fn;
106     \textcolor{keywordtype}{double} tx[3];
107     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} i,j,n,ix,hx;
108     \textcolor{keywordtype}{int} e0,nx;
109     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} low;
110 
111     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);       \textcolor{comment}{/* high word of x */}
112     ix = hx&0x7fffffff;
113     \textcolor{keywordflow}{if}(ix<=0x3fe921fb)   \textcolor{comment}{/* |x| ~<= pi/4 , no need for reduction */}
114     \{
115         y[0] = x;
116         y[1] = 0;
117         \textcolor{keywordflow}{return} 0;
118     \}
119     \textcolor{keywordflow}{if}(ix<0x4002d97c) \{  \textcolor{comment}{/* |x| < 3pi/4, special case with n=+-1 */}
120         \textcolor{keywordflow}{if}(hx>0) \{
121             z = x - \hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\_1};
122             \textcolor{keywordflow}{if}(ix!=0x3ff921fb) \{    \textcolor{comment}{/* 33+53 bit pi is good enough */}
123                 y[0] = z - \hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\_1t};
124                 y[1] = (z-y[0])-pio2\_1t;
125             \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* near pi/2, use 33+33+53 bit pi */}
126                 z -= \hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\_2};
127                 y[0] = z - \hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\_2t};
128                 y[1] = (z-y[0])-pio2\_2t;
129             \}
130             \textcolor{keywordflow}{return} 1;
131         \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{/* negative x */}
132             z = x + \hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\_1};
133             \textcolor{keywordflow}{if}(ix!=0x3ff921fb) \{    \textcolor{comment}{/* 33+53 bit pi is good enough */}
134                 y[0] = z + \hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\_1t};
135                 y[1] = (z-y[0])+pio2\_1t;
136             \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* near pi/2, use 33+33+53 bit pi */}
137                 z += \hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\_2};
138                 y[0] = z + \hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\_2t};
139                 y[1] = (z-y[0])+pio2\_2t;
140             \}
141             \textcolor{keywordflow}{return} -1;
142         \}
143     \}
144     \textcolor{keywordflow}{if}(ix<=0x413921fb) \{ \textcolor{comment}{/* |x| ~<= 2^19*(pi/2), medium size */}
145         t  = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
146         n  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}) (t*\hyperlink{remp2_8c_a03a134e339c548e26c774634bfe71100}{invpio2}+\hyperlink{remp2_8c_a701d1f7de8380226dbc8825672ae4ef0}{half});
147         fn = (double)n;
148         r  = t-fn*\hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\_1};
149         w  = fn*\hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\_1t}; \textcolor{comment}{/* 1st round good to 85 bit */}
150         \textcolor{keywordflow}{if}(n<32&&ix!=\hyperlink{remp2_8c_ab03299565b9ed58c920072d909fad477}{npio2\_hw}[n-1]) \{
151             y[0] = r-w; \textcolor{comment}{/* quick check no cancellation */}
152         \} \textcolor{keywordflow}{else} \{
153             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} high;
154 
155             j  = ix>>20;
156             y[0] = r-w;
157             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(high, y[0]);
158             i = j-((high>>20)&0x7ff);
159             \textcolor{keywordflow}{if}(i>16) \{  \textcolor{comment}{/* 2nd iteration needed, good to 118 */}
160                 t  = r;
161                 w  = fn*\hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\_2};
162                 r  = t-w;
163                 w  = fn*\hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\_2t}-((t-r)-w);
164                 y[0] = r-w;
165                 \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(high,y[0]);
166                 i = j-((high>>20)&0x7ff);
167                 \textcolor{keywordflow}{if}(i>49)  \{ \textcolor{comment}{/* 3rd iteration need, 151 bits acc */}
168                     t  = r; \textcolor{comment}{/* will cover all possible cases */}
169                     w  = fn*\hyperlink{remp2_8c_ae1934d5e01d08b4f35c23aae592201a9}{pio2\_3};
170                     r  = t-w;
171                     w  = fn*\hyperlink{remp2_8c_a72f07a944e6e926d3de11a6623b7be39}{pio2\_3t}-((t-r)-w);
172                     y[0] = r-w;
173                 \}
174             \}
175         \}
176         y[1] = (r-y[0])-w;
177         \textcolor{keywordflow}{if}(hx<0)    \{
178             y[0] = -y[0];
179             y[1] = -y[1];
180             \textcolor{keywordflow}{return} -n;
181         \}
182         \textcolor{keywordflow}{else}     \textcolor{keywordflow}{return} n;
183     \}
184     \textcolor{comment}{/*}
185 \textcolor{comment}{     * all other (large) arguments}
186 \textcolor{comment}{     */}
187     \textcolor{keywordflow}{if}(ix>=0x7ff00000) \{        \textcolor{comment}{/* x is inf or NaN */}
188         y[0]=y[1]=x-x;
189         \textcolor{keywordflow}{return} 0;
190     \}
191     \textcolor{comment}{/* set z = scalbn(|x|,ilogb(x)-23) */}
192     \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(low,x);
193     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(z,low);
194     e0  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(ix>>20)-1046;    \textcolor{comment}{/* e0 = ilogb(z)-23; */}
195     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(z,ix - (e0<<20));
196     \textcolor{keywordflow}{for}(i=0; i<2; i++) \{
197         tx[i] = (double)((\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(z));
198         z     = (z-tx[i])*\hyperlink{remp2_8c_a578df73908b4f4182b101d31c7675202}{two24};
199     \}
200     tx[2] = z;
201     nx = 3;
202     \textcolor{keywordflow}{while}(tx[nx-1]==\hyperlink{remp2_8c_a554f7b66b1ba49443447eb746978c268}{zero}) nx--; \textcolor{comment}{/* skip zero term */}
203     n  =  \hyperlink{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71}{\_\_kernel\_rem\_pio2}(tx,y,e0,nx,2,\hyperlink{remp2_8c_a3f7524a732d3106dbceeddace65a9f28}{two\_over\_pi});
204     \textcolor{keywordflow}{if}(hx<0) \{
205         y[0] = -y[0];
206         y[1] = -y[1];
207         \textcolor{keywordflow}{return} -n;
208     \}
209     \textcolor{keywordflow}{return} n;
210 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{remp2_8c_a320ce87737d621d713124124e2c02cdc_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{remp2_8c_a320ce87737d621d713124124e2c02cdc_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{remp2.\+c@{remp2.\+c}!half@{half}}
\index{half@{half}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{half}{half}}]{\setlength{\rightskip}{0pt plus 5cm}const double half = 5.\+00000000000000000000e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a701d1f7de8380226dbc8825672ae4ef0}{}\label{remp2_8c_a701d1f7de8380226dbc8825672ae4ef0}


Definition at line 93 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!invpio2@{invpio2}}
\index{invpio2@{invpio2}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{invpio2}{invpio2}}]{\setlength{\rightskip}{0pt plus 5cm}const double invpio2 = 6.\+36619772367581382433e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a03a134e339c548e26c774634bfe71100}{}\label{remp2_8c_a03a134e339c548e26c774634bfe71100}


Definition at line 95 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!npio2\+\_\+hw@{npio2\+\_\+hw}}
\index{npio2\+\_\+hw@{npio2\+\_\+hw}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{npio2\+\_\+hw}{npio2_hw}}]{\setlength{\rightskip}{0pt plus 5cm}const int npio2\+\_\+hw\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_ab03299565b9ed58c920072d909fad477}{}\label{remp2_8c_ab03299565b9ed58c920072d909fad477}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
    0x3FF921FB, 0x400921FB, 0x4012D97C, 0x401921FB, 0x401F6A7A, 0x4022D97C,
    0x4025FDBB, 0x402921FB, 0x402C463A, 0x402F6A7A, 0x4031475C, 0x4032D97C,
    0x40346B9C, 0x4035FDBB, 0x40378FDB, 0x403921FB, 0x403AB41B, 0x403C463A,
    0x403DD85A, 0x403F6A7A, 0x40407E4C, 0x4041475C, 0x4042106C, 0x4042D97C,
    0x4043A28C, 0x40446B9C, 0x404534AC, 0x4045FDBB, 0x4046C6CB, 0x40478FDB,
    0x404858EB, 0x404921FB,
\}
\end{DoxyCode}


Definition at line 72 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!pio2\+\_\+1@{pio2\+\_\+1}}
\index{pio2\+\_\+1@{pio2\+\_\+1}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+1}{pio2_1}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+1 = 1.\+57079632673412561417e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{}\label{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}


Definition at line 96 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!pio2\+\_\+1t@{pio2\+\_\+1t}}
\index{pio2\+\_\+1t@{pio2\+\_\+1t}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+1t}{pio2_1t}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+1t = 6.\+07710050650619224932e-\/11\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{}\label{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}


Definition at line 97 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!pio2\+\_\+2@{pio2\+\_\+2}}
\index{pio2\+\_\+2@{pio2\+\_\+2}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+2}{pio2_2}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+2 = 6.\+07710050630396597660e-\/11\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{}\label{remp2_8c_af6aea39973983ce1f6314f9158ac885d}


Definition at line 98 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!pio2\+\_\+2t@{pio2\+\_\+2t}}
\index{pio2\+\_\+2t@{pio2\+\_\+2t}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+2t}{pio2_2t}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+2t = 2.\+02226624879595063154e-\/21\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a59bed798e158756e8dca5cee80699280}{}\label{remp2_8c_a59bed798e158756e8dca5cee80699280}


Definition at line 99 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!pio2\+\_\+3@{pio2\+\_\+3}}
\index{pio2\+\_\+3@{pio2\+\_\+3}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+3}{pio2_3}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+3 = 2.\+02226624871116645580e-\/21\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_ae1934d5e01d08b4f35c23aae592201a9}{}\label{remp2_8c_ae1934d5e01d08b4f35c23aae592201a9}


Definition at line 100 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!pio2\+\_\+3t@{pio2\+\_\+3t}}
\index{pio2\+\_\+3t@{pio2\+\_\+3t}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+3t}{pio2_3t}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+3t = 8.\+47842766036889956997e-\/32\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a72f07a944e6e926d3de11a6623b7be39}{}\label{remp2_8c_a72f07a944e6e926d3de11a6623b7be39}


Definition at line 101 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!two24@{two24}}
\index{two24@{two24}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{two24}{two24}}]{\setlength{\rightskip}{0pt plus 5cm}const double two24 = 1.\+67772160000000000000e+07\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a578df73908b4f4182b101d31c7675202}{}\label{remp2_8c_a578df73908b4f4182b101d31c7675202}


Definition at line 94 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!two\+\_\+over\+\_\+pi@{two\+\_\+over\+\_\+pi}}
\index{two\+\_\+over\+\_\+pi@{two\+\_\+over\+\_\+pi}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{two\+\_\+over\+\_\+pi}{two_over_pi}}]{\setlength{\rightskip}{0pt plus 5cm}const int two\+\_\+over\+\_\+pi\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a3f7524a732d3106dbceeddace65a9f28}{}\label{remp2_8c_a3f7524a732d3106dbceeddace65a9f28}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
    0xA2F983, 0x6E4E44, 0x1529FC, 0x2757D1, 0xF534DD, 0xC0DB62,
    0x95993C, 0x439041, 0xFE5163, 0xABDEBB, 0xC561B7, 0x246E3A,
    0x424DD2, 0xE00649, 0x2EEA09, 0xD1921C, 0xFE1DEB, 0x1CB129,
    0xA73EE8, 0x8235F5, 0x2EBB44, 0x84E99C, 0x7026B4, 0x5F7E41,
    0x3991D6, 0x398353, 0x39F49C, 0x845F8B, 0xBDF928, 0x3B1FF8,
    0x97FFDE, 0x05980F, 0xEF2F11, 0x8B5A0A, 0x6D1F6D, 0x367ECF,
    0x27CB09, 0xB74F46, 0x3F669E, 0x5FEA2D, 0x7527BA, 0xC7EBE5,
    0xF17B3D, 0x0739F7, 0x8A5292, 0xEA6BFB, 0x5FB11F, 0x8D5D08,
    0x560330, 0x46FC7B, 0x6BABF0, 0xCFBC20, 0x9AF436, 0x1DA9E3,
    0x91615E, 0xE61B08, 0x659985, 0x5F14A0, 0x68408D, 0xFFD880,
    0x4D7327, 0x310606, 0x1556CA, 0x73A8C9, 0x60E27B, 0xC08C6B,
\}
\end{DoxyCode}


Definition at line 58 of file remp2.\+c.



Referenced by rempio2().

\index{remp2.\+c@{remp2.\+c}!zero@{zero}}
\index{zero@{zero}!remp2.\+c@{remp2.\+c}}
\subsubsection[{\texorpdfstring{zero}{zero}}]{\setlength{\rightskip}{0pt plus 5cm}const double zero = 0.\+00000000000000000000e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{remp2_8c_a554f7b66b1ba49443447eb746978c268}{}\label{remp2_8c_a554f7b66b1ba49443447eb746978c268}


Definition at line 92 of file remp2.\+c.



Referenced by rempio2().

