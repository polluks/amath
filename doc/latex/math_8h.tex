\hypertarget{math_8h}{}\section{lib/math.h File Reference}
\label{math_8h}\index{lib/math.\+h@{lib/math.\+h}}


Functions in math library for handling real numbers.  


\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{math_8h_a598a3330b3c21701223ee0ca14316eca}{PI}~3.\+141592653589793238462643383279
\item 
\#define \hyperlink{math_8h_a3864675e7c86521b47396080e59ba03e}{E\+U\+L\+E\+RS}~2.\+718281828459045235360287471352
\item 
\#define \hyperlink{math_8h_ae1b5a554c1d4d97654c06032a92f800a}{sgn}(x)~x $>$ 0.\+0 ? 1.\+0 \+: x $<$ 0.\+0 ? -\/1.\+0 \+: 0.\+0
\item 
\#define \hyperlink{math_8h_a2df129f972d9b1faeabee4d7aeb1b439}{log2p}(x,  y)~\hyperlink{log_8c_adb302c9aafbaa5e180d9f60ee954bb82}{log}(x)/\hyperlink{log_8c_adb302c9aafbaa5e180d9f60ee954bb82}{log}(y)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{math_8h_afdf433fdb158cbe82ce818a3a2de736b}{isnan} (double x)
\begin{DoxyCompactList}\small\item\em isnan(x) returns 1 is x is nan, else 0. \end{DoxyCompactList}\item 
int \hyperlink{math_8h_a08e754462e6ec13bc05fd41cff9cdd4a}{finite} (double x)
\begin{DoxyCompactList}\small\item\em Finite or infinite number. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs} (double x)
\begin{DoxyCompactList}\small\item\em Returns the absolute value of x. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a1ea6d7b591132268abc2e843ababd084}{ceil} (double x)
\begin{DoxyCompactList}\small\item\em Mathematical ceiling function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}{floor} (double x)
\begin{DoxyCompactList}\small\item\em Mathematical floor function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a7df19cf730447c00150569250a4b5e1d}{round} (double x)
\item 
double \hyperlink{math_8h_a82a151adfde56b28fa8a50355c4f2ff6}{trunc} (double x)
\item 
double \hyperlink{math_8h_ae09128febbbe6372cde4fa0c65608a42}{exp} (double x)
\begin{DoxyCompactList}\small\item\em Returns the exponential of x. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt} (double x)
\begin{DoxyCompactList}\small\item\em Square root function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a8af00e2203928978e0242b4afd1d899f}{cbrt} (double x)
\begin{DoxyCompactList}\small\item\em Cube root function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{log} (double x)
\begin{DoxyCompactList}\small\item\em Natural logarithm function (base e). \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a6572e82a4891917a9ba7fb2a964f8182}{log10} (double x)
\begin{DoxyCompactList}\small\item\em Base 10 logarithm function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a5e7b53a694b3cf0f2d7debd444140fbd}{cos} (double x)
\begin{DoxyCompactList}\small\item\em Trigonometric cosine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_aad4af25633b071b0e2cdb8ebd87eca77}{sin} (double x)
\begin{DoxyCompactList}\small\item\em Trigonometric sine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_aa48fdfd5eea5f4f9c33496402b9e4039}{tan} (double x)
\begin{DoxyCompactList}\small\item\em Trigonometric tangent function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_ae93afe22ff34c79ee97ea3eaf77557db}{acos} (double x)
\begin{DoxyCompactList}\small\item\em Inverse trigonometric cosine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_aa9528d92a3ae44ad6484da0774604454}{asin} (double x)
\begin{DoxyCompactList}\small\item\em Inverse trigonometric sine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a1e2f8f6d64eaa95131bc63fee34970ea}{atan} (double x)
\begin{DoxyCompactList}\small\item\em Inverse trigonometric tangent function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a3795d3c1f1d30819be56da4e4d67f64b}{cosh} (double x)
\begin{DoxyCompactList}\small\item\em Hyperbolic cosine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a862012e970c977c482507064e2793b45}{sinh} (double x)
\begin{DoxyCompactList}\small\item\em Hyperbolic sine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_af85bcf153d7ae805733927f12329dac1}{tanh} (double x)
\begin{DoxyCompactList}\small\item\em Hyperbolic tangent function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_ac862445bcb46911b1782c284829d5e46}{acosh} (double x)
\begin{DoxyCompactList}\small\item\em Inverse hyperbolic cosine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a907297107e93ea9c8a0c8409a8e65079}{asinh} (double x)
\begin{DoxyCompactList}\small\item\em Inverse hyperbolic sine function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_ac07fd7b77fa341563abccf9efcc1a711}{atanh} (double x)
\begin{DoxyCompactList}\small\item\em Inverse hyperbolic tangent function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_aa56c9494c95edf68386375e97d64159b}{pow} (double x, double y)
\begin{DoxyCompactList}\small\item\em Expontation function. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a537296d1a8f9fb621676038b99ba7edf}{fmod} (double x, double y)
\begin{DoxyCompactList}\small\item\em Return x mod y in exact arithmetic. \end{DoxyCompactList}\item 
double \hyperlink{math_8h_a349377202ca14f79eb335b1a421fe4d8}{atan2} (double y, double x)
\item 
double \hyperlink{math_8h_a6d6a905f61d535f8454190433b8c0ea5}{hypot} (double x, double y)
\item 
double \hyperlink{math_8h_ac2aac20ab1347498e6e4f209148fea84}{log1p} (double x)
\item 
double \hyperlink{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}{expm1} (double x)
\item 
double \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn} (double x, int n)
\item 
double \hyperlink{math_8h_ad8d1296592a3e783acdd0de21ff58e2e}{copysign} (double x, double y)
\begin{DoxyCompactList}\small\item\em Returns a value with the magnitude of x and with the sign bit of y. \end{DoxyCompactList}\item 
int \hyperlink{math_8h_a320ce87737d621d713124124e2c02cdc}{rempio2} (double x, double $\ast$y)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Functions in math library for handling real numbers. 

The library is based on fdlib by Sun Microsystems. The original library can be downloaded at\+: \href{http://www.netlib.org/fdlibm/}{\tt http\+://www.\+netlib.\+org/fdlibm/}

or from mirros site\+: \href{http://www.hensa.ac.uk/}{\tt http\+://www.\+hensa.\+ac.\+uk/}

All headers and dates are preserved. 

\subsection{Macro Definition Documentation}
\index{math.\+h@{math.\+h}!E\+U\+L\+E\+RS@{E\+U\+L\+E\+RS}}
\index{E\+U\+L\+E\+RS@{E\+U\+L\+E\+RS}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{E\+U\+L\+E\+RS}{EULERS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\+U\+L\+E\+RS~2.\+718281828459045235360287471352}\hypertarget{math_8h_a3864675e7c86521b47396080e59ba03e}{}\label{math_8h_a3864675e7c86521b47396080e59ba03e}


Definition at line 46 of file math.\+h.

\index{math.\+h@{math.\+h}!log2p@{log2p}}
\index{log2p@{log2p}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{log2p}{log2p}}]{\setlength{\rightskip}{0pt plus 5cm}\#define log2p(
\begin{DoxyParamCaption}
\item[{}]{x, }
\item[{}]{y}
\end{DoxyParamCaption}
)~{\bf log}(x)/{\bf log}(y)}\hypertarget{math_8h_a2df129f972d9b1faeabee4d7aeb1b439}{}\label{math_8h_a2df129f972d9b1faeabee4d7aeb1b439}


Definition at line 48 of file math.\+h.

\index{math.\+h@{math.\+h}!PI@{PI}}
\index{PI@{PI}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{PI}{PI}}]{\setlength{\rightskip}{0pt plus 5cm}\#define PI~3.\+141592653589793238462643383279}\hypertarget{math_8h_a598a3330b3c21701223ee0ca14316eca}{}\label{math_8h_a598a3330b3c21701223ee0ca14316eca}


Definition at line 45 of file math.\+h.

\index{math.\+h@{math.\+h}!sgn@{sgn}}
\index{sgn@{sgn}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{sgn}{sgn}}]{\setlength{\rightskip}{0pt plus 5cm}\#define sgn(
\begin{DoxyParamCaption}
\item[{}]{x}
\end{DoxyParamCaption}
)~x $>$ 0.\+0 ? 1.\+0 \+: x $<$ 0.\+0 ? -\/1.\+0 \+: 0.\+0}\hypertarget{math_8h_ae1b5a554c1d4d97654c06032a92f800a}{}\label{math_8h_ae1b5a554c1d4d97654c06032a92f800a}


Definition at line 47 of file math.\+h.



\subsection{Function Documentation}
\index{math.\+h@{math.\+h}!acos@{acos}}
\index{acos@{acos}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{acos(double x)}{acos(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double acos (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ae93afe22ff34c79ee97ea3eaf77557db}{}\label{math_8h_ae93afe22ff34c79ee97ea3eaf77557db}


Inverse trigonometric cosine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 acos(x)  = pi/2 - asin(x)
 acos(-x) = pi/2 + asin(x)
For |x|<=0.5
 acos(x) = pi/2 - (x + x*x^2*R(x^2))    (see \hyperlink{asin_8c}{asin.c})
For x>0.5
    acos(x) = pi/2 - (pi/2 - 2asin(sqrt((1-x)/2)))
    = 2asin(sqrt((1-x)/2))
    = 2s + 2s*z*R(z)    ...z=(1-x)/2, s=sqrt(z)
    = 2f + (2c + 2s*z*R(z))
    where f=hi part of s, and c = (z-f*f)/(s+f) is the correction term
    for f so that f+c ~ sqrt(z).
For x<-0.5
 acos(x) = pi - 2asin(sqrt((1-|x|)/2))
    = pi - 0.5*(s+s*z*R(z)), where z=(1-|x|)/2,s=sqrt(z)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 if x is NaN, return x itself;
 if |x|>1, return NaN with invalid signal.\end{DoxyPre}



\begin{DoxyPre}Function needed: sqrt
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 96 of file acos.\+c.



References one, pi, pio2\+\_\+hi, pio2\+\_\+lo, p\+S0, p\+S1, p\+S2, p\+S3, p\+S4, p\+S5, q\+S1, q\+S2, q\+S3, q\+S4, and sqrt().



Referenced by Real\+Number\+::\+Arc\+Cosine(), and Real\+Number\+::\+Arc\+Secant().


\begin{DoxyCode}
97 \{
98     \textcolor{keywordtype}{double} z,p,q,r,w,s,c,df;
99     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,ix;
100     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
101     ix = hx&0x7fffffff;
102     \textcolor{keywordflow}{if}(ix>=0x3ff00000) \{    \textcolor{comment}{/* |x| >= 1 */}
103         \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} lx;
104         \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
105         \textcolor{keywordflow}{if}(((ix-0x3ff00000)|lx)==0) \{   \textcolor{comment}{/* |x|==1 */}
106             \textcolor{keywordflow}{if}(hx>0) \textcolor{keywordflow}{return} 0.0;        \textcolor{comment}{/* acos(1) = 0  */}
107             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \hyperlink{acos_8c_a43016d873124d39034edb8cd164794db}{pi}+2.0*\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};    \textcolor{comment}{/* acos(-1)= pi */}
108         \}
109         \textcolor{keywordflow}{return} (x-x)/(x-x);     \textcolor{comment}{/* acos(|x|>1) is NaN */}
110     \}
111     \textcolor{keywordflow}{if}(ix<0x3fe00000) \{ \textcolor{comment}{/* |x| < 0.5 */}
112         \textcolor{keywordflow}{if}(ix<=0x3c600000) \textcolor{keywordflow}{return} \hyperlink{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi}+\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};\textcolor{comment}{/*if|x|<2**-57*/}
113         z = x*x;
114         p = z*(\hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+z*(\hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+z*(\hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+z*(\hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+z*(\hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+z*\hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
115         q = \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+z*(\hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+z*(\hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+z*(\hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+z*\hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
116         r = p/q;
117         \textcolor{keywordflow}{return} \hyperlink{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi} - (x - (\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo}-x*r));
118     \} \textcolor{keywordflow}{else}  \textcolor{keywordflow}{if} (hx<0) \{     \textcolor{comment}{/* x < -0.5 */}
119         z = (\hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+x)*0.5;
120         p = z*(\hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+z*(\hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+z*(\hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+z*(\hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+z*(\hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+z*\hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
121         q = \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+z*(\hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+z*(\hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+z*(\hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+z*\hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
122         s = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(z);
123         r = p/q;
124         w = r*s-\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};
125         \textcolor{keywordflow}{return} \hyperlink{acos_8c_a43016d873124d39034edb8cd164794db}{pi} - 2.0*(s+w);
126     \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* x > 0.5 */}
127         z = (\hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-x)*0.5;
128         s = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(z);
129         df = s;
130         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(df,0);
131         c  = (z-df*df)/(s+df);
132         p = z*(\hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+z*(\hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+z*(\hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+z*(\hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+z*(\hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+z*\hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
133         q = \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+z*(\hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+z*(\hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+z*(\hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+z*\hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
134         r = p/q;
135         w = r*s+c;
136         \textcolor{keywordflow}{return} 2.0*(df+w);
137     \}
138 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=187pt]{math_8h_ae93afe22ff34c79ee97ea3eaf77557db_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=277pt]{math_8h_ae93afe22ff34c79ee97ea3eaf77557db_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!acosh@{acosh}}
\index{acosh@{acosh}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{acosh(double x)}{acosh(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double acosh (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ac862445bcb46911b1782c284829d5e46}{}\label{math_8h_ac862445bcb46911b1782c284829d5e46}


Inverse hyperbolic cosine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 Based on
    acosh(x) = log [ x + sqrt(x*x-1) ]
 we have
    acosh(x) := log(x)+ln2, if x is large; else
    acosh(x) := log(2x-1/(sqrt(x*x-1)+x)) if x>2; else
    acosh(x) := log1p(t+sqrt(2.0*t+t*t)); where t=x-1.\end{DoxyPre}



\begin{DoxyPre}Special cases:
 acosh(x) is NaN with signal if x<1.
 acosh(NaN) is NaN without signal.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 75 of file acosh.\+c.



References ln2, log1p(), one, and sqrt().



Referenced by Real\+Number\+::\+Hyp\+Arc\+Cosine(), and Real\+Number\+::\+Hyp\+Arc\+Secant().


\begin{DoxyCode}
76 \{
77     \textcolor{keywordtype}{double} t;
78     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx, lx;
79     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
80     \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
81 
82     \textcolor{keywordflow}{if}(hx<0x3ff00000) \{     \textcolor{comment}{/* x < 1 */}
83         \textcolor{keywordflow}{return} (x-x)/(x-x);
84     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(hx >=0x41b00000) \{    \textcolor{comment}{/* x > 2**28 */}
85         \textcolor{keywordflow}{if}(hx >=0x7ff00000) \{   \textcolor{comment}{/* x is inf of NaN */}
86             \textcolor{keywordflow}{return} x+x;
87         \} \textcolor{keywordflow}{else}
88             \textcolor{keywordflow}{return} \hyperlink{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{log}(x)+\hyperlink{acosh_8c_a703f4fc93e5a57058ce6ba2ba196918d}{ln2};    \textcolor{comment}{/* acosh(huge)=log(2x) */}
89     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(((hx-0x3ff00000)|lx)==0) \{
90         \textcolor{keywordflow}{return} 0.0;         \textcolor{comment}{/* acosh(1) = 0 */}
91     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (hx > 0x40000000) \{   \textcolor{comment}{/* 2**28 > x > 2 */}
92         t=x*x;
93         \textcolor{keywordflow}{return} \hyperlink{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{log}(2.0*x-\hyperlink{acosh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}/(x+\hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(t-\hyperlink{acosh_8c_ada85e349d35971b32c8ea4238881ff8b}{one})));
94     \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* 1<x<2 */}
95         t = x-\hyperlink{acosh_8c_ada85e349d35971b32c8ea4238881ff8b}{one};
96         \textcolor{keywordflow}{return} \hyperlink{math_8h_ac2aac20ab1347498e6e4f209148fea84}{log1p}(t+\hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(2.0*t+t*t));
97     \}
98 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=199pt]{math_8h_ac862445bcb46911b1782c284829d5e46_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=300pt]{math_8h_ac862445bcb46911b1782c284829d5e46_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!asin@{asin}}
\index{asin@{asin}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{asin(double x)}{asin(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double asin (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_aa9528d92a3ae44ad6484da0774604454}{}\label{math_8h_aa9528d92a3ae44ad6484da0774604454}


Inverse trigonometric sine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 Since  asin(x) = x + x^3/6 + x^5*3/40 + x^7*15/336 + ...
 we approximate asin(x) on [0,0.5] by
    asin(x) = x + x*x^2*R(x^2)
 where
    R(x^2) is a rational approximation of (asin(x)-x)/x^3
 and its remez error is bounded by
    |(asin(x)-x)/x^3 - R(x^2)| < 2^(-58.75)\end{DoxyPre}



\begin{DoxyPre} For x in [0.5,1]
    asin(x) = pi/2-2*asin(sqrt((1-x)/2))
 Let y = (1-x), z = y/2, s := sqrt(z), and pio2\_hi+pio2\_lo=pi/2;
 then for x>0.98
    asin(x) = pi/2 - 2*(s+s*z*R(z))
        = pio2\_hi - (2*(s+s*z*R(z)) - pio2\_lo)
 For x<=0.98, let pio4\_hi = pio2\_hi/2, then
    f = hi part of s;
    c = sqrt(z) - f = (z-f*f)/(s+f)     ...f+c=sqrt(z)
 and
    asin(x) = pi/2 - 2*(s+s*z*R(z))
        = pio4\_hi+(pio4-2s)-(2s*z*R(z)-pio2\_lo)
        = pio4\_hi+(pio4-2f)-(2s*z*R(z)-(pio2\_lo+2c))\end{DoxyPre}



\begin{DoxyPre}Special cases:
 if x is NaN, return x itself;
 if |x|>1, return NaN with invalid signal.\end{DoxyPre}



\begin{DoxyPre}\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 104 of file asin.\+c.



References huge, one, pio2\+\_\+hi, pio2\+\_\+lo, pio4\+\_\+hi, p\+S0, p\+S1, p\+S2, p\+S3, p\+S4, p\+S5, q\+S1, q\+S2, q\+S3, q\+S4, and sqrt().



Referenced by Real\+Number\+::\+Arc\+Cosecant(), and Real\+Number\+::\+Arc\+Sine().


\begin{DoxyCode}
105 \{
106     \textcolor{keywordtype}{double} t,w,p,q,c,r,s;
107     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,ix;
108     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
109     ix = hx&0x7fffffff;
110     \textcolor{keywordflow}{if}(ix>= 0x3ff00000) \{       \textcolor{comment}{/* |x|>= 1 */}
111         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
112         \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
113         \textcolor{keywordflow}{if}(((ix-0x3ff00000)|lx)==0)
114             \textcolor{comment}{/* asin(1)=+-pi/2 with inexact */}
115             \textcolor{keywordflow}{return} x*\hyperlink{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi}+x*\hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};
116         \textcolor{keywordflow}{return} (x-x)/(x-x);     \textcolor{comment}{/* asin(|x|>1) is NaN */}
117     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix<0x3fe00000) \{ \textcolor{comment}{/* |x|<0.5 */}
118         \textcolor{keywordflow}{if}(ix<0x3e400000) \{     \textcolor{comment}{/* if |x| < 2**-27 */}
119             \textcolor{keywordflow}{if}(\hyperlink{asin_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>\hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \{
120                 \textcolor{keywordflow}{return} x;\textcolor{comment}{/* return x with inexact if x!=0*/}
121             \} \textcolor{keywordflow}{else} \{
122                 t = 0;
123             \}
124         \} \textcolor{keywordflow}{else} \{
125             t = x*x;
126         \}
127 
128         p = t*(\hyperlink{asin_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+t*(\hyperlink{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+t*(\hyperlink{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+t*(\hyperlink{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+t*(\hyperlink{asin_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+t*\hyperlink{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
129         q = \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+t*(\hyperlink{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+t*(\hyperlink{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+t*(\hyperlink{asin_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+t*\hyperlink{asin_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
130         w = p/q;
131         \textcolor{keywordflow}{return} x+x*w;
132     \}
133     \textcolor{comment}{/* 1> |x|>= 0.5 */}
134     w = \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
135     t = w*0.5;
136     p = t*(\hyperlink{asin_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+t*(\hyperlink{asin_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+t*(\hyperlink{asin_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+t*(\hyperlink{asin_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+t*(\hyperlink{asin_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+t*\hyperlink{asin_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
137     q = \hyperlink{asin_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+t*(\hyperlink{asin_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+t*(\hyperlink{asin_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+t*(\hyperlink{asin_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+t*\hyperlink{asin_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
138     s = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(t);
139     \textcolor{keywordflow}{if}(ix>=0x3FEF3333) \{    \textcolor{comment}{/* if |x| > 0.975 */}
140         w = p/q;
141         t = \hyperlink{asin_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi}-(2.0*(s+s*w)-\hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo});
142     \} \textcolor{keywordflow}{else} \{
143         w  = s;
144         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(w,0);
145         c  = (t-w*w)/(s+w);
146         r  = p/q;
147         p  = 2.0*s*r-(\hyperlink{asin_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo}-2.0*c);
148         q  = \hyperlink{asin_8c_a5528ffbaf3180832340ec41a3affb60b}{pio4\_hi}-2.0*w;
149         t  = \hyperlink{asin_8c_a5528ffbaf3180832340ec41a3affb60b}{pio4\_hi}-(p-q);
150     \}
151     \textcolor{keywordflow}{if}(hx>0) \textcolor{keywordflow}{return} t;
152     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} -t;
153 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=184pt]{math_8h_aa9528d92a3ae44ad6484da0774604454_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=285pt]{math_8h_aa9528d92a3ae44ad6484da0774604454_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!asinh@{asinh}}
\index{asinh@{asinh}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{asinh(double x)}{asinh(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double asinh (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a907297107e93ea9c8a0c8409a8e65079}{}\label{math_8h_a907297107e93ea9c8a0c8409a8e65079}


Inverse hyperbolic sine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 Based on
    asinh(x) = sign(x) * log [ |x| + sqrt(x*x+1) ]
 we have
 asinh(x) := x  if  1+x*x=1,
     := sign(x)*(log(x)+ln2)) for large |x|, else
     := sign(x)*log(2|x|+1/(|x|+sqrt(x*x+1))) if|x|>2, else
     := sign(x)*log1p(|x| + x^2/(1 + sqrt(1+x^2)))
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 73 of file asinh.\+c.



References huge, ln2, log1p(), one, and sqrt().



Referenced by Real\+Number\+::\+Hyp\+Arc\+Cosecant(), and Real\+Number\+::\+Hyp\+Arc\+Sine().


\begin{DoxyCode}
74 \{
75     \textcolor{keywordtype}{double} t,w;
76     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,ix;
77     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
78     ix = hx&0x7fffffff;
79     \textcolor{keywordflow}{if}(ix>=0x7ff00000) \textcolor{keywordflow}{return} x+x;  \textcolor{comment}{/* x is inf or NaN */}
80     \textcolor{keywordflow}{if}(ix< 0x3e300000) \{    \textcolor{comment}{/* |x|<2**-28 */}
81         \textcolor{keywordflow}{if}(\hyperlink{asinh_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>\hyperlink{asinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \textcolor{keywordflow}{return} x; \textcolor{comment}{/* return x inexact except 0 */}
82     \}
83     \textcolor{keywordflow}{if}(ix>0x41b00000) \{ \textcolor{comment}{/* |x| > 2**28 */}
84         w = \hyperlink{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{log}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x))+\hyperlink{asinh_8c_a703f4fc93e5a57058ce6ba2ba196918d}{ln2};
85     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix>0x40000000) \{ \textcolor{comment}{/* 2**28 > |x| > 2.0 */}
86         t = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
87         w = \hyperlink{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{log}(2.0*t+\hyperlink{asinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}/(\hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(x*x+\hyperlink{asinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one})+t));
88     \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* 2.0 > |x| > 2**-28 */}
89         t = x*x;
90         w =\hyperlink{math_8h_ac2aac20ab1347498e6e4f209148fea84}{log1p}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x)+t/(\hyperlink{asinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+\hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(\hyperlink{asinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+t)));
91     \}
92     \textcolor{keywordflow}{if}(hx>0) \textcolor{keywordflow}{return} w;
93     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} -w;
94 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{math_8h_a907297107e93ea9c8a0c8409a8e65079_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=308pt]{math_8h_a907297107e93ea9c8a0c8409a8e65079_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!atan@{atan}}
\index{atan@{atan}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{atan(double x)}{atan(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double atan (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a1e2f8f6d64eaa95131bc63fee34970ea}{}\label{math_8h_a1e2f8f6d64eaa95131bc63fee34970ea}


Inverse trigonometric tangent function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method
  1. Reduce x to positive by atan(x) = -atan(-x).
  2. According to the integer k=4t+0.25 chopped, t=x, the argument
     is further reduced to one of the following intervals and the
     arctangent of t is evaluated by the corresponding formula:\end{DoxyPre}



\begin{DoxyPre}     [0,7/16]      atan(x) = t-t^3*(a1+t^2*(a2+...(a10+t^2*a11)...)
     [7/16,11/16]  atan(x) = atan(1/2) + atan( (t-0.5)/(1+t/2) )
     [11/16.19/16] atan(x) = atan( 1 ) + atan( (t-1)/(1+t) )
     [19/16,39/16] atan(x) = atan(3/2) + atan( (t-1.5)/(1+1.5t) )
     [39/16,INF]   atan(x) = atan(INF) + atan( -1/t )\end{DoxyPre}



\begin{DoxyPre}Constants:
The hexadecimal values are the intended ones for the following
constants. The decimal values may be used, provided that the
compiler will convert from decimal to binary accurately enough
to produce the hexadecimal values shown.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 109 of file atan.\+c.



References aT, atanhi, atanlo, huge, and one.



Referenced by Real\+Number\+::\+Arc\+Cotangent(), Real\+Number\+::\+Arc\+Tangent(), and atan2().


\begin{DoxyCode}
110 \{
111     \textcolor{keywordtype}{double} w,s1,s2,z;
112     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix,hx,id;
113 
114     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
115     ix = hx&0x7fffffff;
116     \textcolor{keywordflow}{if}(ix>=0x44100000) \{    \textcolor{comment}{/* if |x| >= 2^66 */}
117         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} low;
118 
119         \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(low,x);
120         \textcolor{keywordflow}{if}(ix>0x7ff00000||
121                 (ix==0x7ff00000&&(low!=0)))
122             \textcolor{keywordflow}{return} x+x;     \textcolor{comment}{/* NaN */}
123         \textcolor{keywordflow}{if}(hx>0) \textcolor{keywordflow}{return}  \hyperlink{atan_8c_a3ad59cecebe81954b05adb6655a3522d}{atanhi}[3]+\hyperlink{atan_8c_a8e27d24e02eed00dd09eecee7230b8a7}{atanlo}[3];
124         \textcolor{keywordflow}{else}     \textcolor{keywordflow}{return} -\hyperlink{atan_8c_a3ad59cecebe81954b05adb6655a3522d}{atanhi}[3]-atanlo[3];
125     \}
126     \textcolor{keywordflow}{if} (ix < 0x3fdc0000) \{  \textcolor{comment}{/* |x| < 0.4375 */}
127         \textcolor{keywordflow}{if} (ix < 0x3e200000) \{  \textcolor{comment}{/* |x| < 2^-29 */}
128             \textcolor{keywordflow}{if}(\hyperlink{atan_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>\hyperlink{atan_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \textcolor{keywordflow}{return} x; \textcolor{comment}{/* raise inexact */}
129         \}
130         \textcolor{keywordtype}{id} = -1;
131     \} \textcolor{keywordflow}{else} \{
132         x = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
133         \textcolor{keywordflow}{if} (ix < 0x3ff30000) \{      \textcolor{comment}{/* |x| < 1.1875 */}
134             \textcolor{keywordflow}{if} (ix < 0x3fe60000) \{  \textcolor{comment}{/* 7/16 <=|x|<11/16 */}
135                 \textcolor{keywordtype}{id} = 0;
136                 x = (2.0*x-\hyperlink{atan_8c_ada85e349d35971b32c8ea4238881ff8b}{one})/(2.0+x);
137             \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* 11/16<=|x|< 19/16 */}
138                 \textcolor{keywordtype}{id} = 1;
139                 x  = (x-\hyperlink{atan_8c_ada85e349d35971b32c8ea4238881ff8b}{one})/(x+\hyperlink{atan_8c_ada85e349d35971b32c8ea4238881ff8b}{one});
140             \}
141         \} \textcolor{keywordflow}{else} \{
142             \textcolor{keywordflow}{if} (ix < 0x40038000) \{  \textcolor{comment}{/* |x| < 2.4375 */}
143                 \textcolor{keywordtype}{id} = 2;
144                 x  = (x-1.5)/(\hyperlink{atan_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+1.5*x);
145             \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* 2.4375 <= |x| < 2^66 */}
146                 \textcolor{keywordtype}{id} = 3;
147                 x  = -1.0/x;
148             \}
149         \}
150     \}
151     \textcolor{comment}{/* end of argument reduction */}
152     z = x*x;
153     w = z*z;
154     \textcolor{comment}{/* break sum from i=0 to 10 aT[i]z**(i+1) into odd and even poly */}
155     s1 = z*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[0]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[2]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[4]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[6]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[8]+w*\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[10])))));
156     s2 = w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[1]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[3]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[5]+w*(\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[7]+w*\hyperlink{atan_8c_a728d3c586fb7556699ef98d4e277da73}{aT}[9]))));
157     \textcolor{keywordflow}{if} (\textcolor{keywordtype}{id}<0) \textcolor{keywordflow}{return} x - x*(s1+s2);
158     \textcolor{keywordflow}{else} \{
159         z = \hyperlink{atan_8c_a3ad59cecebe81954b05adb6655a3522d}{atanhi}[id] - ((x*(s1+s2) - \hyperlink{atan_8c_a8e27d24e02eed00dd09eecee7230b8a7}{atanlo}[\textcolor{keywordtype}{id}]) - x);
160         \textcolor{keywordflow}{return} (hx<0)? -z:z;
161     \}
162 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a1e2f8f6d64eaa95131bc63fee34970ea_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!atan2@{atan2}}
\index{atan2@{atan2}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{atan2(double y, double x)}{atan2(double y, double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double atan2 (
\begin{DoxyParamCaption}
\item[{double}]{y, }
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a349377202ca14f79eb335b1a421fe4d8}{}\label{math_8h_a349377202ca14f79eb335b1a421fe4d8}


Definition at line 86 of file atan2.\+c.



References atan(), pi, pi\+\_\+lo, pi\+\_\+o\+\_\+2, pi\+\_\+o\+\_\+4, tiny, and zero.



Referenced by clog(), and cpow().


\begin{DoxyCode}
87 \{
88     \textcolor{keywordtype}{double} z;
89     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} k,m,hx,hy,ix,iy;
90     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx,ly;
91 
92     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
93     ix = hx&0x7fffffff;
94     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hy,ly,y);
95     iy = hy&0x7fffffff;
96     \textcolor{keywordflow}{if}(((ix|((lx|-lx)>>31))>0x7ff00000)||
97             ((iy|((ly|-ly)>>31))>0x7ff00000))   \textcolor{comment}{/* x or y is NaN */}
98         \textcolor{keywordflow}{return} x+y;
99     \textcolor{keywordflow}{if}(((hx-0x3ff00000)|lx)==0) \textcolor{keywordflow}{return} \hyperlink{math_8h_a1e2f8f6d64eaa95131bc63fee34970ea}{atan}(y);   \textcolor{comment}{/* x=1.0 */}
100     m = ((hy>>31)&1)|((hx>>30)&2);  \textcolor{comment}{/* 2*sign(x)+sign(y) */}
101 
102     \textcolor{comment}{/* when y = 0 */}
103     \textcolor{keywordflow}{if}((iy|ly)==0) \{
104         \textcolor{keywordflow}{switch}(m) \{
105         \textcolor{keywordflow}{case} 0:
106         \textcolor{keywordflow}{case} 1:
107             \textcolor{keywordflow}{return} y;   \textcolor{comment}{/* atan(+-0,+anything)=+-0 */}
108         \textcolor{keywordflow}{case} 2:
109             \textcolor{keywordflow}{return}  \hyperlink{atan2_8c_a43016d873124d39034edb8cd164794db}{pi}+\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};\textcolor{comment}{/* atan(+0,-anything) = pi */}
110         \textcolor{keywordflow}{case} 3:
111             \textcolor{keywordflow}{return} -\hyperlink{atan2_8c_a43016d873124d39034edb8cd164794db}{pi}-\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};\textcolor{comment}{/* atan(-0,-anything) =-pi */}
112         \}
113     \}
114     \textcolor{comment}{/* when x = 0 */}
115     \textcolor{keywordflow}{if}((ix|lx)==0) \textcolor{keywordflow}{return} (hy<0)?  -\hyperlink{atan2_8c_a5e2886167c3870717e15666048afd36a}{pi\_o\_2}-\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}: \hyperlink{atan2_8c_a5e2886167c3870717e15666048afd36a}{pi\_o\_2}+\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
116 
117     \textcolor{comment}{/* when x is INF */}
118     \textcolor{keywordflow}{if}(ix==0x7ff00000) \{
119         \textcolor{keywordflow}{if}(iy==0x7ff00000) \{
120             \textcolor{keywordflow}{switch}(m) \{
121             \textcolor{keywordflow}{case} 0:
122                 \textcolor{keywordflow}{return}  \hyperlink{atan2_8c_a1417df9542e56520aafedb53e1112a59}{pi\_o\_4}+\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};\textcolor{comment}{/* atan(+INF,+INF) */}
123             \textcolor{keywordflow}{case} 1:
124                 \textcolor{keywordflow}{return} -\hyperlink{atan2_8c_a1417df9542e56520aafedb53e1112a59}{pi\_o\_4}-\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};\textcolor{comment}{/* atan(-INF,+INF) */}
125             \textcolor{keywordflow}{case} 2:
126                 \textcolor{keywordflow}{return}  3.0*\hyperlink{atan2_8c_a1417df9542e56520aafedb53e1112a59}{pi\_o\_4}+\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};\textcolor{comment}{/*atan(+INF,-INF)*/}
127             \textcolor{keywordflow}{case} 3:
128                 \textcolor{keywordflow}{return} -3.0*\hyperlink{atan2_8c_a1417df9542e56520aafedb53e1112a59}{pi\_o\_4}-\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};\textcolor{comment}{/*atan(-INF,-INF)*/}
129             \}
130         \} \textcolor{keywordflow}{else} \{
131             \textcolor{keywordflow}{switch}(m) \{
132             \textcolor{keywordflow}{case} 0:
133                 \textcolor{keywordflow}{return}  \hyperlink{atan2_8c_a554f7b66b1ba49443447eb746978c268}{zero}  ; \textcolor{comment}{/* atan(+...,+INF) */}
134             \textcolor{keywordflow}{case} 1:
135                 \textcolor{keywordflow}{return} -\hyperlink{atan2_8c_a554f7b66b1ba49443447eb746978c268}{zero}  ; \textcolor{comment}{/* atan(-...,+INF) */}
136             \textcolor{keywordflow}{case} 2:
137                 \textcolor{keywordflow}{return}  \hyperlink{atan2_8c_a43016d873124d39034edb8cd164794db}{pi}+\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}  ;    \textcolor{comment}{/* atan(+...,-INF) */}
138             \textcolor{keywordflow}{case} 3:
139                 \textcolor{keywordflow}{return} -\hyperlink{atan2_8c_a43016d873124d39034edb8cd164794db}{pi}-\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}  ;    \textcolor{comment}{/* atan(-...,-INF) */}
140             \}
141         \}
142     \}
143     \textcolor{comment}{/* when y is INF */}
144     \textcolor{keywordflow}{if}(iy==0x7ff00000) \textcolor{keywordflow}{return} (hy<0)? -\hyperlink{atan2_8c_a5e2886167c3870717e15666048afd36a}{pi\_o\_2}-tiny: \hyperlink{atan2_8c_a5e2886167c3870717e15666048afd36a}{pi\_o\_2}+\hyperlink{atan2_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
145 
146     \textcolor{comment}{/* compute y/x */}
147     k = (iy-ix)>>20;
148     \textcolor{keywordflow}{if}(k > 60) z=\hyperlink{atan2_8c_a5e2886167c3870717e15666048afd36a}{pi\_o\_2}+0.5*\hyperlink{atan2_8c_ac8cbe1b78ca704e98ce9f3905455f870}{pi\_lo};   \textcolor{comment}{/* |y/x| >  2**60 */}
149     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(hx<0&&k<-60) z=0.0;     \textcolor{comment}{/* |y|/x < -2**60 */}
150     \textcolor{keywordflow}{else} z=\hyperlink{math_8h_a1e2f8f6d64eaa95131bc63fee34970ea}{atan}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(y/x));     \textcolor{comment}{/* safe to do y/x */}
151     \textcolor{keywordflow}{switch} (m) \{
152     \textcolor{keywordflow}{case} 0:
153         \textcolor{keywordflow}{return}       z  ;   \textcolor{comment}{/* atan(+,+) */}
154     \textcolor{keywordflow}{case} 1: \{
155         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} zh;
156         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(zh,z);
157         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(z, zh ^ 0x80000000);
158     \}
159     \textcolor{keywordflow}{return}       z  ;   \textcolor{comment}{/* atan(-,+) */}
160     \textcolor{keywordflow}{case} 2:
161         \textcolor{keywordflow}{return}  \hyperlink{atan2_8c_a43016d873124d39034edb8cd164794db}{pi}-(z-\hyperlink{atan2_8c_ac8cbe1b78ca704e98ce9f3905455f870}{pi\_lo});\textcolor{comment}{/* atan(+,-) */}
162     \textcolor{keywordflow}{default}: \textcolor{comment}{/* case 3 */}
163         \textcolor{keywordflow}{return}  (z-\hyperlink{atan2_8c_ac8cbe1b78ca704e98ce9f3905455f870}{pi\_lo})-\hyperlink{atan2_8c_a43016d873124d39034edb8cd164794db}{pi};\textcolor{comment}{/* atan(-,-) */}
164     \}
165 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=192pt]{math_8h_a349377202ca14f79eb335b1a421fe4d8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a349377202ca14f79eb335b1a421fe4d8_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!atanh@{atanh}}
\index{atanh@{atanh}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{atanh(double x)}{atanh(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double atanh (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ac07fd7b77fa341563abccf9efcc1a711}{}\label{math_8h_ac07fd7b77fa341563abccf9efcc1a711}


Inverse hyperbolic tangent function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
   1.Reduced x to positive by atanh(-x) = -atanh(x)
   2.For x>=0.5
                 1              2x                          x
 atanh(x) = --- * log(1 + -------) = 0.5 * log1p(2 * --------)
                 2             1 - x                      1 - x\end{DoxyPre}



\begin{DoxyPre}    For x<0.5
 atanh(x) = 0.5*log1p(2x+2x*x/(1-x))\end{DoxyPre}



\begin{DoxyPre}Special cases:
 atanh(x) is NaN if |x| > 1 with signal;
 atanh(NaN) is that NaN with no signal;
 atanh(+-1) is +-INF with signal.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 81 of file atanh.\+c.



References huge, log1p(), one, and zero.



Referenced by Real\+Number\+::\+Hyp\+Arc\+Cotangent(), and Real\+Number\+::\+Hyp\+Arc\+Tangent().


\begin{DoxyCode}
82 \{
83     \textcolor{keywordtype}{double} t;
84     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,ix;
85     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
86     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
87     \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
88     ix = hx&0x7fffffff;
89     \textcolor{keywordflow}{if} ((ix|((lx|(-lx))>>31))>0x3ff00000) \textcolor{comment}{/* |x|>1 */}
90         \textcolor{keywordflow}{return} (x-x)/(x-x);
91     \textcolor{keywordflow}{if}(ix==0x3ff00000)
92         \textcolor{keywordflow}{return} x/\hyperlink{atanh_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};
93     \textcolor{keywordflow}{if}(ix<0x3e300000&&(\hyperlink{atanh_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x)>\hyperlink{atanh_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero}) \textcolor{keywordflow}{return} x;  \textcolor{comment}{/* x<2**-28 */}
94     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x, ix);      \textcolor{comment}{/* x <- |x| */}
95     \textcolor{keywordflow}{if}(ix<0x3fe00000) \{     \textcolor{comment}{/* x < 0.5 */}
96         t = x+x;
97         t = 0.5*\hyperlink{math_8h_ac2aac20ab1347498e6e4f209148fea84}{log1p}(t+t*x/(\hyperlink{atanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-x));
98     \} \textcolor{keywordflow}{else}
99         t = 0.5*\hyperlink{math_8h_ac2aac20ab1347498e6e4f209148fea84}{log1p}((x+x)/(\hyperlink{atanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-x));
100     \textcolor{keywordflow}{if}(hx>=0) \textcolor{keywordflow}{return} t;
101     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} -t;
102 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{math_8h_ac07fd7b77fa341563abccf9efcc1a711_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{math_8h_ac07fd7b77fa341563abccf9efcc1a711_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!cbrt@{cbrt}}
\index{cbrt@{cbrt}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{cbrt(double x)}{cbrt(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double cbrt (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a8af00e2203928978e0242b4afd1d899f}{}\label{math_8h_a8af00e2203928978e0242b4afd1d899f}


Cube root function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18 
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 67 of file cbrt.\+c.



References B1, B2, C, D, E, F, and G.


\begin{DoxyCode}
68 \{
69     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}  hx, lx, ht;
70     \textcolor{keywordtype}{double} r,s,t=0.0,w;
71     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} sign;
72 
73     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x); \textcolor{comment}{/* high word of x */}
74     sign=hx&0x80000000;         \textcolor{comment}{/* sign= sign(x) */}
75     hx  ^=sign;
76     \textcolor{keywordflow}{if}(hx>=0x7ff00000) \textcolor{keywordflow}{return}(x+x); \textcolor{comment}{/* cbrt(NaN,INF) is itself */}
77     \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx, x);
78     \textcolor{keywordflow}{if}((hx|lx)==0)
79         \textcolor{keywordflow}{return}(x);      \textcolor{comment}{/* cbrt(0) is itself */}
80 
81     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x,hx); \textcolor{comment}{/* x <- |x| */}
82     \textcolor{comment}{/* rough cbrt to 5 bits */}
83     \textcolor{keywordflow}{if}(hx<0x00100000)       \textcolor{comment}{/* subnormal number */}
84     \{
85         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,0x43500000);       \textcolor{comment}{/* set t= 2**54 */}
86         t*=x;
87         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht,t);
88         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,ht/3+\hyperlink{cbrt_8c_a63d271d6b952319d904e32c7319dbacd}{B2});
89     \}
90     \textcolor{keywordflow}{else}
91         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,hx/3+\hyperlink{cbrt_8c_a0340375b1c4fd28d44d3d8f2c21ef4c2}{B1});
92 
93     \textcolor{comment}{/* new cbrt to 23 bits, may be implemented in single precision */}
94     r=t*t/x;
95     s=\hyperlink{cbrt_8c_a9e8a46a0e00368ad98642587ca4ebdbe}{C}+r*t;
96     t*=\hyperlink{cbrt_8c_ab97e4616d23ed4c2961295010c1afc3c}{G}+\hyperlink{cbrt_8c_a480d6423b1e9ca40c69c5a83458b49b0}{F}/(s+\hyperlink{cbrt_8c_ab587ba72a9c23f238cb4fd70e2fdb545}{E}+\hyperlink{cbrt_8c_a412464ee5e4d4e873c365d926d1970bb}{D}/s);
97 
98     \textcolor{comment}{/* chopped to 20 bits and make it larger than cbrt(x) */}
99     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
100     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht,t);
101     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,ht + 0x00000001);
102 
103     \textcolor{comment}{/* one step newton iteration to 53 bits with error less than 0.667 ulps */}
104     s=t*t;      \textcolor{comment}{/* t*t is exact */}
105     r=x/s;
106     w=t+t;
107     r=(r-t)/(w+r);  \textcolor{comment}{/* r-s is exact */}
108     t=t+t*r;
109 
110     \textcolor{comment}{/* retore the sign bit */}
111     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht,t);
112     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,ht|sign);
113 
114     \textcolor{keywordflow}{return}(t);
115 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!ceil@{ceil}}
\index{ceil@{ceil}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{ceil(double x)}{ceil(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double ceil (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a1ea6d7b591132268abc2e843ababd084}{}\label{math_8h_a1ea6d7b591132268abc2e843ababd084}


Mathematical ceiling function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return x rounded toward -inf to integral value
Method:
 Bit twiddling.
Exception:
 Inexact flag raised if x not equal to ceil(x).
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 65 of file ceil.\+c.



References huge.


\begin{DoxyCode}
66 \{
67     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} i0,i1,j0;
68     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} i,j;
69     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(i0,i1,x);
70     j0 = ((i0>>20)&0x7ff)-0x3ff;
71     \textcolor{keywordflow}{if}(j0<20) \{
72         \textcolor{keywordflow}{if}(j0<0) \{          \textcolor{comment}{/* raise inexact if x != 0 */}
73             \textcolor{keywordflow}{if}(\hyperlink{ceil_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>0.0) \{        \textcolor{comment}{/* return 0*sign(x) if |x|<1 */}
74                 \textcolor{keywordflow}{if}(i0<0) \{
75                     i0=0x80000000;
76                     i1=0;
77                 \}
78                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((i0|i1)!=0) \{
79                     i0=0x3ff00000;
80                     i1=0;
81                 \}
82             \}
83         \} \textcolor{keywordflow}{else} \{
84             i = (0x000fffff)>>j0;
85             \textcolor{keywordflow}{if}(((i0&i)|i1)==0) \textcolor{keywordflow}{return} x; \textcolor{comment}{/* x is integral */}
86             \textcolor{keywordflow}{if}(\hyperlink{ceil_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>0.0) \{        \textcolor{comment}{/* raise inexact flag */}
87                 \textcolor{keywordflow}{if}(i0>0) i0 += (0x00100000)>>j0;
88                 i0 &= (~i);
89                 i1=0;
90             \}
91         \}
92     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j0>51) \{
93         \textcolor{keywordflow}{if}(j0==0x400) \textcolor{keywordflow}{return} x+x;   \textcolor{comment}{/* inf or NaN */}
94         \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} x;          \textcolor{comment}{/* x is integral */}
95     \} \textcolor{keywordflow}{else} \{
96         i = ((\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})(0xffffffff))>>(j0-20);
97         \textcolor{keywordflow}{if}((i1&i)==0) \textcolor{keywordflow}{return} x;     \textcolor{comment}{/* x is integral */}
98         \textcolor{keywordflow}{if}(\hyperlink{ceil_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>0.0) \{        \textcolor{comment}{/* raise inexact flag */}
99             \textcolor{keywordflow}{if}(i0>0) \{
100                 \textcolor{keywordflow}{if}(j0==20) i0+=1;
101                 \textcolor{keywordflow}{else} \{
102                     j = i1 + (1<<(52-j0));
103                     \textcolor{comment}{// NOTICE: Is this a correct cast?}
104                     \textcolor{keywordflow}{if}((\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})j<(\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})i1) i0+=1; \textcolor{comment}{/* got a carry */}
105                     i1 = j;
106                 \}
107             \}
108             i1 &= (~i);
109         \}
110     \}
111     \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(x,i0,i1);
112     \textcolor{keywordflow}{return} x;
113 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!copysign@{copysign}}
\index{copysign@{copysign}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{copysign(double x, double y)}{copysign(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double copysign (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ad8d1296592a3e783acdd0de21ff58e2e}{}\label{math_8h_ad8d1296592a3e783acdd0de21ff58e2e}


Returns a value with the magnitude of x and with the sign bit of y. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18 
\end{DoxyDate}


Definition at line 52 of file copysign.\+c.


\begin{DoxyCode}
53 \{
54     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hx, hy;
55     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx, x);
56     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
57     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x, (hx&0x7fffffff)|(hy&0x80000000));
58     \textcolor{keywordflow}{return} x;
59 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!cos@{cos}}
\index{cos@{cos}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{cos(double x)}{cos(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double cos (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a5e7b53a694b3cf0f2d7debd444140fbd}{}\label{math_8h_a5e7b53a694b3cf0f2d7debd444140fbd}


Trigonometric cosine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return cosine function of x.\end{DoxyPre}



\begin{DoxyPre}kernel function:
 \_\_kernel\_sin       ... sine function on [-pi/4,pi/4]
 \_\_kernel\_cos       ... cosine function on [-pi/4,pi/4]
 rem\_pio2       ... argument reduction routine\end{DoxyPre}



\begin{DoxyPre}Method.
     Let S,C and T denote the sin, cos and tan respectively on
 [-PI/4, +PI/4]. Reduce the argument x to y1+y2 = x-k*pi/2
 in [-pi/4 , +pi/4], and let n = k mod 4.
 We have\end{DoxyPre}



\begin{DoxyPre}         n        sin(x)      cos(x)        tan(x)
    ----------------------------------------------------------
     0         S       C         T
     1         C      -S        -1/T
     2        -S      -C         T
     3        -C       S        -1/T
    ----------------------------------------------------------\end{DoxyPre}



\begin{DoxyPre}Special cases:
     Let trig be any of sin, cos, or tan.
     trig(+-INF)  is NaN, with signals;
     trig(NaN)    is that NaN;\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 TRIG(x) returns trig(x) nearly rounded
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 87 of file cos.\+c.



References \+\_\+\+\_\+kernel\+\_\+cos(), \+\_\+\+\_\+kernel\+\_\+sin(), and rempio2().



Referenced by cchc(), ccos(), ccosh(), ccot(), ccoth(), ccsc(), ccsch(), cexp(), Real\+Number\+::\+Cosine(), cpow(), csec(), csech(), csin(), csinh(), ctan(), ctanh(), and Real\+Number\+::\+Secant().


\begin{DoxyCode}
88 \{
89     \textcolor{keywordtype}{double} y[2],z=0.0;
90     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} n, ix;
91 
92     \textcolor{comment}{/* High word of x. */}
93     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix,x);
94 
95     \textcolor{comment}{/* |x| ~< pi/4 */}
96     ix &= 0x7fffffff;
97     \textcolor{keywordflow}{if}(ix <= 0x3fe921fb) \textcolor{keywordflow}{return} \hyperlink{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\_\_kernel\_cos}(x,z);
98 
99     \textcolor{comment}{/* cos(Inf or NaN) is NaN */}
100     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix>=0x7ff00000) \textcolor{keywordflow}{return} x-x;
101 
102     \textcolor{comment}{/* argument reduction needed */}
103     \textcolor{keywordflow}{else} \{
104         n = \hyperlink{math_8h_a320ce87737d621d713124124e2c02cdc}{rempio2}(x,y);
105         \textcolor{keywordflow}{switch}(n&3) \{
106         \textcolor{keywordflow}{case} 0:
107             \textcolor{keywordflow}{return}  \hyperlink{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\_\_kernel\_cos}(y[0],y[1]);
108         \textcolor{keywordflow}{case} 1:
109             \textcolor{keywordflow}{return} -\hyperlink{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{\_\_kernel\_sin}(y[0],y[1],1);
110         \textcolor{keywordflow}{case} 2:
111             \textcolor{keywordflow}{return} -\hyperlink{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\_\_kernel\_cos}(y[0],y[1]);
112         \textcolor{keywordflow}{default}:
113             \textcolor{keywordflow}{return}  \hyperlink{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{\_\_kernel\_sin}(y[0],y[1],1);
114         \}
115     \}
116 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a5e7b53a694b3cf0f2d7debd444140fbd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a5e7b53a694b3cf0f2d7debd444140fbd_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!cosh@{cosh}}
\index{cosh@{cosh}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{cosh(double x)}{cosh(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double cosh (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a3795d3c1f1d30819be56da4e4d67f64b}{}\label{math_8h_a3795d3c1f1d30819be56da4e4d67f64b}


Hyperbolic cosine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
mathematically cosh(x) if defined to be (exp(x)+exp(-x))/2
 1. Replace x by |x| (cosh(x) = cosh(-x)).
 2.
                                            [ exp(x) - 1 ]^2
     0        <= x <= ln2/2  :  cosh(x) := 1 + -------------------
                                   2*exp(x)\end{DoxyPre}



\begin{DoxyPre}                                      exp(x) +  1/exp(x)
     ln2/2    <= x <= 22     :  cosh(x) := -------------------
                                  2
     22       <= x <= lnovft :  cosh(x) := exp(x)/2
     lnovft   <= x <= ln2ovft:  cosh(x) := exp(x/2)/2 * exp(x/2)
     ln2ovft  <  x      :  cosh(x) := huge*huge (overflow)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 cosh(x) is |x| if x is +INF, -INF, or NaN.
 only cosh(0)=1 is exact for finite x.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 84 of file cosh.\+c.



References exp(), expm1(), half, huge, and one.



Referenced by cchc(), cchsh(), ccot(), ccoth(), ccsc(), ccsch(), csec(), csech(), ctan(), ctanh(), Real\+Number\+::\+Hyp\+Cosine(), and Real\+Number\+::\+Hyp\+Secant().


\begin{DoxyCode}
85 \{
86     \textcolor{keywordtype}{double} t,w;
87     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix;
88     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
89 
90     \textcolor{comment}{/* High word of |x|. */}
91     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix,x);
92     ix &= 0x7fffffff;
93 
94     \textcolor{comment}{/* x is INF or NaN */}
95     \textcolor{keywordflow}{if}(ix>=0x7ff00000) \textcolor{keywordflow}{return} x*x;
96 
97     \textcolor{comment}{/* |x| in [0,0.5*ln2], return 1+expm1(|x|)^2/(2*exp(|x|)) */}
98     \textcolor{keywordflow}{if}(ix<0x3fd62e43) \{
99         t = \hyperlink{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}{expm1}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
100         w = \hyperlink{cosh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+t;
101         \textcolor{keywordflow}{if} (ix<0x3c800000) \textcolor{keywordflow}{return} w;    \textcolor{comment}{/* cosh(tiny) = 1 */}
102         \textcolor{keywordflow}{return} \hyperlink{cosh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+(t*t)/(w+w);
103     \}
104 
105     \textcolor{comment}{/* |x| in [0.5*ln2,22], return (exp(|x|)+1/exp(|x|)/2; */}
106     \textcolor{keywordflow}{if} (ix < 0x40360000) \{
107         t = \hyperlink{math_8h_ae09128febbbe6372cde4fa0c65608a42}{exp}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
108         \textcolor{keywordflow}{return} \hyperlink{cosh_8c_a701d1f7de8380226dbc8825672ae4ef0}{half}*t+\hyperlink{cosh_8c_a701d1f7de8380226dbc8825672ae4ef0}{half}/t;
109     \}
110 
111     \textcolor{comment}{/* |x| in [22, log(maxdouble)] return half*exp(|x|) */}
112     \textcolor{keywordflow}{if} (ix < 0x40862E42)  \textcolor{keywordflow}{return} \hyperlink{cosh_8c_a701d1f7de8380226dbc8825672ae4ef0}{half}*\hyperlink{math_8h_ae09128febbbe6372cde4fa0c65608a42}{exp}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
113 
114     \textcolor{comment}{/* |x| in [log(maxdouble), overflowthresold] */}
115     lx = *( (((*(\textcolor{keywordtype}{unsigned}*)&\hyperlink{cosh_8c_ada85e349d35971b32c8ea4238881ff8b}{one})>>29)) + (\textcolor{keywordtype}{unsigned}*)&x);
116     \textcolor{keywordflow}{if} (ix<0x408633CE ||
117             ((ix==0x408633ce)&&(lx<=(unsigned)0x8fb9f87d))) \{
118         w = \hyperlink{math_8h_ae09128febbbe6372cde4fa0c65608a42}{exp}(\hyperlink{cosh_8c_a701d1f7de8380226dbc8825672ae4ef0}{half}*\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
119         t = \hyperlink{cosh_8c_a701d1f7de8380226dbc8825672ae4ef0}{half}*w;
120         \textcolor{keywordflow}{return} t*w;
121     \}
122 
123     \textcolor{comment}{/* |x| > overflowthresold, cosh(x) overflow */}
124     \textcolor{keywordflow}{return} \hyperlink{cosh_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{cosh_8c_acbd466133274923cc0785707fbdeea9a}{huge};
125 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=200pt]{math_8h_a3795d3c1f1d30819be56da4e4d67f64b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a3795d3c1f1d30819be56da4e4d67f64b_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!exp@{exp}}
\index{exp@{exp}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{exp(double x)}{exp(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double exp (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ae09128febbbe6372cde4fa0c65608a42}{}\label{math_8h_ae09128febbbe6372cde4fa0c65608a42}


Returns the exponential of x. 

\begin{DoxyVersion}{Version}
1.\+6 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
04/04/22
\end{DoxyDate}

\begin{DoxyPre}
Method
  1. Argument reduction:
     Reduce x to an r so that |r| <= 0.5*ln2 ~ 0.34658.
 Given x, find r and integer k such that\end{DoxyPre}



\begin{DoxyPre}              x = k*ln2 + r,  |r| <= 0.5*ln2.\end{DoxyPre}



\begin{DoxyPre}     Here r will be represented as r = hi-lo for better
 accuracy.\end{DoxyPre}



\begin{DoxyPre}  2. Approximation of exp(r) by a special rational function on
 the interval [0,0.34658]:
 Write
     R(r**2) = r*(exp(r)+1)/(exp(r)-1) = 2 + r*r/6 - r**4/360 + ...
     We use a special Remes algorithm on [0,0.34658] to generate
    a polynomial of degree 5 to approximate R. The maximum error
 of this polynomial approximation is bounded by 2**-59. In
 other words,
     R(z) ~ 2.0 + P1*z + P2*z**2 + P3*z**3 + P4*z**4 + P5*z**5
    (where z=r*r, and the values of P1 to P5 are listed below)
 and
     |                  5          |     -59
     | 2.0+P1*z+...+P5*z   -  R(z) | <= 2
     |                             |
 The computation of exp(r) thus becomes
                            2*r
    exp(r) = 1 + -------
                  R - r
                                r*R1(r)
           = 1 + r + ----------- (for better accuracy)
                      2 - R1(r)
 where
                 2       4             10
    R1(r) = r - (P1*r  + P2*r  + ... + P5*r   ).\end{DoxyPre}



\begin{DoxyPre}  3. Scale back to obtain exp(x):
 From step 1, we have
    exp(x) = 2^k * exp(r)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 exp(INF) is INF, exp(NaN) is NaN;
 exp(-INF) is 0, and
 for finite argument, only exp(0)=1 is exact.\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 according to an error analysis, the error is always less than
 1 ulp (unit in the last place).\end{DoxyPre}



\begin{DoxyPre}Misc. info.
 For IEEE double
     if x >  7.09782712893383973096e+02 then exp(x) overflow
     if x < -7.45133219101941108420e+02 then exp(x) underflow\end{DoxyPre}



\begin{DoxyPre}Constants:
The hexadecimal values are the intended ones for the following
constants. The decimal values may be used, provided that the
compiler will convert from decimal to binary accurately enough
to produce the hexadecimal values shown.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 134 of file exp.\+c.



References halF, huge, invln2, ln2\+HI, ln2\+LO, o\+\_\+threshold, one, P1, P2, P3, P4, P5, twom1000, and u\+\_\+threshold.



Referenced by cchsh(), cexp(), cosh(), cpow(), and sinh().


\begin{DoxyCode}
135 \{
136     \textcolor{keywordtype}{double} y,hi,lo,c,t;
137     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} k,xsb;
138     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hx;
139 
140     lo = 0.0;
141     hi = 0.0;
142 
143     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);   \textcolor{comment}{/* high word of x */}
144     xsb = (hx>>31)&1;       \textcolor{comment}{/* sign bit of x */}
145     hx &= 0x7fffffff;       \textcolor{comment}{/* high word of |x| */}
146 
147     \textcolor{comment}{/* filter out non-finite argument */}
148     \textcolor{keywordflow}{if}(hx >= 0x40862E42) \{          \textcolor{comment}{/* if |x|>=709.78... */}
149         \textcolor{keywordflow}{if}(hx>=0x7ff00000) \{
150             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
151             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
152             \textcolor{keywordflow}{if}(((hx&0xfffff)|lx)!=0)
153                 \textcolor{keywordflow}{return} x+x;             \textcolor{comment}{/* NaN */}
154             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} (xsb==0)? x:0.0;    \textcolor{comment}{/* exp(+-inf)=\{inf,0\} */}
155         \}
156         \textcolor{keywordflow}{if}(x > \hyperlink{exp_8c_acbb7fb31d7634234372850576e110c91}{o\_threshold}) \textcolor{keywordflow}{return} \hyperlink{exp_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{exp_8c_acbd466133274923cc0785707fbdeea9a}{huge}; \textcolor{comment}{/* overflow */}
157         \textcolor{keywordflow}{if}(x < \hyperlink{exp_8c_aa36ad5f2244c82ebc142bbdbbc7af9bb}{u\_threshold}) \textcolor{keywordflow}{return} \hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000}*\hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000}; \textcolor{comment}{/* underflow */}
158     \}
159 
160     \textcolor{comment}{/* argument reduction */}
161     \textcolor{keywordflow}{if}(hx > 0x3fd62e42) \{       \textcolor{comment}{/* if  |x| > 0.5 ln2 */}
162         \textcolor{keywordflow}{if}(hx < 0x3FF0A2B2) \{       \textcolor{comment}{/* and |x| < 1.5 ln2 */}
163             hi = x-\hyperlink{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}{ln2HI}[xsb];
164             lo=\hyperlink{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}{ln2LO}[xsb];
165             k = 1-xsb-xsb;
166         \} \textcolor{keywordflow}{else} \{
167             k  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(\hyperlink{exp_8c_a4cf65ab9c76c64c084e1abd8fe5da216}{invln2}*x+\hyperlink{exp_8c_a3569bfad37f52891aa371c2f31e70dac}{halF}[xsb]);
168             t  = k;
169             hi = x - t*\hyperlink{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}{ln2HI}[0];   \textcolor{comment}{/* t*ln2HI is exact here */}
170             lo = t*\hyperlink{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}{ln2LO}[0];
171         \}
172         x  = hi - lo;
173     \}
174     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(hx < 0x3e300000)  \{     \textcolor{comment}{/* when |x|<2**-28 */}
175         \textcolor{keywordflow}{if}(huge+x>\hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \{
176             \textcolor{keywordflow}{return} \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+x;    \textcolor{comment}{/* trigger inexact */}
177         \} \textcolor{keywordflow}{else} \{
178             k = 0;
179         \}
180     \}
181     \textcolor{keywordflow}{else} k = 0;
182 
183     \textcolor{comment}{/* x is now in primary range */}
184     t  = x*x;
185     c  = x - t*(\hyperlink{exp_8c_a5c2e2e6dd711ceae83536551926d6dd3}{P1}+t*(\hyperlink{exp_8c_acddba71b086f9e3c2b621baef51e45ac}{P2}+t*(\hyperlink{exp_8c_ab48f05f97efef9ea9f554c91a980520a}{P3}+t*(\hyperlink{exp_8c_af783f4afa9878be962b9904dc22e8bab}{P4}+t*\hyperlink{exp_8c_afdc64323c3afde906f161bdf28e5e319}{P5}))));
186     \textcolor{keywordflow}{if}(k==0)    \textcolor{keywordflow}{return} \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-((x*c)/(c-2.0)-x);
187     \textcolor{keywordflow}{else}        y = \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-((lo-(x*c)/(2.0-c))-hi);
188     \textcolor{keywordflow}{if}(k >= -1021) \{
189         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
190         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
191         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + (k<<20));    \textcolor{comment}{/* add k to y's exponent */}
192         \textcolor{keywordflow}{return} y;
193     \} \textcolor{keywordflow}{else} \{
194         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
195         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
196         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + ((k+1000)<<20));\textcolor{comment}{/* add k to y's exponent */}
197         \textcolor{keywordflow}{return} y*\hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000};
198     \}
199 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_ae09128febbbe6372cde4fa0c65608a42_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!expm1@{expm1}}
\index{expm1@{expm1}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{expm1(double x)}{expm1(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double expm1 (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}{}\label{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}


Definition at line 156 of file expm1.\+c.



References huge, invln2, ln2\+\_\+hi, ln2\+\_\+lo, o\+\_\+threshold, one, Q1, Q2, Q3, Q4, Q5, and tiny.



Referenced by cosh(), sinh(), and tanh().


\begin{DoxyCode}
157 \{
158     \textcolor{keywordtype}{double} y,hi,lo,c,t,e,hxs,hfx,r1;
159     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} k,xsb;
160     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hx;
161 
162     c = 0.0;
163 
164     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x); \textcolor{comment}{/* high word of x */}
165     xsb = hx&0x80000000;        \textcolor{comment}{/* sign bit of x */}
166     \textcolor{keywordflow}{if}(xsb==0) y=x;
167     \textcolor{keywordflow}{else} y= -x; \textcolor{comment}{/* y = |x| */}
168     hx &= 0x7fffffff;       \textcolor{comment}{/* high word of |x| */}
169 
170     \textcolor{comment}{/* filter out huge and non-finite argument */}
171     \textcolor{keywordflow}{if}(hx >= 0x4043687A) \{          \textcolor{comment}{/* if |x|>=56*ln2 */}
172         \textcolor{keywordflow}{if}(hx >= 0x40862E42) \{      \textcolor{comment}{/* if |x|>=709.78... */}
173             \textcolor{keywordflow}{if}(hx>=0x7ff00000) \{
174                 \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} low;
175                 \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(low,x);
176                 \textcolor{keywordflow}{if}(((hx&0xfffff)|low)!=0)
177                     \textcolor{keywordflow}{return} x+x;      \textcolor{comment}{/* NaN */}
178                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} (xsb==0)? x:-1.0;\textcolor{comment}{/* exp(+-inf)=\{inf,-1\} */}
179             \}
180             \textcolor{keywordflow}{if}(x > \hyperlink{expm1_8c_acbb7fb31d7634234372850576e110c91}{o\_threshold}) \textcolor{keywordflow}{return} \hyperlink{expm1_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{expm1_8c_acbd466133274923cc0785707fbdeea9a}{huge}; \textcolor{comment}{/* overflow */}
181         \}
182         \textcolor{keywordflow}{if}(xsb!=0) \{ \textcolor{comment}{/* x < -56*ln2, return -1.0 with inexact */}
183             \textcolor{keywordflow}{if}(x+\hyperlink{expm1_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}<0.0)      \textcolor{comment}{/* raise inexact */}
184                 \textcolor{keywordflow}{return} \hyperlink{expm1_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}-\hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one}; \textcolor{comment}{/* return -1 */}
185         \}
186     \}
187 
188     \textcolor{comment}{/* argument reduction */}
189     \textcolor{keywordflow}{if}(hx > 0x3fd62e42) \{       \textcolor{comment}{/* if  |x| > 0.5 ln2 */}
190         \textcolor{keywordflow}{if}(hx < 0x3FF0A2B2) \{   \textcolor{comment}{/* and |x| < 1.5 ln2 */}
191             \textcolor{keywordflow}{if}(xsb==0)
192             \{
193                 hi = x - \hyperlink{expm1_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi};
194                 lo =  \hyperlink{expm1_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo};
195                 k =  1;
196             \}
197             \textcolor{keywordflow}{else}
198             \{
199                 hi = x + \hyperlink{expm1_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi};
200                 lo = -\hyperlink{expm1_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo};
201                 k = -1;
202             \}
203         \} \textcolor{keywordflow}{else} \{
204             k  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(\hyperlink{expm1_8c_a4cf65ab9c76c64c084e1abd8fe5da216}{invln2}*x+((xsb==0)?0.5:-0.5));
205             t  = k;
206             hi = x - t*\hyperlink{expm1_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi};    \textcolor{comment}{/* t*ln2\_hi is exact here */}
207             lo = t*\hyperlink{expm1_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo};
208         \}
209         x  = hi - lo;
210         c  = (hi-x)-lo;
211     \}
212     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(hx < 0x3c900000) \{      \textcolor{comment}{/* when |x|<2**-54, return x */}
213         t = \hyperlink{expm1_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x; \textcolor{comment}{/* return x with inexact flags when x!=0 */}
214         \textcolor{keywordflow}{return} x - (t-(\hyperlink{expm1_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x));
215     \}
216     \textcolor{keywordflow}{else} k = 0;
217 
218     \textcolor{comment}{/* x is now in primary range */}
219     hfx = 0.5*x;
220     hxs = x*hfx;
221     r1 = \hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+hxs*(\hyperlink{expm1_8c_a337c7d6482c8cb25098d7923f887b172}{Q1}+hxs*(\hyperlink{expm1_8c_a58f4d8c535a1a29924ab9895ac5e3027}{Q2}+hxs*(\hyperlink{expm1_8c_a1053f84ccfcc301b069f5dfdf0c05af3}{Q3}+hxs*(\hyperlink{expm1_8c_a3214bc1c813c902cb818fa053ac89e7e}{Q4}+hxs*\hyperlink{expm1_8c_a439cf17c0f4c97fda729c7d078fa5d67}{Q5}))));
222     t  = 3.0-r1*hfx;
223     e  = hxs*((r1-t)/(6.0 - x*t));
224     \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} x - (x*e-hxs);      \textcolor{comment}{/* c is 0 */}
225     \textcolor{keywordflow}{else} \{
226         e  = (x*(e-c)-c);
227         e -= hxs;
228         \textcolor{keywordflow}{if}(k== -1) \textcolor{keywordflow}{return} 0.5*(x-e)-0.5;
229         \textcolor{keywordflow}{if}(k==1) \{
230             \textcolor{keywordflow}{if}(x < -0.25) \textcolor{keywordflow}{return} -2.0*(e-(x+0.5));
231             \textcolor{keywordflow}{else}          \textcolor{keywordflow}{return}  \hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+2.0*(x-e);
232         \}
233         \textcolor{keywordflow}{if} (k <= -2 || k>56) \{   \textcolor{comment}{/* suffice to return exp(x)-1 */}
234             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
235 
236             y = \hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-(e-x);
237             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy,y);
238             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + (k<<20));    \textcolor{comment}{/* add k to y's exponent */}
239             \textcolor{keywordflow}{return} y-\hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one};
240         \}
241         t = \hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one};
242         \textcolor{keywordflow}{if}(k<20) \{
243             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
244 
245             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t, 0x3ff00000 - (0x200000>>k));  \textcolor{comment}{/* t=1-2^-k */}
246             y = t-(e-x);
247             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
248             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + (k<<20));    \textcolor{comment}{/* add k to y's exponent */}
249         \} \textcolor{keywordflow}{else} \{
250             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
251 
252             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t, (0x3ff-k)<<20);   \textcolor{comment}{/* 2^-k */}
253             y = x-(e+t);
254             y += \hyperlink{expm1_8c_ada85e349d35971b32c8ea4238881ff8b}{one};
255             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
256             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + (k<<20));    \textcolor{comment}{/* add k to y's exponent */}
257         \}
258     \}
259     \textcolor{keywordflow}{return} y;
260 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!fabs@{fabs}}
\index{fabs@{fabs}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{fabs(double x)}{fabs(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double fabs (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{}\label{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}


Returns the absolute value of x. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18 
\end{DoxyDate}


Definition at line 51 of file fabs.\+c.


\begin{DoxyCode}
52 \{
53     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hx;
54     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
55     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x, hx & 0x7fffffff);
56     \textcolor{keywordflow}{return} x;
57 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!finite@{finite}}
\index{finite@{finite}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{finite(double x)}{finite(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}int finite (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a08e754462e6ec13bc05fd41cff9cdd4a}{}\label{math_8h_a08e754462e6ec13bc05fd41cff9cdd4a}


Finite or infinite number. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}
finite(x) returns 1 is x is finite, else 0. N\+O\+T\+I\+CE\+: No branching! 

Definition at line 53 of file finite.\+c.



Referenced by Positional\+Numeral\+System\+::\+Get\+Text(), and Real\+Number\+::\+Is\+Finite().


\begin{DoxyCode}
54 \{
55     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hx;
56     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
57     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned})((hx&0x7fffffff)-0x7ff00000)>>31;
58 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a08e754462e6ec13bc05fd41cff9cdd4a_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!floor@{floor}}
\index{floor@{floor}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{floor(double x)}{floor(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double floor (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}{}\label{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}


Mathematical floor function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return x rounded toward -inf to integral value
Method:
 Bit twiddling.
Exception:
 Inexact flag raised if x not equal to floor(x).
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 66 of file floor.\+c.



References huge.


\begin{DoxyCode}
67 \{
68     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} i0,i1,j0;
69     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} i,j;
70     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(i0,i1,x);
71     j0 = ((i0>>20)&0x7ff)-0x3ff;
72     \textcolor{keywordflow}{if}(j0<20) \{
73         \textcolor{keywordflow}{if}(j0<0) \{  \textcolor{comment}{/* raise inexact if x != 0 */}
74             \textcolor{keywordflow}{if}(\hyperlink{floor_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>0.0) \{\textcolor{comment}{/* return 0*sign(x) if |x|<1 */}
75                 \textcolor{keywordflow}{if}(i0>=0) \{
76                     i0=i1=0;
77                 \}
78                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(((i0&0x7fffffff)|i1)!=0)
79                 \{
80                     i0=0xbff00000;
81                     i1=0;
82                 \}
83             \}
84         \} \textcolor{keywordflow}{else} \{
85             i = (0x000fffff)>>j0;
86             \textcolor{keywordflow}{if}(((i0&i)|i1)==0) \textcolor{keywordflow}{return} x; \textcolor{comment}{/* x is integral */}
87             \textcolor{keywordflow}{if}(\hyperlink{floor_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>0.0) \{    \textcolor{comment}{/* raise inexact flag */}
88                 \textcolor{keywordflow}{if}(i0<0) i0 += (0x00100000)>>j0;
89                 i0 &= (~i);
90                 i1=0;
91             \}
92         \}
93     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j0>51) \{
94         \textcolor{keywordflow}{if}(j0==0x400) \textcolor{keywordflow}{return} x+x;   \textcolor{comment}{/* inf or NaN */}
95         \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} x;      \textcolor{comment}{/* x is integral */}
96     \} \textcolor{keywordflow}{else} \{
97         i = ((\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})(0xffffffff))>>(j0-20);
98         \textcolor{keywordflow}{if}((i1&i)==0) \textcolor{keywordflow}{return} x; \textcolor{comment}{/* x is integral */}
99         \textcolor{keywordflow}{if}(\hyperlink{floor_8c_acbd466133274923cc0785707fbdeea9a}{huge}+x>0.0) \{        \textcolor{comment}{/* raise inexact flag */}
100             \textcolor{keywordflow}{if}(i0<0) \{
101                 \textcolor{keywordflow}{if}(j0==20) i0+=1;
102                 \textcolor{keywordflow}{else} \{
103                     j = i1+(1<<(52-j0));
104                     \textcolor{keywordflow}{if}(j<(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})i1) i0 +=1 ;   \textcolor{comment}{/* got a carry */}
105                     i1=j;
106                 \}
107             \}
108             i1 &= (~i);
109         \}
110     \}
111     \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(x,i0,i1);
112     \textcolor{keywordflow}{return} x;
113 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!fmod@{fmod}}
\index{fmod@{fmod}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{fmod(double x, double y)}{fmod(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double fmod (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a537296d1a8f9fb621676038b99ba7edf}{}\label{math_8h_a537296d1a8f9fb621676038b99ba7edf}


Return x mod y in exact arithmetic. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}
Method\+: shift and subtract 

Definition at line 58 of file fmod.\+c.



References one, and Zero.


\begin{DoxyCode}
59 \{
60     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} n,hx,hy,hz,ix,iy,sx,i;
61     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx,ly,lz;
62 
63     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
64     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hy,ly,y);
65     sx = hx&0x80000000;     \textcolor{comment}{/* sign of x */}
66     hx ^=sx;        \textcolor{comment}{/* |x| */}
67     hy &= 0x7fffffff;   \textcolor{comment}{/* |y| */}
68 
69     \textcolor{comment}{/* purge off exception values */}
70     \textcolor{keywordflow}{if}((hy|ly)==0||(hx>=0x7ff00000)||   \textcolor{comment}{/* y=0,or x not finite */}
71             ((hy|((ly|-ly)>>31))>0x7ff00000))   \textcolor{comment}{/* or y is NaN */}
72         \textcolor{keywordflow}{return} (x*y)/(x*y);
73     \textcolor{keywordflow}{if}(hx<=hy) \{
74         \textcolor{keywordflow}{if}((hx<hy)||(lx<ly)) \textcolor{keywordflow}{return} x;  \textcolor{comment}{/* |x|<|y| return x */}
75         \textcolor{keywordflow}{if}(lx==ly)
76             \textcolor{keywordflow}{return} \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero}[(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})sx>>31];    \textcolor{comment}{/* |x|=|y| return x*0*/}
77     \}
78 
79     \textcolor{comment}{/* determine ix = ilogb(x) */}
80     \textcolor{keywordflow}{if}(hx<0x00100000) \{ \textcolor{comment}{/* subnormal x */}
81         \textcolor{keywordflow}{if}(hx==0) \{
82             \textcolor{keywordflow}{for} (ix = -1043, i=lx; i>0; i<<=1) ix -=1;
83         \} \textcolor{keywordflow}{else} \{
84             \textcolor{keywordflow}{for} (ix = -1022,i=(hx<<11); i>0; i<<=1) ix -=1;
85         \}
86     \} \textcolor{keywordflow}{else} ix = (hx>>20)-1023;
87 
88     \textcolor{comment}{/* determine iy = ilogb(y) */}
89     \textcolor{keywordflow}{if}(hy<0x00100000) \{ \textcolor{comment}{/* subnormal y */}
90         \textcolor{keywordflow}{if}(hy==0) \{
91             \textcolor{keywordflow}{for} (iy = -1043, i=ly; i>0; i<<=1) iy -=1;
92         \} \textcolor{keywordflow}{else} \{
93             \textcolor{keywordflow}{for} (iy = -1022,i=(hy<<11); i>0; i<<=1) iy -=1;
94         \}
95     \} \textcolor{keywordflow}{else} iy = (hy>>20)-1023;
96 
97     \textcolor{comment}{/* set up \{hx,lx\}, \{hy,ly\} and align y to x */}
98     \textcolor{keywordflow}{if}(ix >= -1022)
99         hx = 0x00100000|(0x000fffff&hx);
100     \textcolor{keywordflow}{else} \{      \textcolor{comment}{/* subnormal x, shift x to normal */}
101         n = -1022-ix;
102         \textcolor{keywordflow}{if}(n<=31) \{
103             hx = (hx<<n)|(lx>>(32-n));
104             lx <<= n;
105         \} \textcolor{keywordflow}{else} \{
106             hx = lx<<(n-32);
107             lx = 0;
108         \}
109     \}
110     \textcolor{keywordflow}{if}(iy >= -1022)
111         hy = 0x00100000|(0x000fffff&hy);
112     \textcolor{keywordflow}{else} \{      \textcolor{comment}{/* subnormal y, shift y to normal */}
113         n = -1022-iy;
114         \textcolor{keywordflow}{if}(n<=31) \{
115             hy = (hy<<n)|(ly>>(32-n));
116             ly <<= n;
117         \} \textcolor{keywordflow}{else} \{
118             hy = ly<<(n-32);
119             ly = 0;
120         \}
121     \}
122 
123     \textcolor{comment}{/* fix point fmod */}
124     n = ix - iy;
125     \textcolor{keywordflow}{while}(n--) \{
126         hz=hx-hy;
127         lz=lx-ly;
128         \textcolor{keywordflow}{if}(lx<ly) hz -= 1;
129         \textcolor{keywordflow}{if}(hz<0) \{
130             hx = hx+hx+(lx>>31);
131             lx = lx+lx;
132         \}
133         \textcolor{keywordflow}{else} \{
134             \textcolor{keywordflow}{if}((hz|lz)==0)      \textcolor{comment}{/* return sign(x)*0 */}
135                 \textcolor{keywordflow}{return} \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero}[(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})sx>>31];
136             hx = hz+hz+(lz>>31);
137             lx = lz+lz;
138         \}
139     \}
140     hz=hx-hy;
141     lz=lx-ly;
142     \textcolor{keywordflow}{if}(lx<ly) hz -= 1;
143     \textcolor{keywordflow}{if}(hz>=0) \{
144         hx=hz;
145         lx=lz;
146     \}
147 
148     \textcolor{comment}{/* convert back to floating value and restore the sign */}
149     \textcolor{keywordflow}{if}((hx|lx)==0)          \textcolor{comment}{/* return sign(x)*0 */}
150         \textcolor{keywordflow}{return} \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero}[(\textcolor{keywordtype}{unsigned})sx>>31];
151     \textcolor{keywordflow}{while}(hx<0x00100000) \{      \textcolor{comment}{/* normalize x */}
152         hx = hx+hx+(lx>>31);
153         lx = lx+lx;
154         iy -= 1;
155     \}
156     \textcolor{keywordflow}{if}(iy>= -1022) \{    \textcolor{comment}{/* normalize output */}
157         hx = ((hx-0x00100000)|((iy+1023)<<20));
158         \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(x,hx|sx,lx);
159     \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* subnormal output */}
160         n = -1022 - iy;
161         \textcolor{keywordflow}{if}(n<=20) \{
162             lx = (lx>>n)|((\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})hx<<(32-n));
163             hx >>= n;
164         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n<=31) \{
165             lx = (hx<<(32-n))|(lx>>n);
166             hx = sx;
167         \} \textcolor{keywordflow}{else} \{
168             lx = hx>>(n-32);
169             hx = sx;
170         \}
171         \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(x,hx|sx,lx);
172         x *= \hyperlink{fmod_8c_ada85e349d35971b32c8ea4238881ff8b}{one};        \textcolor{comment}{/* create necessary signal */}
173     \}
174     \textcolor{keywordflow}{return} x;       \textcolor{comment}{/* exact output */}
175 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!hypot@{hypot}}
\index{hypot@{hypot}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{hypot(double x, double y)}{hypot(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double hypot (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a6d6a905f61d535f8454190433b8c0ea5}{}\label{math_8h_a6d6a905f61d535f8454190433b8c0ea5}


Definition at line 79 of file hypot.\+c.



References sqrt().



Referenced by cabs().


\begin{DoxyCode}
80 \{
81     \textcolor{keywordtype}{double} a=x,b=y,t1,t2,y1,y2,w;
82     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} j,k,ha,hb,hx,hy;
83 
84     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
85     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy,y);
86     ha = hx&0x7fffffff; \textcolor{comment}{/* high word of  x */}
87     hb = hy&0x7fffffff; \textcolor{comment}{/* high word of  y */}
88     \textcolor{keywordflow}{if}(hb > ha) \{
89         a=y;
90         b=x;
91         j=ha;
92         ha=hb;
93         hb=j;
94     \}
95     \textcolor{keywordflow}{else} \{
96         a=x;
97         b=y;
98     \}
99     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(a,ha); \textcolor{comment}{/* a <- |a| */}
100     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(b,hb); \textcolor{comment}{/* b <- |b| */}
101     \textcolor{keywordflow}{if}((ha-hb)>0x3c00000) \{
102         \textcolor{keywordflow}{return} a+b;   \textcolor{comment}{/* x/y > 2**60 */}
103     \}
104     k=0;
105     \textcolor{keywordflow}{if}(ha > 0x5f300000) \{   \textcolor{comment}{/* a>2**500 */}
106         \textcolor{keywordflow}{if}(ha >= 0x7ff00000) \{  \textcolor{comment}{/* Inf or NaN */}
107             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} la, lb;
108             w = a+b;            \textcolor{comment}{/* for sNaN */}
109             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(la,a);
110             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lb,b);
111             \textcolor{keywordflow}{if}(((ha&0xfffff)|la)==0) w = a;
112             \textcolor{keywordflow}{if}(((hb^0x7ff00000)|lb)==0) w = b;
113             \textcolor{keywordflow}{return} w;
114         \}
115         \textcolor{comment}{/* scale a and b by 2**-600 */}
116         ha -= 0x25800000;
117         hb -= 0x25800000;
118         k += 600;
119         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(a,ha);
120         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(b,hb);
121     \}
122     \textcolor{keywordflow}{if}(hb < 0x20b00000) \{   \textcolor{comment}{/* b < 2**-500 */}
123         \textcolor{keywordflow}{if}(hb <= 0x000fffff) \{  \textcolor{comment}{/* subnormal b or 0 */}
124             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lb;
125             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lb,b);
126             \textcolor{keywordflow}{if}((hb|lb)==0) \textcolor{keywordflow}{return} a;
127             t1=0;
128             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t1, 0x7fd00000); \textcolor{comment}{/* t1=2^1022 */}
129             b *= t1;
130             a *= t1;
131             k -= 1022;
132         \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* scale a and b by 2^600 */}
133             ha += 0x25800000;   \textcolor{comment}{/* a *= 2^600 */}
134             hb += 0x25800000;   \textcolor{comment}{/* b *= 2^600 */}
135             k -= 600;
136 
137             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(a,ha);
138             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(b,hb);
139         \}
140     \}
141     \textcolor{comment}{/* medium size a and b */}
142     w = a-b;
143     \textcolor{keywordflow}{if} (w>b) \{
144         t1 = 0;
145         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t1, ha);
146         t2 = a-t1;
147         w  = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(t1*t1-(b*(-b)-t2*(a+t1)));
148     \} \textcolor{keywordflow}{else} \{
149         a  = a+a;
150         y1 = 0;
151         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y1, hb);
152         y2 = b - y1;
153         t1 = 0;
154         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t1, ha+0x00100000);
155         t2 = a - t1;
156         w  = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(t1*y1-(w*(-w)-(t1*y2+t2*b)));
157     \}
158     \textcolor{keywordflow}{if}(k!=0) \{
159         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} ht1;
160 
161         t1 = 1.0;
162         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ht1, t1);
163         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t1, ht1 + (k<<20));
164         \textcolor{keywordflow}{return} t1*w;
165     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} w;
166 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{math_8h_a6d6a905f61d535f8454190433b8c0ea5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a6d6a905f61d535f8454190433b8c0ea5_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!isnan@{isnan}}
\index{isnan@{isnan}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{isnan(double x)}{isnan(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}int isnan (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_afdf433fdb158cbe82ce818a3a2de736b}{}\label{math_8h_afdf433fdb158cbe82ce818a3a2de736b}


isnan(x) returns 1 is x is nan, else 0. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}
N\+O\+T\+I\+CE\+: No branching! 

Definition at line 49 of file isnan.\+c.



Referenced by Positional\+Numeral\+System\+::\+Get\+Text(), and Real\+Number\+::\+Is\+Na\+N().


\begin{DoxyCode}
50 \{
51     \textcolor{keywordflow}{return} ((x) != (x));
52 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_afdf433fdb158cbe82ce818a3a2de736b_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!log@{log}}
\index{log@{log}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{log(double x)}{log(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double log (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{}\label{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}


Natural logarithm function (base e). 

\begin{DoxyVersion}{Version}
1.\+4 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
96/03/07
\end{DoxyDate}

\begin{DoxyPre}
Method :
  1. Argument Reduction: find k and f such that
        x = 2^k * (1+f),
    where  sqrt(2)/2 < 1+f < sqrt(2) .\end{DoxyPre}



\begin{DoxyPre}  2. Approximation of log(1+f).
 Let s = f/(2+f) ; based on log(1+f) = log(1+s) - log(1-s)
     = 2s + 2/3 s**3 + 2/5 s**5 + .....,
         = 2s + s*R
     We use a special Remes algorithm on [0,0.1716] to generate
    a polynomial of degree 14 to approximate R The maximum error
 of this polynomial approximation is bounded by 2**-58.45. In
 other words,
            2      4      6      8      10      12      14
     R(z) ~ Lg1*s +Lg2*s +Lg3*s +Lg4*s +Lg5*s  +Lg6*s  +Lg7*s
    (the values of Lg1 to Lg7 are listed in the program)
 and
     |      2          14          |     -58.45
     | Lg1*s +...+Lg7*s    -  R(z) | <= 2
     |                             |
 Note that 2s = f - s*f = f - hfsq + s*hfsq, where hfsq = f*f/2.
 In order to guarantee error in log below 1ulp, we compute log
 by
    log(1+f) = f - s*(f - R)    (if f is not too large)
    log(1+f) = f - (hfsq - s*(hfsq+R)). (better accuracy)\end{DoxyPre}



\begin{DoxyPre} 3. Finally,  log(x) = k*ln2 + log(1+f).
            = k*ln2\_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2\_lo)))
    Here ln2 is split into two floating point number:
        ln2\_hi + ln2\_lo,
    where n*ln2\_hi is always exact for |n| < 2000.\end{DoxyPre}



\begin{DoxyPre}Special cases:
 log(x) is NaN with signal if x < 0 (including -INF) ;
 log(+INF) is +INF; log(0) is -INF with signal;
 log(NaN) is that NaN with no signal.\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 according to an error analysis, the error is always less than
 1 ulp (unit in the last place).\end{DoxyPre}



\begin{DoxyPre}Constants:
The hexadecimal values are the intended ones for the following
constants. The decimal values may be used, provided that the
compiler will convert from decimal to binary accurately enough
to produce the hexadecimal values shown.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 118 of file log.\+c.



References Lg1, Lg2, Lg3, Lg4, Lg5, Lg6, Lg7, ln2\+\_\+hi, ln2\+\_\+lo, two54, and zero.


\begin{DoxyCode}
119 \{
120     \textcolor{keywordtype}{double} hfsq,f,s,z,R,w,t1,t2,dk;
121     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} k,hx,i,j;
122     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
123 
124     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
125 
126     k=0;
127     \textcolor{keywordflow}{if} (hx < 0x00100000) \{          \textcolor{comment}{/* x < 2**-1022  */}
128         \textcolor{keywordflow}{if} (((hx&0x7fffffff)|lx)==0)
129             \textcolor{keywordflow}{return} -\hyperlink{log_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54}/\hyperlink{log_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};        \textcolor{comment}{/* log(+-0)=-inf */}
130         \textcolor{keywordflow}{if} (hx<0) \textcolor{keywordflow}{return} (x-x)/\hyperlink{log_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};    \textcolor{comment}{/* log(-#) = NaN */}
131         k -= 54;
132         x *= \hyperlink{log_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54}; \textcolor{comment}{/* subnormal number, scale up x */}
133         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);       \textcolor{comment}{/* high word of x */}
134     \}
135     \textcolor{keywordflow}{if} (hx >= 0x7ff00000) \textcolor{keywordflow}{return} x+x;
136     k += (hx>>20)-1023;
137     hx &= 0x000fffff;
138     i = (hx+0x95f64)&0x100000;
139     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x,hx|(i^0x3ff00000));    \textcolor{comment}{/* normalize x or x/2 */}
140     k += (i>>20);
141     f = x-1.0;
142     \textcolor{keywordflow}{if}((0x000fffff&(2+hx))<3) \{ \textcolor{comment}{/* |f| < 2**-20 */}
143         \textcolor{keywordflow}{if}(f==\hyperlink{log_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero}) \{
144             \textcolor{keywordflow}{if}(k==0)
145                 \textcolor{keywordflow}{return} \hyperlink{log_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};
146             \textcolor{keywordflow}{else} \{
147                 dk=(double)k;
148                 \textcolor{keywordflow}{return} dk*\hyperlink{log_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}+dk*\hyperlink{log_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo};
149             \}
150         \}
151         R = f*f*(0.5-0.33333333333333333*f);
152         \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} f-R;
153         \textcolor{keywordflow}{else} \{
154             dk=(double)k;
155             \textcolor{keywordflow}{return} dk*\hyperlink{log_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}-((R-dk*\hyperlink{log_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo})-f);
156         \}
157     \}
158     s = f/(2.0+f);
159     dk = (double)k;
160     z = s*s;
161     i = hx-0x6147a;
162     w = z*z;
163     j = 0x6b851-hx;
164     t1= w*(\hyperlink{log_8c_ac1a4f6174aa4dd099e0a734fc11b0c3e}{Lg2}+w*(\hyperlink{log_8c_a75ba95a9dce0de304a80d47b4031a594}{Lg4}+w*\hyperlink{log_8c_a37c6fabdfdd55cf0a7166ec4cf6cb72f}{Lg6}));
165     t2= z*(\hyperlink{log_8c_aee6b9e56932bed1ba4ee033ddf822554}{Lg1}+w*(\hyperlink{log_8c_abbb475ec79f62ee366fdb3f250c70ca2}{Lg3}+w*(\hyperlink{log_8c_aa722e2f0e2ac3b021fb393d166a358d7}{Lg5}+w*\hyperlink{log_8c_a2d7c634068cd4f7a636178956c67d37c}{Lg7})));
166     i |= j;
167     R = t2+t1;
168     \textcolor{keywordflow}{if}(i>0) \{
169         hfsq=0.5*f*f;
170         \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} f-(hfsq-s*(hfsq+R));
171         \textcolor{keywordflow}{else}
172             \textcolor{keywordflow}{return} dk*\hyperlink{log_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}-((hfsq-(s*(hfsq+R)+dk*\hyperlink{log_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo}))-f);
173     \} \textcolor{keywordflow}{else} \{
174         \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} f-s*(f-R);
175         \textcolor{keywordflow}{else}
176             \textcolor{keywordflow}{return} dk*\hyperlink{log_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}-((s*(f-R)-dk*\hyperlink{log_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo})-f);
177     \}
178 \}
\end{DoxyCode}
\index{math.\+h@{math.\+h}!log10@{log10}}
\index{log10@{log10}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{log10(double x)}{log10(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double log10 (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a6572e82a4891917a9ba7fb2a964f8182}{}\label{math_8h_a6572e82a4891917a9ba7fb2a964f8182}


Base 10 logarithm function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 Let log10\_2hi = leading 40 bits of log10(2) and
     log10\_2lo = log10(2) - log10\_2hi,
     ivln10   = 1/log(10) rounded.
 Then
    n = ilogb(x),
    if(n<0)  n = n+1;
    x = scalbn(x,-n);
    log10(x) := n*log10\_2hi + (n*log10\_2lo + ivln10*log(x))\end{DoxyPre}



\begin{DoxyPre}Note 1:
 To guarantee log10(10**n)=n, where 10**n is normal, the rounding
 mode must set to Round-to-Nearest.
Note 2:
 [1/log(10)] rounded to 53 bits has error  .198   ulps;
 log10 is monotonic at all binary break points.\end{DoxyPre}



\begin{DoxyPre}Special cases:
 log10(x) is NaN with signal if x < 0;
 log10(+INF) is +INF with no signal; log10(0) is -INF with signal;
 log10(NaN) is that NaN with no signal;
 log10(10**N) = N  for N=0,1,...,22.\end{DoxyPre}



\begin{DoxyPre}Constants:
The hexadecimal values are the intended ones for the following constants.
The decimal values may be used, provided that the compiler will convert
from decimal to binary accurately enough to produce the hexadecimal values
shown.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 95 of file log10.\+c.



References ivln10, log10\+\_\+2hi, log10\+\_\+2lo, two54, and zero.



Referenced by Decimal\+System\+::\+Get\+Real\+Text(), and Real\+Number\+::\+Log10().


\begin{DoxyCode}
96 \{
97     \textcolor{keywordtype}{double} y,z;
98     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} i,k,hx;
99     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
100 
101     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
102 
103     k=0;
104     \textcolor{keywordflow}{if} (hx < 0x00100000) \{                  \textcolor{comment}{/* x < 2**-1022  */}
105         \textcolor{keywordflow}{if} (((hx&0x7fffffff)|lx)==0)
106             \textcolor{keywordflow}{return} -\hyperlink{log10_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54}/\hyperlink{log10_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};             \textcolor{comment}{/* log(+-0)=-inf */}
107         \textcolor{keywordflow}{if} (hx<0) \textcolor{keywordflow}{return} (x-x)/\hyperlink{log10_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};        \textcolor{comment}{/* log(-#) = NaN */}
108         k -= 54;
109         x *= \hyperlink{log10_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54}; \textcolor{comment}{/* subnormal number, scale up x */}
110         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx, x);              \textcolor{comment}{/* high word of x */}
111     \}
112     \textcolor{keywordflow}{if} (hx >= 0x7ff00000) \textcolor{keywordflow}{return} x+x;
113     k += (hx>>20)-1023;
114     i  = ((\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})k&0x80000000)>>31;
115     hx = (hx&0x000fffff)|((0x3ff-i)<<20);
116     y  = (double)(k+i);
117     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x,hx);
118     z  = y*\hyperlink{log10_8c_a3d0a247317a150af2b92315571801f57}{log10\_2lo} + \hyperlink{log10_8c_a9e0d02b329f006c4998b2227ab12536f}{ivln10}*\hyperlink{math_8h_adb302c9aafbaa5e180d9f60ee954bb82}{log}(x);
119     \textcolor{keywordflow}{return}  z+y*\hyperlink{log10_8c_aae29d5b8624c0ccbc7e1ed4165b8f050}{log10\_2hi};
120 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a6572e82a4891917a9ba7fb2a964f8182_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!log1p@{log1p}}
\index{log1p@{log1p}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{log1p(double x)}{log1p(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double log1p (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ac2aac20ab1347498e6e4f209148fea84}{}\label{math_8h_ac2aac20ab1347498e6e4f209148fea84}


Definition at line 125 of file log1p.\+c.



References ln2\+\_\+hi, ln2\+\_\+lo, Lp1, Lp2, Lp3, Lp4, Lp5, Lp6, Lp7, two54, and zero.



Referenced by acosh(), asinh(), and atanh().


\begin{DoxyCode}
126 \{
127     \textcolor{keywordtype}{double} hfsq,f,c,s,z,R,u;
128     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} k,hx,hu,ax;
129 
130     f = 0.0;
131     c = 0.0;
132     hu = 0;
133 
134     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x); \textcolor{comment}{/* high word of x */}
135     ax = hx&0x7fffffff;
136 
137     k = 1;
138     \textcolor{keywordflow}{if} (hx < 0x3FDA827A) \{          \textcolor{comment}{/* x < 0.41422  */}
139         \textcolor{keywordflow}{if}(ax>=0x3ff00000) \{        \textcolor{comment}{/* x <= -1.0 */}
140             \textcolor{keywordflow}{if}(x==-1.0) \textcolor{keywordflow}{return} -\hyperlink{log1p_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54}/\hyperlink{log1p_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero}; \textcolor{comment}{/* log1p(-1)=+inf */}
141             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} (x-x)/(x-x);    \textcolor{comment}{/* log1p(x<-1)=NaN */}
142         \}
143         \textcolor{keywordflow}{if}(ax<0x3e200000) \{         \textcolor{comment}{/* |x| < 2**-29 */}
144             \textcolor{keywordflow}{if}(\hyperlink{log1p_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54}+x>\hyperlink{log1p_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero}            \textcolor{comment}{/* raise inexact */}
145                     &&ax<0x3c900000)        \textcolor{comment}{/* |x| < 2**-54 */}
146                 \textcolor{keywordflow}{return} x;
147             \textcolor{keywordflow}{else}
148                 \textcolor{keywordflow}{return} x - x*x*0.5;
149         \}
150         \textcolor{keywordflow}{if}(hx>0||hx<=((\textcolor{keywordtype}{int})0xbfd2bec3)) \{
151             k=0;
152             f=x;
153             hu=1;
154         \}   \textcolor{comment}{/* -0.2929<x<0.41422 */}
155     \}
156     \textcolor{keywordflow}{if} (hx >= 0x7ff00000) \textcolor{keywordflow}{return} x+x;
157     \textcolor{keywordflow}{if}(k!=0) \{
158         \textcolor{keywordflow}{if}(hx<0x43400000) \{
159             u  = 1.0+x;
160             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hu,u); \textcolor{comment}{/* high word of u */}
161             k  = (hu>>20)-1023;
162             c  = (k>0)? 1.0-(u-x):x-(u-1.0);\textcolor{comment}{/* correction term */}
163             c /= u;
164         \} \textcolor{keywordflow}{else} \{
165             u  = x;
166             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hu,u); \textcolor{comment}{/* high word of u */}
167             k  = (hu>>20)-1023;
168             c  = 0;
169         \}
170         hu &= 0x000fffff;
171         \textcolor{keywordflow}{if}(hu<0x6a09e) \{
172             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(u, hu|0x3ff00000);   \textcolor{comment}{/* normalize u */}
173         \} \textcolor{keywordflow}{else} \{
174             k += 1;
175             \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(u, hu|0x3fe00000);   \textcolor{comment}{/* normalize u/2 */}
176             hu = (0x00100000-hu)>>2;
177         \}
178         f = u-1.0;
179     \}
180     hfsq=0.5*f*f;
181     \textcolor{keywordflow}{if}(hu==0) \{ \textcolor{comment}{/* |f| < 2**-20 */}
182         \textcolor{keywordflow}{if}(f==\hyperlink{log1p_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero}) \{
183             \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} \hyperlink{log1p_8c_a548c77babcdf18ce7b6b96e73fb912cd}{zero};
184             \textcolor{keywordflow}{else} \{
185                 c += k*\hyperlink{log1p_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo};
186                 \textcolor{keywordflow}{return} k*\hyperlink{log1p_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}+c;
187             \}
188         \}
189         R = hfsq*(1.0-0.66666666666666666*f);
190         \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} f-R;
191         \textcolor{keywordflow}{else}
192             \textcolor{keywordflow}{return} k*\hyperlink{log1p_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}-((R-(k*\hyperlink{log1p_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo}+c))-f);
193     \}
194     s = f/(2.0+f);
195     z = s*s;
196     R = z*(\hyperlink{log1p_8c_adf93ac779b293272e7b95f2233c4fe81}{Lp1}+z*(\hyperlink{log1p_8c_a9dc9cb73351580a36dd1d75c1bf6445e}{Lp2}+z*(\hyperlink{log1p_8c_ae6d94c4dd0ba029f46b16fa9754cba4b}{Lp3}+z*(\hyperlink{log1p_8c_ad0eb14292e1de3e1834deac664c5f1d9}{Lp4}+z*(\hyperlink{log1p_8c_ae79f6305ae4721b94610245fb05d6bbe}{Lp5}+z*(\hyperlink{log1p_8c_aa92ed61f17dd34d1d454b5f85cfaab95}{Lp6}+z*\hyperlink{log1p_8c_abc8df4f5562a7e640d0e377c0d7824b1}{Lp7}))))));
197     \textcolor{keywordflow}{if}(k==0) \textcolor{keywordflow}{return} f-(hfsq-s*(hfsq+R));
198     \textcolor{keywordflow}{else}
199         \textcolor{keywordflow}{return} k*\hyperlink{log1p_8c_a681dec71eb3b6048386c010ec2444fa4}{ln2\_hi}-((hfsq-(s*(hfsq+R)+(k*\hyperlink{log1p_8c_aad361cc103aeef29c711917f539eb9bd}{ln2\_lo}+c)))-f);
200 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_ac2aac20ab1347498e6e4f209148fea84_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!pow@{pow}}
\index{pow@{pow}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{pow(double x, double y)}{pow(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double pow (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_aa56c9494c95edf68386375e97d64159b}{}\label{math_8h_aa56c9494c95edf68386375e97d64159b}


Expontation function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method:  Let x =  2   * (1+f)
 1. Compute and return log2(x) in two pieces:
    log2(x) = w1 + w2,
    where w1 has 53-24 = 29 bit trailing zeros.
 2. Perform y*log2(x) = n+y' by simulating muti-precision
    arithmetic, where |y'|<=0.5.
 3. Return x**y = 2**n*exp(y'*log2)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 1.  (anything) ** 0  is 1
 2.  (anything) ** 1  is itself
 3.  (anything) ** NAN is NAN
 4.  NAN ** (anything except 0) is NAN
 5.  +-(|x| > 1) **  +INF is +INF
 6.  +-(|x| > 1) **  -INF is +0
 7.  +-(|x| < 1) **  +INF is +0
 8.  +-(|x| < 1) **  -INF is +INF
 9.  +-1         ** +-INF is NAN
 10. +0 ** (+anything except 0, NAN)               is +0
 11. -0 ** (+anything except 0, NAN, odd integer)  is +0
 12. +0 ** (-anything except 0, NAN)               is +INF
 13. -0 ** (-anything except 0, NAN, odd integer)  is +INF
 14. -0 ** (odd integer) = -( +0 ** (odd integer) )
 15. +INF ** (+anything except 0,NAN) is +INF
 16. +INF ** (-anything except 0,NAN) is +0
 17. -INF ** (anything)  = -0 ** (-anything)
 18. (-anything) ** (integer) is (-1)**(integer)*(+anything**integer)
 19. (-anything except 0 and inf) ** (non-integer) is NAN\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 pow(x,y) returns x**y nearly rounded. In particular
        pow(integer,integer)
 always returns the correct integer provided it is
 representable.\end{DoxyPre}



\begin{DoxyPre}Constants :
The hexadecimal values are the intended ones for the following
constants. The decimal values may be used, provided that the
compiler will convert from decimal to binary accurately enough
to produce the hexadecimal values shown.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 139 of file pow.\+c.



References bp, cp, cp\+\_\+h, cp\+\_\+l, dp\+\_\+h, dp\+\_\+l, huge, ivln2, ivln2\+\_\+h, ivln2\+\_\+l, L1, L2, L3, L4, L5, L6, lg2, lg2\+\_\+h, lg2\+\_\+l, one, ovt, P1, P2, P3, P4, P5, scalbn(), sqrt(), tiny, two, two53, and zero.



Referenced by cpow(), Decimal\+System\+::\+Get\+Real\+Text(), Positional\+Numeral\+System\+::\+Get\+Text(), Positional\+Numeral\+System\+::\+Parse(), and Real\+Number\+::\+Raise().


\begin{DoxyCode}
140 \{
141     \textcolor{keywordtype}{double} z,ax,z\_h,z\_l,p\_h,p\_l;
142     \textcolor{keywordtype}{double} y1,t1,t2,r,s,t,u,v,w;
143     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} i0,i1,i,j,k,yisint,n;
144     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,hy,ix,iy;
145     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx,ly;
146 
147     i0 = ((*(\textcolor{keywordtype}{int}*)&\hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one})>>29)^1;
148     i1=1-i0;
149     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
150     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hy,ly,y);
151     ix = hx&0x7fffffff;
152     iy = hy&0x7fffffff;
153 
154     \textcolor{comment}{/* y==zero: x**0 = 1 */}
155     \textcolor{keywordflow}{if}((iy|ly)==0) \textcolor{keywordflow}{return} \hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one};
156 
157     \textcolor{comment}{/* +-NaN return x+y */}
158     \textcolor{keywordflow}{if}(ix > 0x7ff00000 || ((ix==0x7ff00000)&&(lx!=0)) ||
159             iy > 0x7ff00000 || ((iy==0x7ff00000)&&(ly!=0)))
160         \textcolor{keywordflow}{return} x+y;
161 
162     \textcolor{comment}{/* determine if y is an odd int when x < 0}
163 \textcolor{comment}{     * yisint = 0   ... y is not an integer}
164 \textcolor{comment}{     * yisint = 1   ... y is an odd int}
165 \textcolor{comment}{     * yisint = 2   ... y is an even int}
166 \textcolor{comment}{     */}
167     yisint  = 0;
168     \textcolor{keywordflow}{if}(hx<0) \{
169         \textcolor{keywordflow}{if}(iy>=0x43400000) yisint = 2; \textcolor{comment}{/* even integer y */}
170         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(iy>=0x3ff00000) \{
171             k = (iy>>20)-0x3ff;    \textcolor{comment}{/* exponent */}
172             \textcolor{keywordflow}{if}(k>20) \{
173                 j = ly>>(52-k);
174                 \textcolor{keywordflow}{if}((\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})(j<<(52-k))==ly) yisint = 2-(j&1);
175             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ly==0) \{
176                 j = iy>>(20-k);
177                 \textcolor{keywordflow}{if}((j<<(20-k))==iy) yisint = 2-(j&1);
178             \}
179         \}
180     \}
181 
182     \textcolor{comment}{/* special value of y */}
183     \textcolor{keywordflow}{if}(ly==0) \{
184         \textcolor{keywordflow}{if} (iy==0x7ff00000) \{   \textcolor{comment}{/* y is +-inf */}
185             \textcolor{keywordflow}{if}(((ix-0x3ff00000)|lx)==0)
186                 \textcolor{keywordflow}{return}  y - y;  \textcolor{comment}{/* inf**+-1 is NaN */}
187             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix >= 0x3ff00000)\textcolor{comment}{/* (|x|>1)**+-inf = inf,0 */}
188                 \textcolor{keywordflow}{return} (hy>=0)? y: \hyperlink{pow_8c_a554f7b66b1ba49443447eb746978c268}{zero};
189             \textcolor{keywordflow}{else}            \textcolor{comment}{/* (|x|<1)**-,+inf = inf,0 */}
190                 \textcolor{keywordflow}{return} (hy<0)?-y: \hyperlink{pow_8c_a554f7b66b1ba49443447eb746978c268}{zero};
191         \}
192         \textcolor{keywordflow}{if}(iy==0x3ff00000) \{    \textcolor{comment}{/* y is  +-1 */}
193             \textcolor{keywordflow}{if}(hy<0) \textcolor{keywordflow}{return} \hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one}/x;
194             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} x;
195         \}
196         \textcolor{keywordflow}{if}(hy==0x40000000) \textcolor{keywordflow}{return} x*x; \textcolor{comment}{/* y is  2 */}
197         \textcolor{keywordflow}{if}(hy==0x3fe00000) \{    \textcolor{comment}{/* y is  0.5 */}
198             \textcolor{keywordflow}{if}(hx>=0)   \textcolor{comment}{/* x >= +0 */}
199                 \textcolor{keywordflow}{return} \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(x);
200         \}
201     \}
202 
203     ax   = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
204     \textcolor{comment}{/* special value of x */}
205     \textcolor{keywordflow}{if}(lx==0) \{
206         \textcolor{keywordflow}{if}(ix==0x7ff00000||ix==0||ix==0x3ff00000) \{
207             z = ax;         \textcolor{comment}{/*x is +-0,+-inf,+-1*/}
208             \textcolor{keywordflow}{if}(hy<0) z = \hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one}/z;  \textcolor{comment}{/* z = (1/|x|) */}
209             \textcolor{keywordflow}{if}(hx<0) \{
210                 \textcolor{keywordflow}{if}(((ix-0x3ff00000)|yisint)==0) \{
211                     z = (z-z)/(z-z); \textcolor{comment}{/* (-1)**non-int is NaN */}
212                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(yisint==1)
213                     z = -z;     \textcolor{comment}{/* (x<0)**odd = -(|x|**odd) */}
214             \}
215             \textcolor{keywordflow}{return} z;
216         \}
217     \}
218 
219     n = (hx>>31)+1;
220 
221     \textcolor{comment}{/* (x<0)**(non-int) is NaN */}
222     \textcolor{keywordflow}{if}((n|yisint)==0) \textcolor{keywordflow}{return} (x-x)/(x-x);
223 
224     s = \hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one}; \textcolor{comment}{/* s (sign of result -ve**odd) = -1 else = 1 */}
225     \textcolor{keywordflow}{if}((n|(yisint-1))==0) s = -\hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one};\textcolor{comment}{/* (-ve)**(odd int) */}
226 
227     \textcolor{comment}{/* |y| is huge */}
228     \textcolor{keywordflow}{if}(iy>0x41e00000) \{ \textcolor{comment}{/* if |y| > 2**31 */}
229         \textcolor{keywordflow}{if}(iy>0x43f00000) \{ \textcolor{comment}{/* if |y| > 2**64, must o/uflow */}
230             \textcolor{keywordflow}{if}(ix<=0x3fefffff) \textcolor{keywordflow}{return} (hy<0)? \hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}:\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}*\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
231             \textcolor{keywordflow}{if}(ix>=0x3ff00000) \textcolor{keywordflow}{return} (hy>0)? \hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}:tiny*\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
232         \}
233         \textcolor{comment}{/* over/underflow if x is not close to one */}
234         \textcolor{keywordflow}{if}(ix<0x3fefffff) \textcolor{keywordflow}{return} (hy<0)? s*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}:s*tiny*\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
235         \textcolor{keywordflow}{if}(ix>0x3ff00000) \textcolor{keywordflow}{return} (hy>0)? s*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}:s*tiny*\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
236         \textcolor{comment}{/* now |1-x| is tiny <= 2**-20, suffice to compute}
237 \textcolor{comment}{           log(x) by x-x^2/2+x^3/3-x^4/4 */}
238         t = ax-\hyperlink{pow_8c_ada85e349d35971b32c8ea4238881ff8b}{one};      \textcolor{comment}{/* t has 20 trailing zeros */}
239         w = (t*t)*(0.5-t*(0.3333333333333333333333-t*0.25));
240         u = \hyperlink{pow_8c_a6880e0fe9bc35dca451a1d14b9152415}{ivln2\_h}*t;   \textcolor{comment}{/* ivln2\_h has 21 sig. bits */}
241         v = t*\hyperlink{pow_8c_acae36ab3d417386d94f854d6d2d1ee31}{ivln2\_l}-w*\hyperlink{pow_8c_a41ff67db971b4959670ff5b75dcc166b}{ivln2};
242         t1 = u+v;
243         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t1,0);
244         t2 = v-(t1-u);
245     \} \textcolor{keywordflow}{else} \{
246         \textcolor{keywordtype}{double} ss,s2,s\_h,s\_l,t\_h,t\_l;
247         n = 0;
248         \textcolor{comment}{/* take care subnormal number */}
249         \textcolor{keywordflow}{if}(ix<0x00100000)
250         \{
251             ax *= \hyperlink{pow_8c_a8b3d2ebfb37d2c044b3e1f133b1537cd}{two53};
252             n -= 53;
253             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix,ax);
254         \}
255         n  += ((ix)>>20)-0x3ff;
256         j  = ix&0x000fffff;
257         \textcolor{comment}{/* determine interval */}
258         ix = j|0x3ff00000;      \textcolor{comment}{/* normalize ix */}
259         \textcolor{keywordflow}{if}(j<=0x3988E) k=0;     \textcolor{comment}{/* |x|<sqrt(3/2) */}
260         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(j<0xBB67A) k=1; \textcolor{comment}{/* |x|<sqrt(3)   */}
261         \textcolor{keywordflow}{else} \{
262             k=0;
263             n+=1;
264             ix -= 0x00100000;
265         \}
266         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(ax,ix);
267 
268         \textcolor{comment}{/* compute ss = s\_h+s\_l = (x-1)/(x+1) or (x-1.5)/(x+1.5) */}
269         u = ax-\hyperlink{pow_8c_a9ec7bdbb3a01ff705aaeb8819fdf9cfa}{bp}[k];     \textcolor{comment}{/* bp[0]=1.0, bp[1]=1.5 */}
270         v = one/(ax+bp[k]);
271         ss = u*v;
272         s\_h = ss;
273         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(s\_h,0);
274         \textcolor{comment}{/* t\_h=ax+bp[k] High */}
275         t\_h = \hyperlink{pow_8c_a554f7b66b1ba49443447eb746978c268}{zero};
276         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t\_h,((ix>>1)|0x20000000)+0x00080000+(k<<18));
277         t\_l = ax - (t\_h-bp[k]);
278         s\_l = v*((u-s\_h*t\_h)-s\_h*t\_l);
279         \textcolor{comment}{/* compute log(ax) */}
280         s2 = ss*ss;
281         r = s2*s2*(\hyperlink{pow_8c_a906e2b4ba15be0d69c6c15fbb79c9d17}{L1}+s2*(\hyperlink{pow_8c_a11e7daa2934ee96d1430c2ac6df68f2a}{L2}+s2*(\hyperlink{pow_8c_a352b4d77596258cf647e71a74dfbcfb6}{L3}+s2*(\hyperlink{pow_8c_a5e8b11c10141df1888afa0d09e6ebafa}{L4}+s2*(\hyperlink{pow_8c_ab38b66779c8f7671692724fc59abe942}{L5}+s2*\hyperlink{pow_8c_ab144a2b09d7235c795d751025442704f}{L6})))));
282         r += s\_l*(s\_h+ss);
283         s2  = s\_h*s\_h;
284         t\_h = 3.0+s2+r;
285         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t\_h,0);
286         t\_l = r-((t\_h-3.0)-s2);
287         \textcolor{comment}{/* u+v = ss*(1+...) */}
288         u = s\_h*t\_h;
289         v = s\_l*t\_h+t\_l*ss;
290         \textcolor{comment}{/* 2/(3log2)*(ss+...) */}
291         p\_h = u+v;
292         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(p\_h,0);
293         p\_l = v-(p\_h-u);
294         z\_h = \hyperlink{pow_8c_a10067ed5ff37a14725c27ac8d7666470}{cp\_h}*p\_h;     \textcolor{comment}{/* cp\_h+cp\_l = 2/(3*log2) */}
295         z\_l = \hyperlink{pow_8c_ab67ffef1e57cfd503a90ca8d988b07fe}{cp\_l}*p\_h+p\_l*\hyperlink{pow_8c_a3d95d7052117de6cb188a562c9e80e1f}{cp}+\hyperlink{pow_8c_ad69e225436b9621c5b4638a33cdb5b06}{dp\_l}[k];
296         \textcolor{comment}{/* log2(ax) = (ss+..)*2/(3*log2) = n + dp\_h + z\_h + z\_l */}
297         t = (double)n;
298         t1 = (((z\_h+z\_l)+\hyperlink{pow_8c_a4d2b7a191a77a5d01399f9fd1778f0b5}{dp\_h}[k])+t);
299         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t1,0);
300         t2 = z\_l-(((t1-t)-\hyperlink{pow_8c_a4d2b7a191a77a5d01399f9fd1778f0b5}{dp\_h}[k])-z\_h);
301     \}
302 
303     \textcolor{comment}{/* split up y into y1+y2 and compute (y1+y2)*(t1+t2) */}
304     y1  = y;
305     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(y1,0);
306     p\_l = (y-y1)*t1+y*t2;
307     p\_h = y1*t1;
308     z = p\_l+p\_h;
309     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(j,i,z);
310     \textcolor{keywordflow}{if} (j>=0x40900000) \{                \textcolor{comment}{/* z >= 1024 */}
311         \textcolor{keywordflow}{if}(((j-0x40900000)|i)!=0)           \textcolor{comment}{/* if z > 1024 */}
312             \textcolor{keywordflow}{return} s*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge};         \textcolor{comment}{/* overflow */}
313         \textcolor{keywordflow}{else} \{
314             \textcolor{keywordflow}{if}(p\_l+\hyperlink{pow_8c_a39e5a6fb924096b69307b75766789bed}{ovt}>z-p\_h) \textcolor{keywordflow}{return} s*huge*\hyperlink{pow_8c_acbd466133274923cc0785707fbdeea9a}{huge};    \textcolor{comment}{/* overflow */}
315         \}
316     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}((j&0x7fffffff)>=0x4090cc00 ) \{    \textcolor{comment}{/* z <= -1075 */}
317         \textcolor{keywordflow}{if}(((j-0xc090cc00)|i)!=0)       \textcolor{comment}{/* z < -1075 */}
318             \textcolor{keywordflow}{return} s*tiny*\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};     \textcolor{comment}{/* underflow */}
319         \textcolor{keywordflow}{else} \{
320             \textcolor{keywordflow}{if}(p\_l<=z-p\_h) \textcolor{keywordflow}{return} s*tiny*\hyperlink{pow_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};  \textcolor{comment}{/* underflow */}
321         \}
322     \}
323     \textcolor{comment}{/*}
324 \textcolor{comment}{     * compute 2**(p\_h+p\_l)}
325 \textcolor{comment}{     */}
326     i = j&0x7fffffff;
327     k = (i>>20)-0x3ff;
328     n = 0;
329     \textcolor{keywordflow}{if}(i>0x3fe00000) \{      \textcolor{comment}{/* if |z| > 0.5, set n = [z+0.5] */}
330         n = j+(0x00100000>>(k+1));
331         k = ((n&0x7fffffff)>>20)-0x3ff; \textcolor{comment}{/* new k for n */}
332         t = \hyperlink{pow_8c_a554f7b66b1ba49443447eb746978c268}{zero};
333         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(t,(n&~(0x000fffff>>k)));
334         n = ((n&0x000fffff)|0x00100000)>>(20-k);
335         \textcolor{keywordflow}{if}(j<0) n = -n;
336         p\_h -= t;
337     \}
338     t = p\_l+p\_h;
339     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(t,0);
340     u = t*\hyperlink{pow_8c_a0e921017a3ec6bd51a2c3b0760003359}{lg2\_h};
341     v = (p\_l-(t-p\_h))*\hyperlink{pow_8c_af9a959de40ccd0243fecd6ade9703874}{lg2}+t*\hyperlink{pow_8c_abada47ce3b9b4ec143fa868e4b4cce6f}{lg2\_l};
342     z = u+v;
343     w = v-(z-u);
344     t  = z*z;
345     t1  = z - t*(\hyperlink{pow_8c_a5c2e2e6dd711ceae83536551926d6dd3}{P1}+t*(\hyperlink{pow_8c_acddba71b086f9e3c2b621baef51e45ac}{P2}+t*(\hyperlink{pow_8c_ab48f05f97efef9ea9f554c91a980520a}{P3}+t*(\hyperlink{pow_8c_af783f4afa9878be962b9904dc22e8bab}{P4}+t*\hyperlink{pow_8c_afdc64323c3afde906f161bdf28e5e319}{P5}))));
346     r  = (z*t1)/(t1-\hyperlink{pow_8c_a45c15ebfa63fa10683ebce401df0b836}{two})-(w+z*w);
347     z  = one-(r-z);
348     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(j,z);
349     j += (n<<20);
350     \textcolor{keywordflow}{if}((j>>20)<=0) z = \hyperlink{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{scalbn}(z,n);   \textcolor{comment}{/* subnormal output */}
351     \textcolor{keywordflow}{else}
352     \{
353         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hz;
354         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hz,z);
355         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(z,hz + (n<<20));
356     \}
357     \textcolor{keywordflow}{return} s*z;
358 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{math_8h_aa56c9494c95edf68386375e97d64159b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_aa56c9494c95edf68386375e97d64159b_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!rempio2@{rempio2}}
\index{rempio2@{rempio2}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{rempio2(double x, double $\ast$y)}{rempio2(double x, double *y)}}]{\setlength{\rightskip}{0pt plus 5cm}int rempio2 (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double $\ast$}]{y}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a320ce87737d621d713124124e2c02cdc}{}\label{math_8h_a320ce87737d621d713124124e2c02cdc}


Definition at line 103 of file remp2.\+c.



References \+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2(), half, invpio2, npio2\+\_\+hw, pio2\+\_\+1, pio2\+\_\+1t, pio2\+\_\+2, pio2\+\_\+2t, pio2\+\_\+3, pio2\+\_\+3t, two24, two\+\_\+over\+\_\+pi, and zero.



Referenced by cos(), sin(), and tan().


\begin{DoxyCode}
104 \{
105     \textcolor{keywordtype}{double} z = 0.,w,t,r,fn;
106     \textcolor{keywordtype}{double} tx[3];
107     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} i,j,n,ix,hx;
108     \textcolor{keywordtype}{int} e0,nx;
109     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} low;
110 
111     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);       \textcolor{comment}{/* high word of x */}
112     ix = hx&0x7fffffff;
113     \textcolor{keywordflow}{if}(ix<=0x3fe921fb)   \textcolor{comment}{/* |x| ~<= pi/4 , no need for reduction */}
114     \{
115         y[0] = x;
116         y[1] = 0;
117         \textcolor{keywordflow}{return} 0;
118     \}
119     \textcolor{keywordflow}{if}(ix<0x4002d97c) \{  \textcolor{comment}{/* |x| < 3pi/4, special case with n=+-1 */}
120         \textcolor{keywordflow}{if}(hx>0) \{
121             z = x - \hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\_1};
122             \textcolor{keywordflow}{if}(ix!=0x3ff921fb) \{    \textcolor{comment}{/* 33+53 bit pi is good enough */}
123                 y[0] = z - \hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\_1t};
124                 y[1] = (z-y[0])-pio2\_1t;
125             \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* near pi/2, use 33+33+53 bit pi */}
126                 z -= \hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\_2};
127                 y[0] = z - \hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\_2t};
128                 y[1] = (z-y[0])-pio2\_2t;
129             \}
130             \textcolor{keywordflow}{return} 1;
131         \} \textcolor{keywordflow}{else} \{    \textcolor{comment}{/* negative x */}
132             z = x + \hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\_1};
133             \textcolor{keywordflow}{if}(ix!=0x3ff921fb) \{    \textcolor{comment}{/* 33+53 bit pi is good enough */}
134                 y[0] = z + \hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\_1t};
135                 y[1] = (z-y[0])+pio2\_1t;
136             \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* near pi/2, use 33+33+53 bit pi */}
137                 z += \hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\_2};
138                 y[0] = z + \hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\_2t};
139                 y[1] = (z-y[0])+pio2\_2t;
140             \}
141             \textcolor{keywordflow}{return} -1;
142         \}
143     \}
144     \textcolor{keywordflow}{if}(ix<=0x413921fb) \{ \textcolor{comment}{/* |x| ~<= 2^19*(pi/2), medium size */}
145         t  = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
146         n  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}) (t*\hyperlink{remp2_8c_a03a134e339c548e26c774634bfe71100}{invpio2}+\hyperlink{remp2_8c_a701d1f7de8380226dbc8825672ae4ef0}{half});
147         fn = (double)n;
148         r  = t-fn*\hyperlink{remp2_8c_aaf958c4a660a2fd7a8750084094419bc}{pio2\_1};
149         w  = fn*\hyperlink{remp2_8c_a4468c42fbee30f934c91ae8d6c5cc90e}{pio2\_1t}; \textcolor{comment}{/* 1st round good to 85 bit */}
150         \textcolor{keywordflow}{if}(n<32&&ix!=\hyperlink{remp2_8c_ab03299565b9ed58c920072d909fad477}{npio2\_hw}[n-1]) \{
151             y[0] = r-w; \textcolor{comment}{/* quick check no cancellation */}
152         \} \textcolor{keywordflow}{else} \{
153             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} high;
154 
155             j  = ix>>20;
156             y[0] = r-w;
157             \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(high, y[0]);
158             i = j-((high>>20)&0x7ff);
159             \textcolor{keywordflow}{if}(i>16) \{  \textcolor{comment}{/* 2nd iteration needed, good to 118 */}
160                 t  = r;
161                 w  = fn*\hyperlink{remp2_8c_af6aea39973983ce1f6314f9158ac885d}{pio2\_2};
162                 r  = t-w;
163                 w  = fn*\hyperlink{remp2_8c_a59bed798e158756e8dca5cee80699280}{pio2\_2t}-((t-r)-w);
164                 y[0] = r-w;
165                 \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(high,y[0]);
166                 i = j-((high>>20)&0x7ff);
167                 \textcolor{keywordflow}{if}(i>49)  \{ \textcolor{comment}{/* 3rd iteration need, 151 bits acc */}
168                     t  = r; \textcolor{comment}{/* will cover all possible cases */}
169                     w  = fn*\hyperlink{remp2_8c_ae1934d5e01d08b4f35c23aae592201a9}{pio2\_3};
170                     r  = t-w;
171                     w  = fn*\hyperlink{remp2_8c_a72f07a944e6e926d3de11a6623b7be39}{pio2\_3t}-((t-r)-w);
172                     y[0] = r-w;
173                 \}
174             \}
175         \}
176         y[1] = (r-y[0])-w;
177         \textcolor{keywordflow}{if}(hx<0)    \{
178             y[0] = -y[0];
179             y[1] = -y[1];
180             \textcolor{keywordflow}{return} -n;
181         \}
182         \textcolor{keywordflow}{else}     \textcolor{keywordflow}{return} n;
183     \}
184     \textcolor{comment}{/*}
185 \textcolor{comment}{     * all other (large) arguments}
186 \textcolor{comment}{     */}
187     \textcolor{keywordflow}{if}(ix>=0x7ff00000) \{        \textcolor{comment}{/* x is inf or NaN */}
188         y[0]=y[1]=x-x;
189         \textcolor{keywordflow}{return} 0;
190     \}
191     \textcolor{comment}{/* set z = scalbn(|x|,ilogb(x)-23) */}
192     \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(low,x);
193     \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(z,low);
194     e0  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(ix>>20)-1046;    \textcolor{comment}{/* e0 = ilogb(z)-23; */}
195     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(z,ix - (e0<<20));
196     \textcolor{keywordflow}{for}(i=0; i<2; i++) \{
197         tx[i] = (double)((\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(z));
198         z     = (z-tx[i])*\hyperlink{remp2_8c_a578df73908b4f4182b101d31c7675202}{two24};
199     \}
200     tx[2] = z;
201     nx = 3;
202     \textcolor{keywordflow}{while}(tx[nx-1]==\hyperlink{remp2_8c_a554f7b66b1ba49443447eb746978c268}{zero}) nx--; \textcolor{comment}{/* skip zero term */}
203     n  =  \hyperlink{real_2prim_8h_a8a5e87d33974881295c4ed0d09732f71}{\_\_kernel\_rem\_pio2}(tx,y,e0,nx,2,\hyperlink{remp2_8c_a3f7524a732d3106dbceeddace65a9f28}{two\_over\_pi});
204     \textcolor{keywordflow}{if}(hx<0) \{
205         y[0] = -y[0];
206         y[1] = -y[1];
207         \textcolor{keywordflow}{return} -n;
208     \}
209     \textcolor{keywordflow}{return} n;
210 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{math_8h_a320ce87737d621d713124124e2c02cdc_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a320ce87737d621d713124124e2c02cdc_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!round@{round}}
\index{round@{round}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{round(double x)}{round(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double round (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a7df19cf730447c00150569250a4b5e1d}{}\label{math_8h_a7df19cf730447c00150569250a4b5e1d}


Definition at line 30 of file round.\+c.



Referenced by cround(), Decimal\+System\+::\+Get\+Real\+Text(), Positional\+Numeral\+System\+::\+Get\+Text(), and Real\+Number\+::\+Round().


\begin{DoxyCode}
31 \{
32     \textcolor{keywordflow}{return} x > 0.0 ? \hyperlink{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}{floor}(x + 0.5) : \hyperlink{math_8h_a1ea6d7b591132268abc2e843ababd084}{ceil}(x - 0.5);
33 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a7df19cf730447c00150569250a4b5e1d_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!scalbn@{scalbn}}
\index{scalbn@{scalbn}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{scalbn(double x, int n)}{scalbn(double x, int n)}}]{\setlength{\rightskip}{0pt plus 5cm}double scalbn (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{int}]{n}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}{}\label{math_8h_a0353978ec1ae247f2d95f2dc75856ed6}


Definition at line 60 of file scalbn.\+c.



References huge, tiny, two54, and twom54.



Referenced by \+\_\+\+\_\+kernel\+\_\+rem\+\_\+pio2(), and pow().


\begin{DoxyCode}
61 \{
62     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}  k,hx,lx;
63     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
64     k = (hx&0x7ff00000)>>20;        \textcolor{comment}{/* extract exponent */}
65     \textcolor{keywordflow}{if} (k==0) \{             \textcolor{comment}{/* 0 or subnormal x */}
66         \textcolor{keywordflow}{if} ((lx|(hx&0x7fffffff))==0) \textcolor{keywordflow}{return} x; \textcolor{comment}{/* +-0 */}
67         x *= \hyperlink{scalbn_8c_a38da01c416294eaf7ebdae8ba3afe2e0}{two54};
68         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
69         k = ((hx&0x7ff00000)>>20) - 54;
70         \textcolor{keywordflow}{if} (n< -50000) \textcolor{keywordflow}{return} \hyperlink{scalbn_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}*x;   \textcolor{comment}{/*underflow*/}
71     \}
72     \textcolor{keywordflow}{if} (k==0x7ff) \textcolor{keywordflow}{return} x+x;       \textcolor{comment}{/* NaN or Inf */}
73     k = k+n;
74     \textcolor{keywordflow}{if} (k >  0x7fe) \textcolor{keywordflow}{return} \hyperlink{scalbn_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{math_8h_ad8d1296592a3e783acdd0de21ff58e2e}{copysign}(\hyperlink{scalbn_8c_acbd466133274923cc0785707fbdeea9a}{huge},x); \textcolor{comment}{/* overflow  */}
75     \textcolor{keywordflow}{if} (k > 0)              \textcolor{comment}{/* normal result */}
76     \{
77         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x,(hx&0x800fffff)|(k<<20));
78         \textcolor{keywordflow}{return} x;
79     \}
80     \textcolor{keywordflow}{if} (k <= -54) \{
81         \textcolor{keywordflow}{if} (n > 50000)      \textcolor{comment}{/* in case integer overflow in n+k */}
82             \textcolor{keywordflow}{return} \hyperlink{scalbn_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{math_8h_ad8d1296592a3e783acdd0de21ff58e2e}{copysign}(\hyperlink{scalbn_8c_acbd466133274923cc0785707fbdeea9a}{huge},x);   \textcolor{comment}{/*overflow*/}
83         \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \hyperlink{scalbn_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}*\hyperlink{math_8h_ad8d1296592a3e783acdd0de21ff58e2e}{copysign}(\hyperlink{scalbn_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny},x);  \textcolor{comment}{/*underflow*/}
84     \}
85     k += 54;                \textcolor{comment}{/* subnormal result */}
86     \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(x,(hx&0x800fffff)|(k<<20));
87     \textcolor{keywordflow}{return} x*\hyperlink{scalbn_8c_ac941f00c94834d7be49faedc1a4ed033}{twom54};
88 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a0353978ec1ae247f2d95f2dc75856ed6_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!sin@{sin}}
\index{sin@{sin}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{sin(double x)}{sin(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double sin (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_aad4af25633b071b0e2cdb8ebd87eca77}{}\label{math_8h_aad4af25633b071b0e2cdb8ebd87eca77}


Trigonometric sine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return sine function of x.\end{DoxyPre}



\begin{DoxyPre}kernel function:
 \_\_kernel\_sin       ... sine function on [-pi/4,pi/4]
 \_\_kernel\_cos       ... cose function on [-pi/4,pi/4]
 \_\_ieee754\_rem\_pio2 ... argument reduction routine\end{DoxyPre}



\begin{DoxyPre}Method.
     Let S,C and T denote the sin, cos and tan respectively on
 [-PI/4, +PI/4]. Reduce the argument x to y1+y2 = x-k*pi/2
 in [-pi/4 , +pi/4], and let n = k mod 4.
 We have\end{DoxyPre}



\begin{DoxyPre}         n        sin(x)      cos(x)        tan(x)
    ----------------------------------------------------------
     0         S       C         T
     1         C      -S        -1/T
     2        -S      -C         T
     3        -C       S        -1/T
    ----------------------------------------------------------\end{DoxyPre}



\begin{DoxyPre}Special cases:
     Let trig be any of sin, cos, or tan.
     trig(+-INF)  is NaN, with signals;
     trig(NaN)    is that NaN;\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 TRIG(x) returns trig(x) nearly rounded
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 87 of file sin.\+c.



References \+\_\+\+\_\+kernel\+\_\+cos(), \+\_\+\+\_\+kernel\+\_\+sin(), and rempio2().



Referenced by ccos(), ccosh(), ccot(), ccoth(), ccsc(), ccsch(), cexp(), Real\+Number\+::\+Cosecant(), cpow(), csec(), csech(), csin(), csinh(), ctan(), ctanh(), and Real\+Number\+::\+Sine().


\begin{DoxyCode}
88 \{
89     \textcolor{keywordtype}{double} y[2],z=0.0;
90     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} n, ix;
91 
92     \textcolor{comment}{/* High word of x. */}
93     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix,x);
94 
95     \textcolor{comment}{/* |x| ~< pi/4 */}
96     ix &= 0x7fffffff;
97     \textcolor{keywordflow}{if}(ix <= 0x3fe921fb) \textcolor{keywordflow}{return} \hyperlink{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{\_\_kernel\_sin}(x,z,0);
98 
99     \textcolor{comment}{/* sin(Inf or NaN) is NaN */}
100     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix>=0x7ff00000) \textcolor{keywordflow}{return} x-x;
101 
102     \textcolor{comment}{/* argument reduction needed */}
103     \textcolor{keywordflow}{else} \{
104         n = \hyperlink{math_8h_a320ce87737d621d713124124e2c02cdc}{rempio2}(x,y);
105         \textcolor{keywordflow}{switch}(n&3) \{
106         \textcolor{keywordflow}{case} 0:
107             \textcolor{keywordflow}{return}  \hyperlink{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{\_\_kernel\_sin}(y[0],y[1],1);
108         \textcolor{keywordflow}{case} 1:
109             \textcolor{keywordflow}{return}  \hyperlink{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\_\_kernel\_cos}(y[0],y[1]);
110         \textcolor{keywordflow}{case} 2:
111             \textcolor{keywordflow}{return} -\hyperlink{real_2prim_8h_adcc3cb89edf47f34f1e8058e198be293}{\_\_kernel\_sin}(y[0],y[1],1);
112         \textcolor{keywordflow}{default}:
113             \textcolor{keywordflow}{return} -\hyperlink{real_2prim_8h_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\_\_kernel\_cos}(y[0],y[1]);
114         \}
115     \}
116 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_aad4af25633b071b0e2cdb8ebd87eca77_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_aad4af25633b071b0e2cdb8ebd87eca77_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!sinh@{sinh}}
\index{sinh@{sinh}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{sinh(double x)}{sinh(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double sinh (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a862012e970c977c482507064e2793b45}{}\label{math_8h_a862012e970c977c482507064e2793b45}


Hyperbolic sine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
mathematically sinh(x) if defined to be (exp(x)-exp(-x))/2
 1. Replace x by |x| (sinh(-x) = -sinh(x)).
 2.
                                        E + E/(E+1)
     0        <= x <= 22     :  sinh(x) := --------------, E=expm1(x)
                                2\end{DoxyPre}



\begin{DoxyPre}     22       <= x <= lnovft :  sinh(x) := exp(x)/2
     lnovft   <= x <= ln2ovft:  sinh(x) := exp(x/2)/2 * exp(x/2)
     ln2ovft  <  x      :  sinh(x) := x*shuge (overflow)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 sinh(x) is |x| if x is +INF, -INF, or NaN.
 only sinh(0)=0 is exact for finite x.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 81 of file sinh.\+c.



References exp(), expm1(), one, and shuge.



Referenced by cchsh(), ccot(), ccoth(), ccsc(), ccsch(), csec(), csech(), ctan(), ctanh(), Real\+Number\+::\+Hyp\+Cosecant(), and Real\+Number\+::\+Hyp\+Sine().


\begin{DoxyCode}
82 \{
83     \textcolor{keywordtype}{double} t,w,h;
84     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix,jx;
85     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
86 
87     \textcolor{comment}{/* High word of |x|. */}
88     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(jx,x);
89     ix = jx&0x7fffffff;
90 
91     \textcolor{comment}{/* x is INF or NaN */}
92     \textcolor{keywordflow}{if}(ix>=0x7ff00000) \textcolor{keywordflow}{return} x+x;
93 
94     h = 0.5;
95     \textcolor{keywordflow}{if} (jx<0) h = -h;
96     \textcolor{comment}{/* |x| in [0,22], return sign(x)*0.5*(E+E/(E+1))) */}
97     \textcolor{keywordflow}{if} (ix < 0x40360000) \{      \textcolor{comment}{/* |x|<22 */}
98         \textcolor{keywordflow}{if} (ix<0x3e300000)      \textcolor{comment}{/* |x|<2**-28 */}
99             \textcolor{keywordflow}{if}(\hyperlink{sinh_8c_a3e8bac3f1312bfd07002d1940f9b89a4}{shuge}+x>\hyperlink{sinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \textcolor{keywordflow}{return} x;\textcolor{comment}{/* sinh(tiny) = tiny with inexact */}
100         t = \hyperlink{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}{expm1}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
101         \textcolor{keywordflow}{if}(ix<0x3ff00000) \textcolor{keywordflow}{return} h*(2.0*t-t*t/(t+\hyperlink{sinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}));
102         \textcolor{keywordflow}{return} h*(t+t/(t+\hyperlink{sinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}));
103     \}
104 
105     \textcolor{comment}{/* |x| in [22, log(maxdouble)] return 0.5*exp(|x|) */}
106     \textcolor{keywordflow}{if} (ix < 0x40862E42)  \textcolor{keywordflow}{return} h*\hyperlink{math_8h_ae09128febbbe6372cde4fa0c65608a42}{exp}(\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
107 
108     \textcolor{comment}{/* |x| in [log(maxdouble), overflowthresold] */}
109     lx = *( (((*(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword}*)&\hyperlink{sinh_8c_ada85e349d35971b32c8ea4238881ff8b}{one})>>29)) + (\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword}*)&x);
110     \textcolor{keywordflow}{if} (ix<0x408633CE || ((ix==0x408633ce)&&(lx<=(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})0x8fb9f87d))) \{
111         w = \hyperlink{math_8h_ae09128febbbe6372cde4fa0c65608a42}{exp}(0.5*\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
112         t = h*w;
113         \textcolor{keywordflow}{return} t*w;
114     \}
115 
116     \textcolor{comment}{/* |x| > overflowthresold, sinh(x) overflow */}
117     \textcolor{keywordflow}{return} x*\hyperlink{sinh_8c_a3e8bac3f1312bfd07002d1940f9b89a4}{shuge};
118 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{math_8h_a862012e970c977c482507064e2793b45_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a862012e970c977c482507064e2793b45_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!sqrt@{sqrt}}
\index{sqrt@{sqrt}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{sqrt(double x)}{sqrt(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double sqrt (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_ab87521a75ef827a85807f89a6c10629a}{}\label{math_8h_ab87521a75ef827a85807f89a6c10629a}


Square root function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return correctly rounded sqrt.
          ------------------------------------------
      |  Use the hardware sqrt if you have one |
          ------------------------------------------
Method:
  Bit by bit method using integer arithmetic. (Slow, but portable)
  1. Normalization
 Scale x to y in [1,4) with even powers of 2:
 find an integer k such that  1 <= (y=x*2^(2k)) < 4, then
    sqrt(x) = 2^k * sqrt(y)
  2. Bit by bit computation
 Let q  = sqrt(y) truncated to i bit after binary point (q = 1),
      i                          0
                                    i+1         2
     s  = 2*q , and y  =  2   * ( y - q  ).     (1)
      i      i            i                 i\end{DoxyPre}



\begin{DoxyPre} To compute q    from q , one checks whether
        i+1       i\end{DoxyPre}



\begin{DoxyPre}              -(i+1) 2
        (q + 2      ) <= y.         (2)
                  i
                              -(i+1)
 If (2) is false, then q   = q ; otherwise q   = q  + 2      .
               i+1   i             i+1   i\end{DoxyPre}



\begin{DoxyPre} With some algebric manipulation, it is not difficult to see
 that (2) is equivalent to
                            -(i+1)
        s  +  2       <= y          (3)
         i                i\end{DoxyPre}



\begin{DoxyPre} The advantage of (3) is that s  and y  can be computed by
                  i      i
 the following recurrence formula:
     if (3) is false\end{DoxyPre}



\begin{DoxyPre}     s     =  s  ,  y    = y   ;            (4)
      i+1      i         i+1    i\end{DoxyPre}



\begin{DoxyPre}     otherwise,
                        -i                     -(i+1)
     s    =  s  + 2  ,  y    = y  -  s  - 2         (5)
          i+1      i          i+1    i     i\end{DoxyPre}



\begin{DoxyPre} One may easily use induction to prove (4) and (5).
 Note. Since the left hand side of (3) contain only i+2 bits,
       it does not necessary to do a full (53-bit) comparison
       in (3).
  3. Final rounding
 After generating the 53 bits result, we compute one more bit.
 Together with the remainder, we can decide whether the
 result is exact, bigger than 1/2ulp, or less than 1/2ulp
 (it will never equal to 1/2ulp).
 The rounding mode can be detected by checking whether
 huge + tiny is equal to huge, and whether huge - tiny is
 equal to huge for some floating point number "huge" and "tiny".\end{DoxyPre}



\begin{DoxyPre}Special cases:
 sqrt(+-0) = +-0    ... exact
 sqrt(inf) = inf
 sqrt(-ve) = NaN        ... with invalid signal
 sqrt(NaN) = NaN        ... with invalid signal for signaling NaN
\end{DoxyPre}
 Other methods \+: see the squareroot.

\begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 127 of file sqrt.\+c.



References one, and tiny.



Referenced by acos(), acosh(), asin(), asinh(), csqrt(), hypot(), pow(), and Real\+Number\+::\+Square\+Root().


\begin{DoxyCode}
128 \{
129     \textcolor{keywordtype}{double} z;
130     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword}  sign = (int)0x80000000;
131     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} r,t1,s1,ix1,q1;
132     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix0,s0,q,m,t,i;
133 
134     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(ix0,ix1,x);
135 
136     \textcolor{comment}{/* take care of Inf and NaN */}
137     \textcolor{keywordflow}{if}((ix0&0x7ff00000)==0x7ff00000) \{
138         \textcolor{keywordflow}{return} x*x+x;       \textcolor{comment}{/* sqrt(NaN)=NaN, sqrt(+inf)=+inf}
139 \textcolor{comment}{                       sqrt(-inf)=sNaN */}
140     \}
141     \textcolor{comment}{/* take care of zero */}
142     \textcolor{keywordflow}{if}(ix0<=0) \{
143         \textcolor{keywordflow}{if}(((ix0&(~sign))|ix1)==0) \textcolor{keywordflow}{return} x;\textcolor{comment}{/* sqrt(+-0) = +-0 */}
144         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(ix0<0)
145             \textcolor{keywordflow}{return} (x-x)/(x-x);     \textcolor{comment}{/* sqrt(-ve) = sNaN */}
146     \}
147     \textcolor{comment}{/* normalize x */}
148     m = (ix0>>20);
149     \textcolor{keywordflow}{if}(m==0) \{              \textcolor{comment}{/* subnormal x */}
150         \textcolor{keywordflow}{while}(ix0==0) \{
151             m -= 21;
152             ix0 |= (ix1>>11);
153             ix1 <<= 21;
154         \}
155         \textcolor{keywordflow}{for}(i=0; (ix0&0x00100000)==0; i++) ix0<<=1;
156         m -= i-1;
157         ix0 |= (ix1>>(32-i));
158         ix1 <<= i;
159     \}
160     m -= 1023;  \textcolor{comment}{/* unbias exponent */}
161     ix0 = (ix0&0x000fffff)|0x00100000;
162     \textcolor{keywordflow}{if}(m&1) \{   \textcolor{comment}{/* odd m, double x to make it even */}
163         ix0 += ix0 + ((ix1&sign)>>31);
164         ix1 += ix1;
165     \}
166     m >>= 1;    \textcolor{comment}{/* m = [m/2] */}
167 
168     \textcolor{comment}{/* generate sqrt(x) bit by bit */}
169     ix0 += ix0 + ((ix1&sign)>>31);
170     ix1 += ix1;
171     q = q1 = s0 = s1 = 0;   \textcolor{comment}{/* [q,q1] = sqrt(x) */}
172     r = 0x00200000;     \textcolor{comment}{/* r = moving bit from right to left */}
173 
174     \textcolor{keywordflow}{while}(r!=0) \{
175         t = s0+r;
176         \textcolor{keywordflow}{if}(t<=ix0) \{
177             s0   = t+r;
178             ix0 -= t;
179             q   += r;
180         \}
181         ix0 += ix0 + ((ix1&sign)>>31);
182         ix1 += ix1;
183         r>>=1;
184     \}
185 
186     r = sign;
187     \textcolor{keywordflow}{while}(r!=0) \{
188         t1 = s1+r;
189         t  = s0;
190         \textcolor{keywordflow}{if}((t<ix0)||((t==ix0)&&(t1<=ix1))) \{
191             s1  = t1+r;
192             \textcolor{keywordflow}{if}(((t1&sign)==(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})sign)&&(s1&sign)==0) s0 += 1;
193             ix0 -= t;
194             \textcolor{keywordflow}{if} (ix1 < t1) ix0 -= 1;
195             ix1 -= t1;
196             q1  += r;
197         \}
198         ix0 += ix0 + ((ix1&sign)>>31);
199         ix1 += ix1;
200         r>>=1;
201     \}
202 
203     \textcolor{comment}{/* use floating add to find out rounding direction */}
204     \textcolor{keywordflow}{if}((ix0|ix1)!=0) \{
205         z = \hyperlink{sqrt_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-\hyperlink{sqrt_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny}; \textcolor{comment}{/* trigger inexact flag */}
206         \textcolor{keywordflow}{if} (z>=\hyperlink{sqrt_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \{
207             z = \hyperlink{sqrt_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+\hyperlink{sqrt_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};
208             \textcolor{keywordflow}{if} (q1==(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})0xffffffff) \{
209                 q1=0;
210                 q += 1;
211             \}
212             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (z>\hyperlink{sqrt_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \{
213                 \textcolor{keywordflow}{if} (q1==(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})0xfffffffe) q+=1;
214                 q1+=2;
215             \} \textcolor{keywordflow}{else}
216                 q1 += (q1&1);
217         \}
218     \}
219     ix0 = (q>>1)+0x3fe00000;
220     ix1 =  q1>>1;
221     \textcolor{keywordflow}{if} ((q&1)==1) ix1 |= sign;
222     ix0 += (m <<20);
223     \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(z,ix0,ix1);
224     \textcolor{keywordflow}{return} z;
225 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_ab87521a75ef827a85807f89a6c10629a_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!tan@{tan}}
\index{tan@{tan}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{tan(double x)}{tan(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double tan (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_aa48fdfd5eea5f4f9c33496402b9e4039}{}\label{math_8h_aa48fdfd5eea5f4f9c33496402b9e4039}


Trigonometric tangent function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return tangent function of x.\end{DoxyPre}



\begin{DoxyPre}kernel function:
 \_\_kernel\_tan       ... tangent function on [-pi/4,pi/4]
 \_\_rem\_pio2     ... argument reduction routine\end{DoxyPre}



\begin{DoxyPre}Method.
     Let S,C and T denote the sin, cos and tan respectively on
 [-PI/4, +PI/4]. Reduce the argument x to y1+y2 = x-k*pi/2
 in [-pi/4 , +pi/4], and let n = k mod 4.
 We have\end{DoxyPre}



\begin{DoxyPre}         n        sin(x)      cos(x)        tan(x)
    ----------------------------------------------------------
     0         S       C         T
     1         C      -S        -1/T
     2        -S      -C         T
     3        -C       S        -1/T
    ----------------------------------------------------------\end{DoxyPre}



\begin{DoxyPre}Special cases:
     Let trig be any of sin, cos, or tan.
     trig(+-INF)  is NaN, with signals;
     trig(NaN)    is that NaN;\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 TRIG(x) returns trig(x) nearly rounded
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 86 of file tan.\+c.



References \+\_\+\+\_\+kernel\+\_\+tan(), and rempio2().



Referenced by Real\+Number\+::\+Cotangent(), and Real\+Number\+::\+Tangent().


\begin{DoxyCode}
87 \{
88     \textcolor{keywordtype}{double} y[2],z=0.0;
89     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} n, ix;
90 
91     \textcolor{comment}{/* High word of x. */}
92     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix,x);
93 
94     \textcolor{comment}{/* |x| ~< pi/4 */}
95     ix &= 0x7fffffff;
96     \textcolor{keywordflow}{if}(ix <= 0x3fe921fb) \textcolor{keywordflow}{return} \hyperlink{real_2prim_8h_a5f1c9e105e0dbca8a88407dd899043c6}{\_\_kernel\_tan}(x,z,1);
97 
98     \textcolor{comment}{/* tan(Inf or NaN) is NaN */}
99     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ix>=0x7ff00000) \textcolor{keywordflow}{return} x-x;        \textcolor{comment}{/* NaN */}
100 
101     \textcolor{comment}{/* argument reduction needed */}
102     \textcolor{keywordflow}{else} \{
103         n = \hyperlink{math_8h_a320ce87737d621d713124124e2c02cdc}{rempio2}(x,y);
104         \textcolor{keywordflow}{return} \hyperlink{real_2prim_8h_a5f1c9e105e0dbca8a88407dd899043c6}{\_\_kernel\_tan}(y[0],y[1],1-((n&1)<<1)); \textcolor{comment}{/*  1 -- n even}
105 \textcolor{comment}{                            -1 -- n odd */}
106     \}
107 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_aa48fdfd5eea5f4f9c33496402b9e4039_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{math_8h_aa48fdfd5eea5f4f9c33496402b9e4039_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!tanh@{tanh}}
\index{tanh@{tanh}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{tanh(double x)}{tanh(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double tanh (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_af85bcf153d7ae805733927f12329dac1}{}\label{math_8h_af85bcf153d7ae805733927f12329dac1}


Hyperbolic tangent function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Return the Hyperbolic Tangent of x\end{DoxyPre}



\begin{DoxyPre}Method :
                   x    -x
                  e  - e
 0. tanh(x) is defined to be -----------
                   x    -x
                  e  + e
 1. reduce x to non-negative by tanh(-x) = -tanh(x).
 2.  0      <= x <= 2**-55 : tanh(x) := x*(one+x)
                        -t
     2**-55 <  x <=  1     : tanh(x) := -----; t = expm1(-2x)
                       t + 2
                         2
     1      <= x <=  22.0  : tanh(x) := 1-  ----- ; t=expm1(2x)
                       t + 2
     22.0   <  x <= INF    : tanh(x) := 1.\end{DoxyPre}



\begin{DoxyPre}Special cases:
 tanh(NaN) is NaN;
 only tanh(0)=0 is exact for finite argument.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 83 of file tanh.\+c.



References expm1(), one, tiny, and two.



Referenced by Real\+Number\+::\+Hyp\+Cotangent(), and Real\+Number\+::\+Hyp\+Tangent().


\begin{DoxyCode}
84 \{
85     \textcolor{keywordtype}{double} t,z;
86     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} jx,ix;
87 
88     \textcolor{comment}{/* High word of |x|. */}
89     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(jx,x);
90     ix = jx&0x7fffffff;
91 
92     \textcolor{comment}{/* x is INF or NaN */}
93     \textcolor{keywordflow}{if}(ix>=0x7ff00000) \{
94         \textcolor{keywordflow}{if} (jx>=0) \textcolor{keywordflow}{return} \hyperlink{tanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}/x+\hyperlink{tanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one};    \textcolor{comment}{/* tanh(+-inf)=+-1 */}
95         \textcolor{keywordflow}{else}       \textcolor{keywordflow}{return} one/x-\hyperlink{tanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one};    \textcolor{comment}{/* tanh(NaN) = NaN */}
96     \}
97 
98     \textcolor{comment}{/* |x| < 22 */}
99     \textcolor{keywordflow}{if} (ix < 0x40360000) \{      \textcolor{comment}{/* |x|<22 */}
100         \textcolor{keywordflow}{if} (ix<0x3c800000)      \textcolor{comment}{/* |x|<2**-55 */}
101             \textcolor{keywordflow}{return} x*(\hyperlink{tanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+x);        \textcolor{comment}{/* tanh(small) = small */}
102         \textcolor{keywordflow}{if} (ix>=0x3ff00000) \{   \textcolor{comment}{/* |x|>=1  */}
103             t = \hyperlink{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}{expm1}(\hyperlink{tanh_8c_a45c15ebfa63fa10683ebce401df0b836}{two}*\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
104             z = \hyperlink{tanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one} - \hyperlink{tanh_8c_a45c15ebfa63fa10683ebce401df0b836}{two}/(t+\hyperlink{tanh_8c_a45c15ebfa63fa10683ebce401df0b836}{two});
105         \} \textcolor{keywordflow}{else} \{
106             t = \hyperlink{math_8h_ae4963ac40f96d4b1fe8af1b1e90a20bb}{expm1}(-\hyperlink{tanh_8c_a45c15ebfa63fa10683ebce401df0b836}{two}*\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x));
107             z= -t/(t+\hyperlink{tanh_8c_a45c15ebfa63fa10683ebce401df0b836}{two});
108         \}
109         \textcolor{comment}{/* |x| > 22, return +-1 */}
110     \} \textcolor{keywordflow}{else} \{
111         z = \hyperlink{tanh_8c_ada85e349d35971b32c8ea4238881ff8b}{one} - \hyperlink{tanh_8c_a4f41fc56ffc7d06df51b6fbccd8c0846}{tiny};      \textcolor{comment}{/* raised inexact flag */}
112     \}
113     \textcolor{keywordflow}{return} (jx>=0)? z: -z;
114 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=197pt]{math_8h_af85bcf153d7ae805733927f12329dac1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=291pt]{math_8h_af85bcf153d7ae805733927f12329dac1_icgraph}
\end{center}
\end{figure}


\index{math.\+h@{math.\+h}!trunc@{trunc}}
\index{trunc@{trunc}!math.\+h@{math.\+h}}
\subsubsection[{\texorpdfstring{trunc(double x)}{trunc(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double trunc (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{math_8h_a82a151adfde56b28fa8a50355c4f2ff6}{}\label{math_8h_a82a151adfde56b28fa8a50355c4f2ff6}


Definition at line 30 of file trunc.\+c.



Referenced by ctrunc(), Decimal\+System\+::\+Get\+Real\+Text(), Positional\+Numeral\+System\+::\+Get\+Text(), Positional\+Numeral\+System\+::\+Integer\+To\+Buffer(), and Real\+Number\+::\+Trunc().


\begin{DoxyCode}
31 \{
32     \textcolor{keywordflow}{return} x > 0.0 ? \hyperlink{math_8h_a6de60a3e907dcf0bfe3ea8d64f1e8873}{floor}(x) : \hyperlink{math_8h_a1ea6d7b591132268abc2e843ababd084}{ceil}(x);
33 \}
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{math_8h_a82a151adfde56b28fa8a50355c4f2ff6_icgraph}
\end{center}
\end{figure}


