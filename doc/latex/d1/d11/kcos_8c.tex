\hypertarget{kcos_8c}{}\section{lib/real/kcos.c File Reference}
\label{kcos_8c}\index{lib/real/kcos.\+c@{lib/real/kcos.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
Include dependency graph for kcos.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{dd/d75/kcos_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{kcos_8c_a5468a5a3c3d5d5e34e73fac9d6bc0122}{\+\_\+\+\_\+kernel\+\_\+cos} (double x, double y)
\begin{DoxyCompactList}\small\item\em Kernel cos function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one} = 1.\+00000000000000000000e+00
\item 
static const double \hyperlink{kcos_8c_a904dc404907e943cfad5b4e2ec9278b2}{C1} = 4.\+16666666666666019037e-\/02
\item 
static const double \hyperlink{kcos_8c_a63ef11ac7d8fc6f3da5bc06b6a4a323d}{C2} = -\/1.\+38888888888741095749e-\/03
\item 
static const double \hyperlink{kcos_8c_aa4246f6942f2fe095551bdd0f7fa2dfb}{C3} = 2.\+48015872894767294178e-\/05
\item 
static const double \hyperlink{kcos_8c_aee1397eff508394bcf741cc14594caa7}{C4} = -\/2.\+75573143513906633035e-\/07
\item 
static const double \hyperlink{kcos_8c_a5103faeaed3da41dc7c97d92185d5fe8}{C5} = 2.\+08757232129817482790e-\/09
\item 
static const double \hyperlink{kcos_8c_aa28c7916479bad0bf246c357a5b15721}{C6} = -\/1.\+13596475577881948265e-\/11
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{kcos.\+c@{kcos.\+c}!\+\_\+\+\_\+kernel\+\_\+cos@{\+\_\+\+\_\+kernel\+\_\+cos}}
\index{\+\_\+\+\_\+kernel\+\_\+cos@{\+\_\+\+\_\+kernel\+\_\+cos}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+kernel\+\_\+cos(double x, double y)}{__kernel_cos(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double \+\_\+\+\_\+kernel\+\_\+cos (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{kcos_8c_a5468a5a3c3d5d5e34e73fac9d6bc0122}{}\label{kcos_8c_a5468a5a3c3d5d5e34e73fac9d6bc0122}


Kernel cos function. 

\begin{DoxyVersion}{Version}
1.\+4 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
96/03/07
\end{DoxyDate}

\begin{DoxyPre}
Kernel cos function on [-pi/4, pi/4], pi/4 ~ 0.785398164
Input x is assumed to be bounded by ~pi/4 in magnitude.
Input y is the tail of x.\end{DoxyPre}



\begin{DoxyPre}Algorithm
 1. Since cos(-x) = cos(x), we need only to consider positive x.
 2. if x < 2^-27 (hx<0x3e400000 0), return 1 with inexact if x!=0.
 3. cos(x) is approximated by a polynomial of degree 14 on
    [0,pi/4]
                         4            14
        cos(x) ~ 1 - x*x/2 + C1*x + ... + C6*x
    where the Remes error is\end{DoxyPre}



\begin{DoxyPre}    |              2     4     6     8     10    12     14 |     -58
    |cos(x)-(1-.5*x +C1*x +C2*x +C3*x +C4*x +C5*x  +C6*x  )| <= 2
    |                                      |\end{DoxyPre}



\begin{DoxyPre}                   4     6     8     10    12     14
 4. let r = C1*x +C2*x +C3*x +C4*x +C5*x  +C6*x  , then
        cos(x) = 1 - x*x/2 + r
    since cos(x+y) ~ cos(x) - sin(x)*y
          ~ cos(x) - x*y,
    a correction term is necessary in cos(x) and hence
    cos(x+y) = 1 - (x*x/2 - (r - x*y))
    For better accuracy when x > 0.3, let qx = |x|/4 with
    the last 32 bits mask off, and if x > 0.78125, let qx = 0.28125.
    Then
    cos(x+y) = (1-qx) - ((x*x/2-qx) - (r-x*y)).
    Note that 1-qx and (x*x/2-qx) is EXACT here, and the
    magnitude of the latter is at least a quarter of x*x/2,
    thus, reducing the rounding error in the subtraction.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 100 of file kcos.\+c.



References C1, C2, C3, C4, C5, C6, and one.



Referenced by cos(), and sin().


\begin{DoxyCode}
101 \{
102     \textcolor{keywordtype}{double} a,hz,z,r,qx;
103     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} ix;
104     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(ix, x);
105     ix &= 0x7fffffff;   \textcolor{comment}{/* ix = |x|'s high word*/}
106     \textcolor{keywordflow}{if}(ix<0x3e400000) \{         \textcolor{comment}{/* if x < 2**27 */}
107         \textcolor{keywordflow}{if}(((\textcolor{keywordtype}{int})x)==0) \textcolor{keywordflow}{return} \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one};      \textcolor{comment}{/* generate inexact */}
108     \}
109     z  = x*x;
110     r  = z*(\hyperlink{kcos_8c_a904dc404907e943cfad5b4e2ec9278b2}{C1}+z*(\hyperlink{kcos_8c_a63ef11ac7d8fc6f3da5bc06b6a4a323d}{C2}+z*(\hyperlink{kcos_8c_aa4246f6942f2fe095551bdd0f7fa2dfb}{C3}+z*(\hyperlink{kcos_8c_aee1397eff508394bcf741cc14594caa7}{C4}+z*(\hyperlink{kcos_8c_a5103faeaed3da41dc7c97d92185d5fe8}{C5}+z*\hyperlink{kcos_8c_aa28c7916479bad0bf246c357a5b15721}{C6})))));
111     \textcolor{keywordflow}{if}(ix < 0x3FD33333)             \textcolor{comment}{/* if |x| < 0.3 */}
112         \textcolor{keywordflow}{return} \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one} - (0.5*z - (z*r - x*y));
113     \textcolor{keywordflow}{else} \{
114         \textcolor{keywordflow}{if}(ix > 0x3fe90000) \{       \textcolor{comment}{/* x > 0.78125 */}
115             qx = 0.28125;
116         \} \textcolor{keywordflow}{else} \{
117             \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(qx,ix-0x00200000,0);
118         \}
119         hz = 0.5*z-qx;
120         a  = \hyperlink{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-qx;
121         \textcolor{keywordflow}{return} a - (hz - (z*r-x*y));
122     \}
123 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/d11/kcos_8c_a5468a5a3c3d5d5e34e73fac9d6bc0122_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{kcos.\+c@{kcos.\+c}!C1@{C1}}
\index{C1@{C1}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{C1}{C1}}]{\setlength{\rightskip}{0pt plus 5cm}const double C1 = 4.\+16666666666666019037e-\/02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_a904dc404907e943cfad5b4e2ec9278b2}{}\label{kcos_8c_a904dc404907e943cfad5b4e2ec9278b2}


Definition at line 48 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

\index{kcos.\+c@{kcos.\+c}!C2@{C2}}
\index{C2@{C2}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{C2}{C2}}]{\setlength{\rightskip}{0pt plus 5cm}const double C2 = -\/1.\+38888888888741095749e-\/03\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_a63ef11ac7d8fc6f3da5bc06b6a4a323d}{}\label{kcos_8c_a63ef11ac7d8fc6f3da5bc06b6a4a323d}


Definition at line 49 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

\index{kcos.\+c@{kcos.\+c}!C3@{C3}}
\index{C3@{C3}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{C3}{C3}}]{\setlength{\rightskip}{0pt plus 5cm}const double C3 = 2.\+48015872894767294178e-\/05\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_aa4246f6942f2fe095551bdd0f7fa2dfb}{}\label{kcos_8c_aa4246f6942f2fe095551bdd0f7fa2dfb}


Definition at line 50 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

\index{kcos.\+c@{kcos.\+c}!C4@{C4}}
\index{C4@{C4}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{C4}{C4}}]{\setlength{\rightskip}{0pt plus 5cm}const double C4 = -\/2.\+75573143513906633035e-\/07\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_aee1397eff508394bcf741cc14594caa7}{}\label{kcos_8c_aee1397eff508394bcf741cc14594caa7}


Definition at line 51 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

\index{kcos.\+c@{kcos.\+c}!C5@{C5}}
\index{C5@{C5}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{C5}{C5}}]{\setlength{\rightskip}{0pt plus 5cm}const double C5 = 2.\+08757232129817482790e-\/09\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_a5103faeaed3da41dc7c97d92185d5fe8}{}\label{kcos_8c_a5103faeaed3da41dc7c97d92185d5fe8}


Definition at line 52 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

\index{kcos.\+c@{kcos.\+c}!C6@{C6}}
\index{C6@{C6}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{C6}{C6}}]{\setlength{\rightskip}{0pt plus 5cm}const double C6 = -\/1.\+13596475577881948265e-\/11\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_aa28c7916479bad0bf246c357a5b15721}{}\label{kcos_8c_aa28c7916479bad0bf246c357a5b15721}


Definition at line 53 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

\index{kcos.\+c@{kcos.\+c}!one@{one}}
\index{one@{one}!kcos.\+c@{kcos.\+c}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}const double one = 1.\+00000000000000000000e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}{}\label{kcos_8c_ada85e349d35971b32c8ea4238881ff8b}


Definition at line 47 of file kcos.\+c.



Referenced by \+\_\+\+\_\+kernel\+\_\+cos().

