\hypertarget{acos_8c}{}\section{lib/real/acos.c File Reference}
\label{acos_8c}\index{lib/real/acos.\+c@{lib/real/acos.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
Include dependency graph for acos.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{acos_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{acos_8c_ae93afe22ff34c79ee97ea3eaf77557db}{acos} (double x)
\begin{DoxyCompactList}\small\item\em Inverse trigonometric cosine function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one} = 1.\+00000000000000000000e+00
\item 
static const double \hyperlink{acos_8c_a43016d873124d39034edb8cd164794db}{pi} = 3.\+14159265358979311600e+00
\item 
static const double \hyperlink{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\+\_\+hi} = 1.\+57079632679489655800e+00
\item 
static const double \hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\+\_\+lo} = 6.\+12323399573676603587e-\/17
\item 
static const double \hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{p\+S0} = 1.\+66666666666666657415e-\/01
\item 
static const double \hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{p\+S1} = -\/3.\+25565818622400915405e-\/01
\item 
static const double \hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{p\+S2} = 2.\+01212532134862925881e-\/01
\item 
static const double \hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{p\+S3} = -\/4.\+00555345006794114027e-\/02
\item 
static const double \hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{p\+S4} = 7.\+91534994289814532176e-\/04
\item 
static const double \hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{p\+S5} = 3.\+47933107596021167570e-\/05
\item 
static const double \hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{q\+S1} = -\/2.\+40339491173441421878e+00
\item 
static const double \hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{q\+S2} = 2.\+02094576023350569471e+00
\item 
static const double \hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{q\+S3} = -\/6.\+88283971605453293030e-\/01
\item 
static const double \hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{q\+S4} = 7.\+70381505559019352791e-\/02
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{acos.\+c@{acos.\+c}!acos@{acos}}
\index{acos@{acos}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{acos(double x)}{acos(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double acos (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{acos_8c_ae93afe22ff34c79ee97ea3eaf77557db}{}\label{acos_8c_ae93afe22ff34c79ee97ea3eaf77557db}


Inverse trigonometric cosine function. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}

\begin{DoxyPre}
Method :
 acos(x)  = pi/2 - asin(x)
 acos(-x) = pi/2 + asin(x)
For |x|<=0.5
 acos(x) = pi/2 - (x + x*x^2*R(x^2))    (see \hyperlink{asin_8c}{asin.c})
For x>0.5
    acos(x) = pi/2 - (pi/2 - 2asin(sqrt((1-x)/2)))
    = 2asin(sqrt((1-x)/2))
    = 2s + 2s*z*R(z)    ...z=(1-x)/2, s=sqrt(z)
    = 2f + (2c + 2s*z*R(z))
    where f=hi part of s, and c = (z-f*f)/(s+f) is the correction term
    for f so that f+c ~ sqrt(z).
For x<-0.5
 acos(x) = pi - 2asin(sqrt((1-|x|)/2))
    = pi - 0.5*(s+s*z*R(z)), where z=(1-|x|)/2,s=sqrt(z)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 if x is NaN, return x itself;
 if |x|>1, return NaN with invalid signal.\end{DoxyPre}



\begin{DoxyPre}Function needed: sqrt
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 96 of file acos.\+c.



References one, pi, pio2\+\_\+hi, pio2\+\_\+lo, p\+S0, p\+S1, p\+S2, p\+S3, p\+S4, p\+S5, q\+S1, q\+S2, q\+S3, q\+S4, and sqrt().



Referenced by Real\+Number\+::\+Arc\+Cosine(), and Real\+Number\+::\+Arc\+Secant().


\begin{DoxyCode}
97 \{
98     \textcolor{keywordtype}{double} z,p,q,r,w,s,c,df;
99     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} hx,ix;
100     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);
101     ix = hx&0x7fffffff;
102     \textcolor{keywordflow}{if}(ix>=0x3ff00000) \{    \textcolor{comment}{/* |x| >= 1 */}
103         \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} lx;
104         \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
105         \textcolor{keywordflow}{if}(((ix-0x3ff00000)|lx)==0) \{   \textcolor{comment}{/* |x|==1 */}
106             \textcolor{keywordflow}{if}(hx>0) \textcolor{keywordflow}{return} 0.0;        \textcolor{comment}{/* acos(1) = 0  */}
107             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} \hyperlink{acos_8c_a43016d873124d39034edb8cd164794db}{pi}+2.0*\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};    \textcolor{comment}{/* acos(-1)= pi */}
108         \}
109         \textcolor{keywordflow}{return} (x-x)/(x-x);     \textcolor{comment}{/* acos(|x|>1) is NaN */}
110     \}
111     \textcolor{keywordflow}{if}(ix<0x3fe00000) \{ \textcolor{comment}{/* |x| < 0.5 */}
112         \textcolor{keywordflow}{if}(ix<=0x3c600000) \textcolor{keywordflow}{return} \hyperlink{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi}+\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};\textcolor{comment}{/*if|x|<2**-57*/}
113         z = x*x;
114         p = z*(\hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+z*(\hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+z*(\hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+z*(\hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+z*(\hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+z*\hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
115         q = \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+z*(\hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+z*(\hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+z*(\hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+z*\hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
116         r = p/q;
117         \textcolor{keywordflow}{return} \hyperlink{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{pio2\_hi} - (x - (\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo}-x*r));
118     \} \textcolor{keywordflow}{else}  \textcolor{keywordflow}{if} (hx<0) \{     \textcolor{comment}{/* x < -0.5 */}
119         z = (\hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+x)*0.5;
120         p = z*(\hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+z*(\hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+z*(\hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+z*(\hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+z*(\hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+z*\hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
121         q = \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+z*(\hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+z*(\hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+z*(\hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+z*\hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
122         s = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(z);
123         r = p/q;
124         w = r*s-\hyperlink{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{pio2\_lo};
125         \textcolor{keywordflow}{return} \hyperlink{acos_8c_a43016d873124d39034edb8cd164794db}{pi} - 2.0*(s+w);
126     \} \textcolor{keywordflow}{else} \{            \textcolor{comment}{/* x > 0.5 */}
127         z = (\hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-x)*0.5;
128         s = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(z);
129         df = s;
130         \hyperlink{real_2prim_8h_af4776e0b45c17da39fce08bc7b211a03}{SET\_LOW\_WORD}(df,0);
131         c  = (z-df*df)/(s+df);
132         p = z*(\hyperlink{acos_8c_a598e19e166b484e6636a5d2af921178e}{pS0}+z*(\hyperlink{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{pS1}+z*(\hyperlink{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{pS2}+z*(\hyperlink{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{pS3}+z*(\hyperlink{acos_8c_a4579924a5221b8718a2d834daea875c1}{pS4}+z*\hyperlink{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{pS5})))));
133         q = \hyperlink{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+z*(\hyperlink{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{qS1}+z*(\hyperlink{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{qS2}+z*(\hyperlink{acos_8c_abb1b119c3d6cf33d182bd48155186510}{qS3}+z*\hyperlink{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{qS4})));
134         r = p/q;
135         w = r*s+c;
136         \textcolor{keywordflow}{return} 2.0*(df+w);
137     \}
138 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=187pt]{acos_8c_ae93afe22ff34c79ee97ea3eaf77557db_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=277pt]{acos_8c_ae93afe22ff34c79ee97ea3eaf77557db_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{acos.\+c@{acos.\+c}!one@{one}}
\index{one@{one}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}const double one = 1.\+00000000000000000000e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_ada85e349d35971b32c8ea4238881ff8b}{}\label{acos_8c_ada85e349d35971b32c8ea4238881ff8b}


Definition at line 48 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!pi@{pi}}
\index{pi@{pi}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{pi}{pi}}]{\setlength{\rightskip}{0pt plus 5cm}const double pi = 3.\+14159265358979311600e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_a43016d873124d39034edb8cd164794db}{}\label{acos_8c_a43016d873124d39034edb8cd164794db}


Definition at line 49 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!pio2\+\_\+hi@{pio2\+\_\+hi}}
\index{pio2\+\_\+hi@{pio2\+\_\+hi}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+hi}{pio2_hi}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+hi = 1.\+57079632679489655800e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}{}\label{acos_8c_afb7fbaa5c31ee6a1e6a06cfafc7b4722}


Definition at line 50 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!pio2\+\_\+lo@{pio2\+\_\+lo}}
\index{pio2\+\_\+lo@{pio2\+\_\+lo}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{pio2\+\_\+lo}{pio2_lo}}]{\setlength{\rightskip}{0pt plus 5cm}const double pio2\+\_\+lo = 6.\+12323399573676603587e-\/17\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}{}\label{acos_8c_a4c04e4a8938bd8c06dbcc267cf2d1653}


Definition at line 51 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!p\+S0@{p\+S0}}
\index{p\+S0@{p\+S0}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{p\+S0}{pS0}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S0 = 1.\+66666666666666657415e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_a598e19e166b484e6636a5d2af921178e}{}\label{acos_8c_a598e19e166b484e6636a5d2af921178e}


Definition at line 52 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!p\+S1@{p\+S1}}
\index{p\+S1@{p\+S1}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{p\+S1}{pS1}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S1 = -\/3.\+25565818622400915405e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}{}\label{acos_8c_acabe4dc2fe4ed1ed9dd22dbfcc2a4a55}


Definition at line 53 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!p\+S2@{p\+S2}}
\index{p\+S2@{p\+S2}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{p\+S2}{pS2}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S2 = 2.\+01212532134862925881e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}{}\label{acos_8c_a06b3d163437b4041ac67f2cda1cc445d}


Definition at line 54 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!p\+S3@{p\+S3}}
\index{p\+S3@{p\+S3}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{p\+S3}{pS3}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S3 = -\/4.\+00555345006794114027e-\/02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}{}\label{acos_8c_aaa40612ec8cdb54cc05424e143875d6c}


Definition at line 55 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!p\+S4@{p\+S4}}
\index{p\+S4@{p\+S4}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{p\+S4}{pS4}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S4 = 7.\+91534994289814532176e-\/04\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_a4579924a5221b8718a2d834daea875c1}{}\label{acos_8c_a4579924a5221b8718a2d834daea875c1}


Definition at line 56 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!p\+S5@{p\+S5}}
\index{p\+S5@{p\+S5}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{p\+S5}{pS5}}]{\setlength{\rightskip}{0pt plus 5cm}const double p\+S5 = 3.\+47933107596021167570e-\/05\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}{}\label{acos_8c_a6fe8ee6da9411328a5a01cc83cb5cafe}


Definition at line 57 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!q\+S1@{q\+S1}}
\index{q\+S1@{q\+S1}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{q\+S1}{qS1}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S1 = -\/2.\+40339491173441421878e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}{}\label{acos_8c_afb566f87cc1d33877c7a4a30d0abc813}


Definition at line 58 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!q\+S2@{q\+S2}}
\index{q\+S2@{q\+S2}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{q\+S2}{qS2}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S2 = 2.\+02094576023350569471e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}{}\label{acos_8c_aed4dd3ffd10de8fb416b8066211fc27d}


Definition at line 59 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!q\+S3@{q\+S3}}
\index{q\+S3@{q\+S3}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{q\+S3}{qS3}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S3 = -\/6.\+88283971605453293030e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_abb1b119c3d6cf33d182bd48155186510}{}\label{acos_8c_abb1b119c3d6cf33d182bd48155186510}


Definition at line 60 of file acos.\+c.



Referenced by acos().

\index{acos.\+c@{acos.\+c}!q\+S4@{q\+S4}}
\index{q\+S4@{q\+S4}!acos.\+c@{acos.\+c}}
\subsubsection[{\texorpdfstring{q\+S4}{qS4}}]{\setlength{\rightskip}{0pt plus 5cm}const double q\+S4 = 7.\+70381505559019352791e-\/02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{acos_8c_ae6b27b738027128ae51618db2d6e4c81}{}\label{acos_8c_ae6b27b738027128ae51618db2d6e4c81}


Definition at line 61 of file acos.\+c.



Referenced by acos().

