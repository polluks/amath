\hypertarget{fmod_8c}{}\section{lib/real/fmod.c File Reference}
\label{fmod_8c}\index{lib/real/fmod.\+c@{lib/real/fmod.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
Include dependency graph for fmod.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=158pt]{d3/d7b/fmod_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{fmod_8c_a537296d1a8f9fb621676038b99ba7edf}{fmod} (double x, double y)
\begin{DoxyCompactList}\small\item\em Return x mod y in exact arithmetic. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{fmod_8c_ada85e349d35971b32c8ea4238881ff8b}{one} = 1.\+0
\item 
static const double \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero} \mbox{[}$\,$\mbox{]} = \{0.\+0, -\/0.\+0,\}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{fmod.\+c@{fmod.\+c}!fmod@{fmod}}
\index{fmod@{fmod}!fmod.\+c@{fmod.\+c}}
\subsubsection[{\texorpdfstring{fmod(double x, double y)}{fmod(double x, double y)}}]{\setlength{\rightskip}{0pt plus 5cm}double fmod (
\begin{DoxyParamCaption}
\item[{double}]{x, }
\item[{double}]{y}
\end{DoxyParamCaption}
)}\hypertarget{fmod_8c_a537296d1a8f9fb621676038b99ba7edf}{}\label{fmod_8c_a537296d1a8f9fb621676038b99ba7edf}


Return x mod y in exact arithmetic. 

\begin{DoxyVersion}{Version}
1.\+3 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
95/01/18
\end{DoxyDate}
Method\+: shift and subtract 

Definition at line 58 of file fmod.\+c.



References one, and Zero.


\begin{DoxyCode}
59 \{
60     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} n,hx,hy,hz,ix,iy,sx,i;
61     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx,ly,lz;
62 
63     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hx,lx,x);
64     \hyperlink{real_2prim_8h_a6dadc713499e14ba3088a55409a18983}{EXTRACT\_WORDS}(hy,ly,y);
65     sx = hx&0x80000000;     \textcolor{comment}{/* sign of x */}
66     hx ^=sx;        \textcolor{comment}{/* |x| */}
67     hy &= 0x7fffffff;   \textcolor{comment}{/* |y| */}
68 
69     \textcolor{comment}{/* purge off exception values */}
70     \textcolor{keywordflow}{if}((hy|ly)==0||(hx>=0x7ff00000)||   \textcolor{comment}{/* y=0,or x not finite */}
71             ((hy|((ly|-ly)>>31))>0x7ff00000))   \textcolor{comment}{/* or y is NaN */}
72         \textcolor{keywordflow}{return} (x*y)/(x*y);
73     \textcolor{keywordflow}{if}(hx<=hy) \{
74         \textcolor{keywordflow}{if}((hx<hy)||(lx<ly)) \textcolor{keywordflow}{return} x;  \textcolor{comment}{/* |x|<|y| return x */}
75         \textcolor{keywordflow}{if}(lx==ly)
76             \textcolor{keywordflow}{return} \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero}[(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})sx>>31];    \textcolor{comment}{/* |x|=|y| return x*0*/}
77     \}
78 
79     \textcolor{comment}{/* determine ix = ilogb(x) */}
80     \textcolor{keywordflow}{if}(hx<0x00100000) \{ \textcolor{comment}{/* subnormal x */}
81         \textcolor{keywordflow}{if}(hx==0) \{
82             \textcolor{keywordflow}{for} (ix = -1043, i=lx; i>0; i<<=1) ix -=1;
83         \} \textcolor{keywordflow}{else} \{
84             \textcolor{keywordflow}{for} (ix = -1022,i=(hx<<11); i>0; i<<=1) ix -=1;
85         \}
86     \} \textcolor{keywordflow}{else} ix = (hx>>20)-1023;
87 
88     \textcolor{comment}{/* determine iy = ilogb(y) */}
89     \textcolor{keywordflow}{if}(hy<0x00100000) \{ \textcolor{comment}{/* subnormal y */}
90         \textcolor{keywordflow}{if}(hy==0) \{
91             \textcolor{keywordflow}{for} (iy = -1043, i=ly; i>0; i<<=1) iy -=1;
92         \} \textcolor{keywordflow}{else} \{
93             \textcolor{keywordflow}{for} (iy = -1022,i=(hy<<11); i>0; i<<=1) iy -=1;
94         \}
95     \} \textcolor{keywordflow}{else} iy = (hy>>20)-1023;
96 
97     \textcolor{comment}{/* set up \{hx,lx\}, \{hy,ly\} and align y to x */}
98     \textcolor{keywordflow}{if}(ix >= -1022)
99         hx = 0x00100000|(0x000fffff&hx);
100     \textcolor{keywordflow}{else} \{      \textcolor{comment}{/* subnormal x, shift x to normal */}
101         n = -1022-ix;
102         \textcolor{keywordflow}{if}(n<=31) \{
103             hx = (hx<<n)|(lx>>(32-n));
104             lx <<= n;
105         \} \textcolor{keywordflow}{else} \{
106             hx = lx<<(n-32);
107             lx = 0;
108         \}
109     \}
110     \textcolor{keywordflow}{if}(iy >= -1022)
111         hy = 0x00100000|(0x000fffff&hy);
112     \textcolor{keywordflow}{else} \{      \textcolor{comment}{/* subnormal y, shift y to normal */}
113         n = -1022-iy;
114         \textcolor{keywordflow}{if}(n<=31) \{
115             hy = (hy<<n)|(ly>>(32-n));
116             ly <<= n;
117         \} \textcolor{keywordflow}{else} \{
118             hy = ly<<(n-32);
119             ly = 0;
120         \}
121     \}
122 
123     \textcolor{comment}{/* fix point fmod */}
124     n = ix - iy;
125     \textcolor{keywordflow}{while}(n--) \{
126         hz=hx-hy;
127         lz=lx-ly;
128         \textcolor{keywordflow}{if}(lx<ly) hz -= 1;
129         \textcolor{keywordflow}{if}(hz<0) \{
130             hx = hx+hx+(lx>>31);
131             lx = lx+lx;
132         \}
133         \textcolor{keywordflow}{else} \{
134             \textcolor{keywordflow}{if}((hz|lz)==0)      \textcolor{comment}{/* return sign(x)*0 */}
135                 \textcolor{keywordflow}{return} \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero}[(\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})sx>>31];
136             hx = hz+hz+(lz>>31);
137             lx = lz+lz;
138         \}
139     \}
140     hz=hx-hy;
141     lz=lx-ly;
142     \textcolor{keywordflow}{if}(lx<ly) hz -= 1;
143     \textcolor{keywordflow}{if}(hz>=0) \{
144         hx=hz;
145         lx=lz;
146     \}
147 
148     \textcolor{comment}{/* convert back to floating value and restore the sign */}
149     \textcolor{keywordflow}{if}((hx|lx)==0)          \textcolor{comment}{/* return sign(x)*0 */}
150         \textcolor{keywordflow}{return} \hyperlink{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{Zero}[(\textcolor{keywordtype}{unsigned})sx>>31];
151     \textcolor{keywordflow}{while}(hx<0x00100000) \{      \textcolor{comment}{/* normalize x */}
152         hx = hx+hx+(lx>>31);
153         lx = lx+lx;
154         iy -= 1;
155     \}
156     \textcolor{keywordflow}{if}(iy>= -1022) \{    \textcolor{comment}{/* normalize output */}
157         hx = ((hx-0x00100000)|((iy+1023)<<20));
158         \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(x,hx|sx,lx);
159     \} \textcolor{keywordflow}{else} \{        \textcolor{comment}{/* subnormal output */}
160         n = -1022 - iy;
161         \textcolor{keywordflow}{if}(n<=20) \{
162             lx = (lx>>n)|((\hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword})hx<<(32-n));
163             hx >>= n;
164         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (n<=31) \{
165             lx = (hx<<(32-n))|(lx>>n);
166             hx = sx;
167         \} \textcolor{keywordflow}{else} \{
168             lx = hx>>(n-32);
169             hx = sx;
170         \}
171         \hyperlink{real_2prim_8h_a7f681b987a25d4692229be4e0be0cdf1}{INSERT\_WORDS}(x,hx|sx,lx);
172         x *= \hyperlink{fmod_8c_ada85e349d35971b32c8ea4238881ff8b}{one};        \textcolor{comment}{/* create necessary signal */}
173     \}
174     \textcolor{keywordflow}{return} x;       \textcolor{comment}{/* exact output */}
175 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\index{fmod.\+c@{fmod.\+c}!one@{one}}
\index{one@{one}!fmod.\+c@{fmod.\+c}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}const double one = 1.\+0\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{fmod_8c_ada85e349d35971b32c8ea4238881ff8b}{}\label{fmod_8c_ada85e349d35971b32c8ea4238881ff8b}


Definition at line 50 of file fmod.\+c.



Referenced by fmod().

\index{fmod.\+c@{fmod.\+c}!Zero@{Zero}}
\index{Zero@{Zero}!fmod.\+c@{fmod.\+c}}
\subsubsection[{\texorpdfstring{Zero}{Zero}}]{\setlength{\rightskip}{0pt plus 5cm}const double Zero\mbox{[}$\,$\mbox{]} = \{0.\+0, -\/0.\+0,\}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}{}\label{fmod_8c_a4dfc6cb54dc6bacc3251d47de4255c62}


Definition at line 50 of file fmod.\+c.



Referenced by fmod().

