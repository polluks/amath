\hypertarget{csqrt_8c}{}\section{lib/cplex/csqrt.c File Reference}
\label{csqrt_8c}\index{lib/cplex/csqrt.\+c@{lib/cplex/csqrt.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}complex.\+h\char`\"{}}\\*
Include dependency graph for csqrt.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{de/de1/csqrt_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{unioncomplex}{complex} \hyperlink{csqrt_8c_afe5b814a44414f20d0f98fe974737edd}{csqrt} (\hyperlink{unioncomplex}{complex} z)
\begin{DoxyCompactList}\small\item\em Square root of complex number. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{csqrt.\+c@{csqrt.\+c}!csqrt@{csqrt}}
\index{csqrt@{csqrt}!csqrt.\+c@{csqrt.\+c}}
\subsubsection[{\texorpdfstring{csqrt(complex z)}{csqrt(complex z)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf complex} csqrt (
\begin{DoxyParamCaption}
\item[{{\bf complex}}]{z}
\end{DoxyParamCaption}
)}\hypertarget{csqrt_8c_afe5b814a44414f20d0f98fe974737edd}{}\label{csqrt_8c_afe5b814a44414f20d0f98fe974737edd}


Square root of complex number. 

\begin{DoxyVersion}{Version}
1.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
2007/08/20 
\end{DoxyDate}


Definition at line 46 of file csqrt.\+c.



References cabs(), cimag(), cpack(), creal(), and sqrt().



Referenced by cacos(), cacosh(), cacsc(), cacsch(), casec(), casech(), casin(), casinh(), and Complex\+Number\+::\+Square\+Root().


\begin{DoxyCode}
47 \{
48     \hyperlink{unioncomplex}{complex} w;
49     \textcolor{keywordtype}{double} x, y, r, t, scale;
50 
51     x = \hyperlink{complex_8h_a4a236b24c0197821e3489a35a72079ab}{creal} (z);
52     y = \hyperlink{complex_8h_aa1fe0b9371befabef6c41ba73470774a}{cimag} (z);
53 
54     \textcolor{keywordflow}{if} (y == 0.0) \{
55         \textcolor{keywordflow}{if} (x == 0.0) \{
56             w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(0.0, y);
57         \} \textcolor{keywordflow}{else} \{
58             r = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x);
59             r = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(r);
60             \textcolor{keywordflow}{if} (x < 0.0) \{
61                 w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(0.0, r);
62             \} \textcolor{keywordflow}{else} \{
63                 w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(r, y);
64             \}
65         \}
66         \textcolor{keywordflow}{return} w;
67     \}
68     \textcolor{keywordflow}{if} (x == 0.0) \{
69         r = \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(y);
70         r = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(0.5 * r);
71         \textcolor{keywordflow}{if} (y > 0)
72             w =  \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(r, r);
73         \textcolor{keywordflow}{else}
74             w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(r, -r);
75         \textcolor{keywordflow}{return} w;
76     \}
77     \textcolor{comment}{/* Rescale to avoid internal overflow or underflow.  */}
78     \textcolor{keywordflow}{if} ((\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(x) > 4.0) || (\hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}(y) > 4.0)) \{
79         x *= 0.25;
80         y *= 0.25;
81         scale = 2.0;
82     \} \textcolor{keywordflow}{else} \{
83 \textcolor{preprocessor}{#if 1}
84         x *= 1.8014398509481984e16;  \textcolor{comment}{/* 2^54 */}
85         y *= 1.8014398509481984e16;
86         scale = 7.450580596923828125e-9; \textcolor{comment}{/* 2^-27 */}
87 \textcolor{preprocessor}{#else}
88         x *= 4.0;
89         y *= 4.0;
90         scale = 0.5;
91 \textcolor{preprocessor}{#endif}
92     \}
93     w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(x, y);
94     r = \hyperlink{complex_8h_af6e02ba9d2566b52e3b0faf2d4ed973a}{cabs}(w);
95     \textcolor{keywordflow}{if} (x > 0) \{
96         t = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(0.5 * r + 0.5 * x);
97         r = scale * \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}((0.5 * y) / t );
98         t *= scale;
99     \} \textcolor{keywordflow}{else} \{
100         r = \hyperlink{math_8h_ab87521a75ef827a85807f89a6c10629a}{sqrt}(0.5 * r - 0.5 * x);
101         t = scale * \hyperlink{math_8h_a8fb5c0b9b43a108724b355136d29d2f9}{fabs}((0.5 * y) / r);
102         r *= scale;
103     \}
104     \textcolor{keywordflow}{if} (y < 0)
105         w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(t, -r);
106     \textcolor{keywordflow}{else}
107         w = \hyperlink{complex_8h_a980e6e049f7902b05fc9eb5614b07a5c}{cpack}(t, r);
108     \textcolor{keywordflow}{return} w;
109 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{d2/dac/csqrt_8c_afe5b814a44414f20d0f98fe974737edd_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/dac/csqrt_8c_afe5b814a44414f20d0f98fe974737edd_icgraph}
\end{center}
\end{figure}


