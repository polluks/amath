\hypertarget{dprint_8h}{}\section{lib/dprint.h File Reference}
\label{dprint_8h}\index{lib/dprint.\+h@{lib/dprint.\+h}}


Format defitions used in the Dragon4 library.  


{\ttfamily \#include \char`\"{}dstandard.\+h\char`\"{}}\\*
Include dependency graph for dprint.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=164pt]{dprint_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{dprint_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2}{t\+Print\+Float\+Format} \{ \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a8973a8ad28c6a11b3c60e559e60f741c}{Print\+Float\+Format\+\_\+\+Positional}, 
\hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a3503f685e7267ba72c4a17aa390d7706}{Print\+Float\+Format\+\_\+\+Scientific}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{t\+U32} \hyperlink{dprint_8h_a83d135741203dce4201423de8063b2c2}{Print\+Float32} (\hyperlink{dstandard_8h_a0dd9590397b73cba91a188b94be20ee1}{t\+C8} $\ast$p\+Out\+Buffer, \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{t\+U32} buffer\+Size, \hyperlink{dstandard_8h_adfd1aaaa5a9470e6009d2770939ae5ba}{t\+F32} value, \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2}{t\+Print\+Float\+Format} format, \hyperlink{dstandard_8h_ae3b25aefaa14d98873818cceec369577}{t\+S32} precision, \hyperlink{dstandard_8h_a0dd9590397b73cba91a188b94be20ee1}{t\+C8} decimal\+Point)
\item 
\hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{t\+U32} \hyperlink{dprint_8h_abd2c48bc16cbab3eb5ec361153f21cbe}{Print\+Float64} (\hyperlink{dstandard_8h_a0dd9590397b73cba91a188b94be20ee1}{t\+C8} $\ast$p\+Out\+Buffer, \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{t\+U32} buffer\+Size, \hyperlink{dstandard_8h_a401388ecc207be71d44743e3b4cc4b4d}{t\+F64} value, \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2}{t\+Print\+Float\+Format} format, \hyperlink{dstandard_8h_ae3b25aefaa14d98873818cceec369577}{t\+S32} precision, \hyperlink{dstandard_8h_a0dd9590397b73cba91a188b94be20ee1}{t\+C8} decimal\+Point)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Format defitions used in the Dragon4 library. 



\subsection{Enumeration Type Documentation}
\index{dprint.\+h@{dprint.\+h}!t\+Print\+Float\+Format@{t\+Print\+Float\+Format}}
\index{t\+Print\+Float\+Format@{t\+Print\+Float\+Format}!dprint.\+h@{dprint.\+h}}
\subsubsection[{\texorpdfstring{t\+Print\+Float\+Format}{tPrintFloatFormat}}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf t\+Print\+Float\+Format}}\hypertarget{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2}{}\label{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{Print\+Float\+Format\+\_\+\+Positional@{Print\+Float\+Format\+\_\+\+Positional}!dprint.\+h@{dprint.\+h}}\index{dprint.\+h@{dprint.\+h}!Print\+Float\+Format\+\_\+\+Positional@{Print\+Float\+Format\+\_\+\+Positional}}\item[{\em 
Print\+Float\+Format\+\_\+\+Positional\hypertarget{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a8973a8ad28c6a11b3c60e559e60f741c}{}\label{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a8973a8ad28c6a11b3c60e559e60f741c}
}]\index{Print\+Float\+Format\+\_\+\+Scientific@{Print\+Float\+Format\+\_\+\+Scientific}!dprint.\+h@{dprint.\+h}}\index{dprint.\+h@{dprint.\+h}!Print\+Float\+Format\+\_\+\+Scientific@{Print\+Float\+Format\+\_\+\+Scientific}}\item[{\em 
Print\+Float\+Format\+\_\+\+Scientific\hypertarget{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a3503f685e7267ba72c4a17aa390d7706}{}\label{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a3503f685e7267ba72c4a17aa390d7706}
}]\end{description}
\end{Desc}


Definition at line 70 of file dprint.\+h.


\begin{DoxyCode}
71 \{
72     \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a8973a8ad28c6a11b3c60e559e60f741c}{PrintFloatFormat\_Positional},    \textcolor{comment}{// [-]ddddd.dddd}
73     \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a3503f685e7267ba72c4a17aa390d7706}{PrintFloatFormat\_Scientific},    \textcolor{comment}{// [-]d.dddde[sign]ddd}
74 \};
\end{DoxyCode}


\subsection{Function Documentation}
\index{dprint.\+h@{dprint.\+h}!Print\+Float32@{Print\+Float32}}
\index{Print\+Float32@{Print\+Float32}!dprint.\+h@{dprint.\+h}}
\subsubsection[{\texorpdfstring{Print\+Float32(t\+C8 $\ast$p\+Out\+Buffer, t\+U32 buffer\+Size, t\+F32 value, t\+Print\+Float\+Format format, t\+S32 precision, t\+C8 decimal\+Point)}{PrintFloat32(tC8 *pOutBuffer, tU32 bufferSize, tF32 value, tPrintFloatFormat format, tS32 precision, tC8 decimalPoint)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf t\+U32} Print\+Float32 (
\begin{DoxyParamCaption}
\item[{{\bf t\+C8} $\ast$}]{p\+Out\+Buffer, }
\item[{{\bf t\+U32}}]{buffer\+Size, }
\item[{{\bf t\+F32}}]{value, }
\item[{{\bf t\+Print\+Float\+Format}}]{format, }
\item[{{\bf t\+S32}}]{precision, }
\item[{{\bf t\+C8}}]{decimal\+Point}
\end{DoxyParamCaption}
)}\hypertarget{dprint_8h_a83d135741203dce4201423de8063b2c2}{}\label{dprint_8h_a83d135741203dce4201423de8063b2c2}


Definition at line 465 of file dprint.\+cpp.



References Format\+Positional(), Format\+Scientific(), t\+Float\+Union32\+::\+Get\+Exponent(), t\+Float\+Union32\+::\+Get\+Mantissa(), t\+Float\+Union32\+::\+Is\+Negative(), Log\+Base2(), t\+Float\+Union32\+::m\+\_\+floating\+Point, Print\+Float\+Format\+\_\+\+Positional, Print\+Float\+Format\+\_\+\+Scientific, and Print\+Inf\+Nan().


\begin{DoxyCode}
475 \{
476     \textcolor{keywordflow}{if} (bufferSize == 0)
477         \textcolor{keywordflow}{return} 0;
478 
479     \textcolor{keywordflow}{if} (bufferSize == 1)
480     \{
481         pOutBuffer[0] = \textcolor{charliteral}{'\(\backslash\)0'};
482         \textcolor{keywordflow}{return} 1;
483     \}
484 
485     \textcolor{comment}{// deconstruct the floating point value}
486     \hyperlink{uniontFloatUnion32}{tFloatUnion32} floatUnion;
487     floatUnion.\hyperlink{uniontFloatUnion32_ad1a5322bcde302e59bcd001125651e6a}{m\_floatingPoint} = value;
488     \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{tU32} floatExponent = floatUnion.\hyperlink{uniontFloatUnion32_a5fdea8e6c84f336aa35050476f3cd776}{GetExponent}();
489     \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{tU32} floatMantissa = floatUnion.\hyperlink{uniontFloatUnion32_a09e9d4d1db976209ea3a5720ae55b373}{GetMantissa}();
490 
491     \textcolor{comment}{// output the sign}
492     \textcolor{keywordflow}{if} (floatUnion.\hyperlink{uniontFloatUnion32_a712fc8a147092d725afef356b58e222d}{IsNegative}())
493     \{
494         pOutBuffer[0] = \textcolor{charliteral}{'-'};
495         ++pOutBuffer;
496         --bufferSize;
497         \hyperlink{dstandard_8h_a89136b38084a3e1d69a63af0db6fec17}{RJ\_ASSERT}(bufferSize > 0);
498     \}
499 
500     \textcolor{comment}{// if this is a special value}
501     \textcolor{keywordflow}{if} (floatExponent == 0xFF)
502     \{
503         \textcolor{keywordflow}{return} \hyperlink{dprint_8cpp_ac1192be7b47f41c6b593be33d0ad423f}{PrintInfNan}(pOutBuffer, bufferSize, floatMantissa, 6);
504     \}
505     \textcolor{comment}{// else this is a number}
506     \textcolor{keywordflow}{else}
507     \{
508         \textcolor{comment}{// factor the value into its parts}
509         \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{tU32} mantissa;
510         \hyperlink{dstandard_8h_ae3b25aefaa14d98873818cceec369577}{tS32} exponent;
511         \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{tU32} mantissaHighBitIdx;
512         \hyperlink{dstandard_8h_ad203aed3ab57b120eb54c2043f60dc49}{tB} hasUnequalMargins;
513         \textcolor{keywordflow}{if} (floatExponent != 0)
514         \{
515             \textcolor{comment}{// normalized}
516             \textcolor{comment}{// The floating point equation is:}
517             \textcolor{comment}{//  value = (1 + mantissa/2^23) * 2 ^ (exponent-127)}
518             \textcolor{comment}{// We convert the integer equation by factoring a 2^23 out of the exponent}
519             \textcolor{comment}{//  value = (1 + mantissa/2^23) * 2^23 * 2 ^ (exponent-127-23)}
520             \textcolor{comment}{//  value = (2^23 + mantissa) * 2 ^ (exponent-127-23)}
521             \textcolor{comment}{// Because of the implied 1 in front of the mantissa we have 24 bits of precision.}
522             \textcolor{comment}{//   m = (2^23 + mantissa)}
523             \textcolor{comment}{//   e = (exponent-127-23)}
524             mantissa            = (1UL << 23) | floatMantissa;
525             exponent            = floatExponent - 127 - 23;
526             mantissaHighBitIdx  = 23;
527             hasUnequalMargins   = (floatExponent != 1) && (floatMantissa == 0);
528         \}
529         \textcolor{keywordflow}{else}
530         \{
531             \textcolor{comment}{// denormalized}
532             \textcolor{comment}{// The floating point equation is:}
533             \textcolor{comment}{//  value = (mantissa/2^23) * 2 ^ (1-127)}
534             \textcolor{comment}{// We convert the integer equation by factoring a 2^23 out of the exponent}
535             \textcolor{comment}{//  value = (mantissa/2^23) * 2^23 * 2 ^ (1-127-23)}
536             \textcolor{comment}{//  value = mantissa * 2 ^ (1-127-23)}
537             \textcolor{comment}{// We have up to 23 bits of precision.}
538             \textcolor{comment}{//   m = (mantissa)}
539             \textcolor{comment}{//   e = (1-127-23)}
540             mantissa           = floatMantissa;
541             exponent           = 1 - 127 - 23;
542             mantissaHighBitIdx = \hyperlink{dmath_8cpp_a835ee0ad31a196742a7a5fd3c21a738b}{LogBase2}(mantissa);
543             hasUnequalMargins   = \textcolor{keyword}{false};
544         \}
545 
546         \textcolor{comment}{// format the value}
547         \textcolor{keywordflow}{switch} (format)
548         \{
549         \textcolor{keywordflow}{case} \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a8973a8ad28c6a11b3c60e559e60f741c}{PrintFloatFormat\_Positional}:
550             \textcolor{keywordflow}{return} \hyperlink{dprint_8cpp_a73aa4cbb8052f400f03f1706a3eced16}{FormatPositional}(    pOutBuffer,
551                                         bufferSize,
552                                         mantissa,
553                                         exponent,
554                                         mantissaHighBitIdx,
555                                         hasUnequalMargins,
556                                         precision,
557                                         decimalPoint );
558 
559         \textcolor{keywordflow}{case} \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a3503f685e7267ba72c4a17aa390d7706}{PrintFloatFormat\_Scientific}:
560             \textcolor{keywordflow}{return} \hyperlink{dprint_8cpp_a1fce61f37a054297f0b8898d52dc9f28}{FormatScientific}(    pOutBuffer,
561                                         bufferSize,
562                                         mantissa,
563                                         exponent,
564                                         mantissaHighBitIdx,
565                                         hasUnequalMargins,
566                                         precision,
567                                         decimalPoint );
568 
569         \textcolor{keywordflow}{default}:
570             pOutBuffer[0] = \textcolor{charliteral}{'\(\backslash\)0'};
571             \textcolor{keywordflow}{return} 0;
572         \}
573     \}
574 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dprint_8h_a83d135741203dce4201423de8063b2c2_cgraph}
\end{center}
\end{figure}


\index{dprint.\+h@{dprint.\+h}!Print\+Float64@{Print\+Float64}}
\index{Print\+Float64@{Print\+Float64}!dprint.\+h@{dprint.\+h}}
\subsubsection[{\texorpdfstring{Print\+Float64(t\+C8 $\ast$p\+Out\+Buffer, t\+U32 buffer\+Size, t\+F64 value, t\+Print\+Float\+Format format, t\+S32 precision, t\+C8 decimal\+Point)}{PrintFloat64(tC8 *pOutBuffer, tU32 bufferSize, tF64 value, tPrintFloatFormat format, tS32 precision, tC8 decimalPoint)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf t\+U32} Print\+Float64 (
\begin{DoxyParamCaption}
\item[{{\bf t\+C8} $\ast$}]{p\+Out\+Buffer, }
\item[{{\bf t\+U32}}]{buffer\+Size, }
\item[{{\bf t\+F64}}]{value, }
\item[{{\bf t\+Print\+Float\+Format}}]{format, }
\item[{{\bf t\+S32}}]{precision, }
\item[{{\bf t\+C8}}]{decimal\+Point}
\end{DoxyParamCaption}
)}\hypertarget{dprint_8h_abd2c48bc16cbab3eb5ec361153f21cbe}{}\label{dprint_8h_abd2c48bc16cbab3eb5ec361153f21cbe}


Definition at line 582 of file dprint.\+cpp.



References Format\+Positional(), Format\+Scientific(), t\+Float\+Union64\+::\+Get\+Exponent(), t\+Float\+Union64\+::\+Get\+Mantissa(), t\+Float\+Union64\+::\+Is\+Negative(), Log\+Base2(), t\+Float\+Union64\+::m\+\_\+floating\+Point, Print\+Float\+Format\+\_\+\+Positional, Print\+Float\+Format\+\_\+\+Scientific, and Print\+Inf\+Nan().



Referenced by Decimal\+System\+::\+Get\+Real\+Text().


\begin{DoxyCode}
592 \{
593     \textcolor{keywordflow}{if} (bufferSize == 0)
594         \textcolor{keywordflow}{return} 0;
595 
596     \textcolor{keywordflow}{if} (bufferSize == 1)
597     \{
598         pOutBuffer[0] = \textcolor{charliteral}{'\(\backslash\)0'};
599         \textcolor{keywordflow}{return} 1;
600     \}
601 
602     \textcolor{comment}{// deconstruct the floating point value}
603     \hyperlink{uniontFloatUnion64}{tFloatUnion64} floatUnion;
604     floatUnion.\hyperlink{uniontFloatUnion64_aac8887130a7750b7ed3e38d2172e0d4d}{m\_floatingPoint} = value;
605     \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{tU32} floatExponent = floatUnion.\hyperlink{uniontFloatUnion64_a9a52499d5e9a41152da0368522121dd9}{GetExponent}();
606     \hyperlink{dstandard_8h_a6625ae5505b2f796350b82c7f52fcf43}{tU64} floatMantissa = floatUnion.\hyperlink{uniontFloatUnion64_ac19d91a8d0950d68fb2610925e2fe43e}{GetMantissa}();
607 
608     \textcolor{comment}{// output the sign}
609     \textcolor{keywordflow}{if} (floatUnion.\hyperlink{uniontFloatUnion64_acef6b9abed06d568b90ed31592e13242}{IsNegative}())
610     \{
611         pOutBuffer[0] = \textcolor{charliteral}{'-'};
612         ++pOutBuffer;
613         --bufferSize;
614         \hyperlink{dstandard_8h_a89136b38084a3e1d69a63af0db6fec17}{RJ\_ASSERT}(bufferSize > 0);
615     \}
616 
617     \textcolor{comment}{// if this is a special value}
618     \textcolor{keywordflow}{if} (floatExponent == 0x7FF)
619     \{
620         \textcolor{keywordflow}{return} \hyperlink{dprint_8cpp_ac1192be7b47f41c6b593be33d0ad423f}{PrintInfNan}(pOutBuffer, bufferSize, floatMantissa, 13);
621     \}
622     \textcolor{comment}{// else this is a number}
623     \textcolor{keywordflow}{else}
624     \{
625         \textcolor{comment}{// factor the value into its parts}
626         \hyperlink{dstandard_8h_a6625ae5505b2f796350b82c7f52fcf43}{tU64} mantissa;
627         \hyperlink{dstandard_8h_ae3b25aefaa14d98873818cceec369577}{tS32} exponent;
628         \hyperlink{dstandard_8h_aee96db7e18784e05ed6b0bcaeec3f7f6}{tU32} mantissaHighBitIdx;
629         \hyperlink{dstandard_8h_ad203aed3ab57b120eb54c2043f60dc49}{tB} hasUnequalMargins;
630 
631         \textcolor{keywordflow}{if} (floatExponent != 0)
632         \{
633             \textcolor{comment}{// normal}
634             \textcolor{comment}{// The floating point equation is:}
635             \textcolor{comment}{//  value = (1 + mantissa/2^52) * 2 ^ (exponent-1023)}
636             \textcolor{comment}{// We convert the integer equation by factoring a 2^52 out of the exponent}
637             \textcolor{comment}{//  value = (1 + mantissa/2^52) * 2^52 * 2 ^ (exponent-1023-52)}
638             \textcolor{comment}{//  value = (2^52 + mantissa) * 2 ^ (exponent-1023-52)}
639             \textcolor{comment}{// Because of the implied 1 in front of the mantissa we have 53 bits of precision.}
640             \textcolor{comment}{//   m = (2^52 + mantissa)}
641             \textcolor{comment}{//   e = (exponent-1023+1-53)}
642             mantissa            = (1ull << 52) | floatMantissa;
643             exponent            = floatExponent - 1023 - 52;
644             mantissaHighBitIdx  = 52;
645             hasUnequalMargins   = (floatExponent != 1) && (floatMantissa == 0);
646         \}
647         \textcolor{keywordflow}{else}
648         \{
649             \textcolor{comment}{// subnormal}
650             \textcolor{comment}{// The floating point equation is:}
651             \textcolor{comment}{//  value = (mantissa/2^52) * 2 ^ (1-1023)}
652             \textcolor{comment}{// We convert the integer equation by factoring a 2^52 out of the exponent}
653             \textcolor{comment}{//  value = (mantissa/2^52) * 2^52 * 2 ^ (1-1023-52)}
654             \textcolor{comment}{//  value = mantissa * 2 ^ (1-1023-52)}
655             \textcolor{comment}{// We have up to 52 bits of precision.}
656             \textcolor{comment}{//   m = (mantissa)}
657             \textcolor{comment}{//   e = (1-1023-52)}
658             mantissa            = floatMantissa;
659             exponent            = 1 - 1023 - 52;
660             mantissaHighBitIdx  = \hyperlink{dmath_8cpp_a835ee0ad31a196742a7a5fd3c21a738b}{LogBase2}(mantissa);
661             hasUnequalMargins   = \textcolor{keyword}{false};
662         \}
663 
664         \textcolor{comment}{// format the value}
665         \textcolor{keywordflow}{switch} (format)
666         \{
667         \textcolor{keywordflow}{case} \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a8973a8ad28c6a11b3c60e559e60f741c}{PrintFloatFormat\_Positional}:
668             \textcolor{keywordflow}{return} \hyperlink{dprint_8cpp_a73aa4cbb8052f400f03f1706a3eced16}{FormatPositional}(    pOutBuffer,
669                                         bufferSize,
670                                         mantissa,
671                                         exponent,
672                                         mantissaHighBitIdx,
673                                         hasUnequalMargins,
674                                         precision,
675                                         decimalPoint );
676 
677         \textcolor{keywordflow}{case} \hyperlink{dprint_8h_ad1a8e21d8398e3c6f757fffea595fbe2a3503f685e7267ba72c4a17aa390d7706}{PrintFloatFormat\_Scientific}:
678             \textcolor{keywordflow}{return} \hyperlink{dprint_8cpp_a1fce61f37a054297f0b8898d52dc9f28}{FormatScientific}(    pOutBuffer,
679                                         bufferSize,
680                                         mantissa,
681                                         exponent,
682                                         mantissaHighBitIdx,
683                                         hasUnequalMargins,
684                                         precision,
685                                         decimalPoint );
686 
687         \textcolor{keywordflow}{default}:
688             pOutBuffer[0] = \textcolor{charliteral}{'\(\backslash\)0'};
689             \textcolor{keywordflow}{return} 0;
690         \}
691     \}
692 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dprint_8h_abd2c48bc16cbab3eb5ec361153f21cbe_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dprint_8h_abd2c48bc16cbab3eb5ec361153f21cbe_icgraph}
\end{center}
\end{figure}


