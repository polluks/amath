\hypertarget{exp_8c}{}\section{lib/real/exp.c File Reference}
\label{exp_8c}\index{lib/real/exp.\+c@{lib/real/exp.\+c}}
{\ttfamily \#include \char`\"{}prim.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}math.\+h\char`\"{}}\\*
Include dependency graph for exp.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{d0/db6/exp_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{exp_8c_ae09128febbbe6372cde4fa0c65608a42}{exp} (double x)
\begin{DoxyCompactList}\small\item\em Returns the exponential of x. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one} = 1.\+0
\item 
static const double \hyperlink{exp_8c_a3569bfad37f52891aa371c2f31e70dac}{halF} \mbox{[}2\mbox{]} = \{0.\+5,-\/0.\+5,\}
\item 
static const double \hyperlink{exp_8c_acbd466133274923cc0785707fbdeea9a}{huge} = 1.\+0e+300
\item 
static const double \hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000} = 9.\+33263618503218878990e-\/302
\item 
static const double \hyperlink{exp_8c_acbb7fb31d7634234372850576e110c91}{o\+\_\+threshold} = 7.\+09782712893383973096e+02
\item 
static const double \hyperlink{exp_8c_aa36ad5f2244c82ebc142bbdbbc7af9bb}{u\+\_\+threshold} = -\/7.\+45133219101941108420e+02
\item 
static const double \hyperlink{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}{ln2\+HI} \mbox{[}2\mbox{]}
\item 
static const double \hyperlink{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}{ln2\+LO} \mbox{[}2\mbox{]}
\item 
static const double \hyperlink{exp_8c_a4cf65ab9c76c64c084e1abd8fe5da216}{invln2} = 1.\+44269504088896338700e+00
\item 
static const double \hyperlink{exp_8c_a5c2e2e6dd711ceae83536551926d6dd3}{P1} = 1.\+66666666666666019037e-\/01
\item 
static const double \hyperlink{exp_8c_acddba71b086f9e3c2b621baef51e45ac}{P2} = -\/2.\+77777777770155933842e-\/03
\item 
static const double \hyperlink{exp_8c_ab48f05f97efef9ea9f554c91a980520a}{P3} = 6.\+61375632143793436117e-\/05
\item 
static const double \hyperlink{exp_8c_af783f4afa9878be962b9904dc22e8bab}{P4} = -\/1.\+65339022054652515390e-\/06
\item 
static const double \hyperlink{exp_8c_afdc64323c3afde906f161bdf28e5e319}{P5} = 4.\+13813679705723846039e-\/08
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{exp.\+c@{exp.\+c}!exp@{exp}}
\index{exp@{exp}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{exp(double x)}{exp(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double exp (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{exp_8c_ae09128febbbe6372cde4fa0c65608a42}{}\label{exp_8c_ae09128febbbe6372cde4fa0c65608a42}


Returns the exponential of x. 

\begin{DoxyVersion}{Version}
1.\+6 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
04/04/22
\end{DoxyDate}

\begin{DoxyPre}
Method
  1. Argument reduction:
     Reduce x to an r so that |r| <= 0.5*ln2 ~ 0.34658.
 Given x, find r and integer k such that\end{DoxyPre}



\begin{DoxyPre}              x = k*ln2 + r,  |r| <= 0.5*ln2.\end{DoxyPre}



\begin{DoxyPre}     Here r will be represented as r = hi-lo for better
 accuracy.\end{DoxyPre}



\begin{DoxyPre}  2. Approximation of exp(r) by a special rational function on
 the interval [0,0.34658]:
 Write
     R(r**2) = r*(exp(r)+1)/(exp(r)-1) = 2 + r*r/6 - r**4/360 + ...
     We use a special Remes algorithm on [0,0.34658] to generate
    a polynomial of degree 5 to approximate R. The maximum error
 of this polynomial approximation is bounded by 2**-59. In
 other words,
     R(z) ~ 2.0 + P1*z + P2*z**2 + P3*z**3 + P4*z**4 + P5*z**5
    (where z=r*r, and the values of P1 to P5 are listed below)
 and
     |                  5          |     -59
     | 2.0+P1*z+...+P5*z   -  R(z) | <= 2
     |                             |
 The computation of exp(r) thus becomes
                            2*r
    exp(r) = 1 + -------
                  R - r
                                r*R1(r)
           = 1 + r + ----------- (for better accuracy)
                      2 - R1(r)
 where
                 2       4             10
    R1(r) = r - (P1*r  + P2*r  + ... + P5*r   ).\end{DoxyPre}



\begin{DoxyPre}  3. Scale back to obtain exp(x):
 From step 1, we have
    exp(x) = 2^k * exp(r)\end{DoxyPre}



\begin{DoxyPre}Special cases:
 exp(INF) is INF, exp(NaN) is NaN;
 exp(-INF) is 0, and
 for finite argument, only exp(0)=1 is exact.\end{DoxyPre}



\begin{DoxyPre}Accuracy:
 according to an error analysis, the error is always less than
 1 ulp (unit in the last place).\end{DoxyPre}



\begin{DoxyPre}Misc. info.
 For IEEE double
     if x >  7.09782712893383973096e+02 then exp(x) overflow
     if x < -7.45133219101941108420e+02 then exp(x) underflow\end{DoxyPre}



\begin{DoxyPre}Constants:
The hexadecimal values are the intended ones for the following
constants. The decimal values may be used, provided that the
compiler will convert from decimal to binary accurately enough
to produce the hexadecimal values shown.
\end{DoxyPre}
 \begin{DoxyCopyright}{Copyright}
Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.  Developed at Sun\+Soft, a Sun Microsystems, Inc. business. Permission to use, copy, modify, and distribute this software is freely granted, provided that this notice is preserved. 
\end{DoxyCopyright}


Definition at line 134 of file exp.\+c.



References halF, huge, invln2, ln2\+HI, ln2\+LO, o\+\_\+threshold, one, P1, P2, P3, P4, P5, twom1000, and u\+\_\+threshold.



Referenced by cchsh(), cexp(), cosh(), cpow(), and sinh().


\begin{DoxyCode}
135 \{
136     \textcolor{keywordtype}{double} y,hi,lo,c,t;
137     \hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword} k,xsb;
138     \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hx;
139 
140     lo = 0.0;
141     hi = 0.0;
142 
143     \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hx,x);   \textcolor{comment}{/* high word of x */}
144     xsb = (hx>>31)&1;       \textcolor{comment}{/* sign bit of x */}
145     hx &= 0x7fffffff;       \textcolor{comment}{/* high word of |x| */}
146 
147     \textcolor{comment}{/* filter out non-finite argument */}
148     \textcolor{keywordflow}{if}(hx >= 0x40862E42) \{          \textcolor{comment}{/* if |x|>=709.78... */}
149         \textcolor{keywordflow}{if}(hx>=0x7ff00000) \{
150             \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} lx;
151             \hyperlink{real_2prim_8h_adee023704c856ea8f310e8e3fd765a22}{GET\_LOW\_WORD}(lx,x);
152             \textcolor{keywordflow}{if}(((hx&0xfffff)|lx)!=0)
153                 \textcolor{keywordflow}{return} x+x;             \textcolor{comment}{/* NaN */}
154             \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} (xsb==0)? x:0.0;    \textcolor{comment}{/* exp(+-inf)=\{inf,0\} */}
155         \}
156         \textcolor{keywordflow}{if}(x > \hyperlink{exp_8c_acbb7fb31d7634234372850576e110c91}{o\_threshold}) \textcolor{keywordflow}{return} \hyperlink{exp_8c_acbd466133274923cc0785707fbdeea9a}{huge}*\hyperlink{exp_8c_acbd466133274923cc0785707fbdeea9a}{huge}; \textcolor{comment}{/* overflow */}
157         \textcolor{keywordflow}{if}(x < \hyperlink{exp_8c_aa36ad5f2244c82ebc142bbdbbc7af9bb}{u\_threshold}) \textcolor{keywordflow}{return} \hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000}*\hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000}; \textcolor{comment}{/* underflow */}
158     \}
159 
160     \textcolor{comment}{/* argument reduction */}
161     \textcolor{keywordflow}{if}(hx > 0x3fd62e42) \{       \textcolor{comment}{/* if  |x| > 0.5 ln2 */}
162         \textcolor{keywordflow}{if}(hx < 0x3FF0A2B2) \{       \textcolor{comment}{/* and |x| < 1.5 ln2 */}
163             hi = x-\hyperlink{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}{ln2HI}[xsb];
164             lo=\hyperlink{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}{ln2LO}[xsb];
165             k = 1-xsb-xsb;
166         \} \textcolor{keywordflow}{else} \{
167             k  = (\hyperlink{real_2prim_8h_ae91287c8a5f73a8a22a100f50dc4de77}{sword})(\hyperlink{exp_8c_a4cf65ab9c76c64c084e1abd8fe5da216}{invln2}*x+\hyperlink{exp_8c_a3569bfad37f52891aa371c2f31e70dac}{halF}[xsb]);
168             t  = k;
169             hi = x - t*\hyperlink{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}{ln2HI}[0];   \textcolor{comment}{/* t*ln2HI is exact here */}
170             lo = t*\hyperlink{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}{ln2LO}[0];
171         \}
172         x  = hi - lo;
173     \}
174     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(hx < 0x3e300000)  \{     \textcolor{comment}{/* when |x|<2**-28 */}
175         \textcolor{keywordflow}{if}(huge+x>\hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}) \{
176             \textcolor{keywordflow}{return} \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}+x;    \textcolor{comment}{/* trigger inexact */}
177         \} \textcolor{keywordflow}{else} \{
178             k = 0;
179         \}
180     \}
181     \textcolor{keywordflow}{else} k = 0;
182 
183     \textcolor{comment}{/* x is now in primary range */}
184     t  = x*x;
185     c  = x - t*(\hyperlink{exp_8c_a5c2e2e6dd711ceae83536551926d6dd3}{P1}+t*(\hyperlink{exp_8c_acddba71b086f9e3c2b621baef51e45ac}{P2}+t*(\hyperlink{exp_8c_ab48f05f97efef9ea9f554c91a980520a}{P3}+t*(\hyperlink{exp_8c_af783f4afa9878be962b9904dc22e8bab}{P4}+t*\hyperlink{exp_8c_afdc64323c3afde906f161bdf28e5e319}{P5}))));
186     \textcolor{keywordflow}{if}(k==0)    \textcolor{keywordflow}{return} \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-((x*c)/(c-2.0)-x);
187     \textcolor{keywordflow}{else}        y = \hyperlink{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{one}-((lo-(x*c)/(2.0-c))-hi);
188     \textcolor{keywordflow}{if}(k >= -1021) \{
189         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
190         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
191         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + (k<<20));    \textcolor{comment}{/* add k to y's exponent */}
192         \textcolor{keywordflow}{return} y;
193     \} \textcolor{keywordflow}{else} \{
194         \hyperlink{real_2prim_8h_a6e60fe0e0f9f8801507e15fe2d893751}{uword} hy;
195         \hyperlink{real_2prim_8h_ae62ee08d06ab4cc06d61dc1246b73195}{GET\_HIGH\_WORD}(hy, y);
196         \hyperlink{real_2prim_8h_a6ca54776127e20149f84c290bf52f89e}{SET\_HIGH\_WORD}(y, hy + ((k+1000)<<20));\textcolor{comment}{/* add k to y's exponent */}
197         \textcolor{keywordflow}{return} y*\hyperlink{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{twom1000};
198     \}
199 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d6f/exp_8c_ae09128febbbe6372cde4fa0c65608a42_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{exp.\+c@{exp.\+c}!halF@{halF}}
\index{halF@{halF}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{halF}{halF}}]{\setlength{\rightskip}{0pt plus 5cm}const double halF\mbox{[}2\mbox{]} = \{0.\+5,-\/0.\+5,\}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_a3569bfad37f52891aa371c2f31e70dac}{}\label{exp_8c_a3569bfad37f52891aa371c2f31e70dac}


Definition at line 47 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!huge@{huge}}
\index{huge@{huge}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{huge}{huge}}]{\setlength{\rightskip}{0pt plus 5cm}const double huge = 1.\+0e+300\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_acbd466133274923cc0785707fbdeea9a}{}\label{exp_8c_acbd466133274923cc0785707fbdeea9a}


Definition at line 48 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!invln2@{invln2}}
\index{invln2@{invln2}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{invln2}{invln2}}]{\setlength{\rightskip}{0pt plus 5cm}const double invln2 = 1.\+44269504088896338700e+00\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_a4cf65ab9c76c64c084e1abd8fe5da216}{}\label{exp_8c_a4cf65ab9c76c64c084e1abd8fe5da216}


Definition at line 56 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!ln2\+HI@{ln2\+HI}}
\index{ln2\+HI@{ln2\+HI}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{ln2\+HI}{ln2HI}}]{\setlength{\rightskip}{0pt plus 5cm}const double ln2\+HI\mbox{[}2\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}{}\label{exp_8c_a93ef32de5f0d2bce9014ace3505dee8d}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=\{ 6.93147180369123816490e-01,  
         -6.93147180369123816490e-01,\}
\end{DoxyCode}


Definition at line 52 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!ln2\+LO@{ln2\+LO}}
\index{ln2\+LO@{ln2\+LO}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{ln2\+LO}{ln2LO}}]{\setlength{\rightskip}{0pt plus 5cm}const double ln2\+LO\mbox{[}2\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}{}\label{exp_8c_a72b91c46421cdfaaa1d53ff6013422b4}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=\{ 1.90821492927058770002e-10,  
         -1.90821492927058770002e-10,\}
\end{DoxyCode}


Definition at line 54 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!o\+\_\+threshold@{o\+\_\+threshold}}
\index{o\+\_\+threshold@{o\+\_\+threshold}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{o\+\_\+threshold}{o_threshold}}]{\setlength{\rightskip}{0pt plus 5cm}const double o\+\_\+threshold = 7.\+09782712893383973096e+02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_acbb7fb31d7634234372850576e110c91}{}\label{exp_8c_acbb7fb31d7634234372850576e110c91}


Definition at line 50 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!one@{one}}
\index{one@{one}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}const double one = 1.\+0\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_ada85e349d35971b32c8ea4238881ff8b}{}\label{exp_8c_ada85e349d35971b32c8ea4238881ff8b}


Definition at line 46 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!P1@{P1}}
\index{P1@{P1}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{P1}{P1}}]{\setlength{\rightskip}{0pt plus 5cm}const double P1 = 1.\+66666666666666019037e-\/01\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_a5c2e2e6dd711ceae83536551926d6dd3}{}\label{exp_8c_a5c2e2e6dd711ceae83536551926d6dd3}


Definition at line 57 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!P2@{P2}}
\index{P2@{P2}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{P2}{P2}}]{\setlength{\rightskip}{0pt plus 5cm}const double P2 = -\/2.\+77777777770155933842e-\/03\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_acddba71b086f9e3c2b621baef51e45ac}{}\label{exp_8c_acddba71b086f9e3c2b621baef51e45ac}


Definition at line 58 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!P3@{P3}}
\index{P3@{P3}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{P3}{P3}}]{\setlength{\rightskip}{0pt plus 5cm}const double P3 = 6.\+61375632143793436117e-\/05\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_ab48f05f97efef9ea9f554c91a980520a}{}\label{exp_8c_ab48f05f97efef9ea9f554c91a980520a}


Definition at line 59 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!P4@{P4}}
\index{P4@{P4}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{P4}{P4}}]{\setlength{\rightskip}{0pt plus 5cm}const double P4 = -\/1.\+65339022054652515390e-\/06\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_af783f4afa9878be962b9904dc22e8bab}{}\label{exp_8c_af783f4afa9878be962b9904dc22e8bab}


Definition at line 60 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!P5@{P5}}
\index{P5@{P5}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{P5}{P5}}]{\setlength{\rightskip}{0pt plus 5cm}const double P5 = 4.\+13813679705723846039e-\/08\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_afdc64323c3afde906f161bdf28e5e319}{}\label{exp_8c_afdc64323c3afde906f161bdf28e5e319}


Definition at line 61 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!twom1000@{twom1000}}
\index{twom1000@{twom1000}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{twom1000}{twom1000}}]{\setlength{\rightskip}{0pt plus 5cm}const double twom1000 = 9.\+33263618503218878990e-\/302\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}{}\label{exp_8c_a705fc686c40b3a746e9b61d4d73018ec}


Definition at line 49 of file exp.\+c.



Referenced by exp().

\index{exp.\+c@{exp.\+c}!u\+\_\+threshold@{u\+\_\+threshold}}
\index{u\+\_\+threshold@{u\+\_\+threshold}!exp.\+c@{exp.\+c}}
\subsubsection[{\texorpdfstring{u\+\_\+threshold}{u_threshold}}]{\setlength{\rightskip}{0pt plus 5cm}const double u\+\_\+threshold = -\/7.\+45133219101941108420e+02\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{exp_8c_aa36ad5f2244c82ebc142bbdbbc7af9bb}{}\label{exp_8c_aa36ad5f2244c82ebc142bbdbbc7af9bb}


Definition at line 51 of file exp.\+c.



Referenced by exp().

